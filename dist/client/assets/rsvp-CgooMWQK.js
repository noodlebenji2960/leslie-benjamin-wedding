import{y as fe,a as h,w as Re,p as Pe}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as r}from"./jsx-runtime-u17CrQMm.js";import{I as q}from"./Icon-D7gvQNpQ.js";import{u as H}from"./useTranslation-B9zSoiKr.js";import{m as C,A as se}from"./proxy-DBX3VoSC.js";import{u as ae}from"./AnalyticsContext-CJAiYubj.js";var z={exports:{}},K,oe;function Te(){if(oe)return K;oe=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return K=e,K}var Y,ce;function ke(){if(ce)return Y;ce=1;var e=Te();function t(){}function i(){}return i.resetWarningCache=t,Y=function(){function n(j,v,g,o,l,a){if(a!==e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function s(){return n}var p={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:i,resetWarningCache:t};return p.PropTypes=p,p},Y}var le;function Ee(){return le||(le=1,z.exports=ke()()),z.exports}var Le=Ee();const L=fe(Le);var Ce=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},X.apply(this,arguments)}function Oe(e,t){if(e==null)return{};var i={},n=Object.keys(e),s,p;for(p=0;p<n.length;p++)s=n[p],!(t.indexOf(s)>=0)&&(i[s]=e[s]);return i}function G(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ee(e,t)}function ee(e,t){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},ee(e,t)}var W=(function(e){Ae(t,e);function t(){var n;return n=e.call(this)||this,n.handleExpired=n.handleExpired.bind(G(n)),n.handleErrored=n.handleErrored.bind(G(n)),n.handleChange=n.handleChange.bind(G(n)),n.handleRecaptchaRef=n.handleRecaptchaRef.bind(G(n)),n}var i=t.prototype;return i.getCaptchaFunction=function(s){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[s]:this.props.grecaptcha[s]:null},i.getValue=function(){var s=this.getCaptchaFunction("getResponse");return s&&this._widgetId!==void 0?s(this._widgetId):null},i.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},i.execute=function(){var s=this.getCaptchaFunction("execute");if(s&&this._widgetId!==void 0)return s(this._widgetId);this._executeRequested=!0},i.executeAsync=function(){var s=this;return new Promise(function(p,j){s.executionResolve=p,s.executionReject=j,s.execute()})},i.reset=function(){var s=this.getCaptchaFunction("reset");s&&this._widgetId!==void 0&&s(this._widgetId)},i.forceReset=function(){var s=this.getCaptchaFunction("reset");s&&s()},i.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},i.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},i.handleChange=function(s){this.props.onChange&&this.props.onChange(s),this.executionResolve&&(this.executionResolve(s),delete this.executionReject,delete this.executionResolve)},i.explicitRender=function(){var s=this.getCaptchaFunction("render");if(s&&this._widgetId===void 0){var p=document.createElement("div");this._widgetId=s(p,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(p)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},i.componentDidMount=function(){this.explicitRender()},i.componentDidUpdate=function(){this.explicitRender()},i.handleRecaptchaRef=function(s){this.captcha=s},i.render=function(){var s=this.props;s.sitekey,s.onChange,s.theme,s.type,s.tabindex,s.onExpired,s.onErrored,s.size,s.stoken,s.grecaptcha,s.badge,s.hl,s.isolated;var p=Oe(s,Ce);return h.createElement("div",X({},p,{ref:this.handleRecaptchaRef}))},t})(h.Component);W.displayName="ReCAPTCHA";W.propTypes={sitekey:L.string.isRequired,onChange:L.func,grecaptcha:L.object,theme:L.oneOf(["dark","light"]),type:L.oneOf(["image","audio"]),tabindex:L.number,onExpired:L.func,onErrored:L.func,size:L.oneOf(["compact","normal","invisible"]),stoken:L.string,hl:L.string,badge:L.oneOf(["bottomright","bottomleft","inline"]),isolated:L.bool};W.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var J={exports:{}},S={};var de;function $e(){if(de)return S;de=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,i=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,p=e?Symbol.for("react.profiler"):60114,j=e?Symbol.for("react.provider"):60109,v=e?Symbol.for("react.context"):60110,g=e?Symbol.for("react.async_mode"):60111,o=e?Symbol.for("react.concurrent_mode"):60111,l=e?Symbol.for("react.forward_ref"):60112,a=e?Symbol.for("react.suspense"):60113,u=e?Symbol.for("react.suspense_list"):60120,b=e?Symbol.for("react.memo"):60115,y=e?Symbol.for("react.lazy"):60116,R=e?Symbol.for("react.block"):60121,w=e?Symbol.for("react.fundamental"):60117,m=e?Symbol.for("react.responder"):60118,_=e?Symbol.for("react.scope"):60119;function f(c){if(typeof c=="object"&&c!==null){var T=c.$$typeof;switch(T){case t:switch(c=c.type,c){case g:case o:case n:case p:case s:case a:return c;default:switch(c=c&&c.$$typeof,c){case v:case l:case y:case b:case j:return c;default:return T}}case i:return T}}}function N(c){return f(c)===o}return S.AsyncMode=g,S.ConcurrentMode=o,S.ContextConsumer=v,S.ContextProvider=j,S.Element=t,S.ForwardRef=l,S.Fragment=n,S.Lazy=y,S.Memo=b,S.Portal=i,S.Profiler=p,S.StrictMode=s,S.Suspense=a,S.isAsyncMode=function(c){return N(c)||f(c)===g},S.isConcurrentMode=N,S.isContextConsumer=function(c){return f(c)===v},S.isContextProvider=function(c){return f(c)===j},S.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===t},S.isForwardRef=function(c){return f(c)===l},S.isFragment=function(c){return f(c)===n},S.isLazy=function(c){return f(c)===y},S.isMemo=function(c){return f(c)===b},S.isPortal=function(c){return f(c)===i},S.isProfiler=function(c){return f(c)===p},S.isStrictMode=function(c){return f(c)===s},S.isSuspense=function(c){return f(c)===a},S.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===n||c===o||c===p||c===s||c===a||c===u||typeof c=="object"&&c!==null&&(c.$$typeof===y||c.$$typeof===b||c.$$typeof===j||c.$$typeof===v||c.$$typeof===l||c.$$typeof===w||c.$$typeof===m||c.$$typeof===_||c.$$typeof===R)},S.typeOf=f,S}var ue;function qe(){return ue||(ue=1,J.exports=$e()),J.exports}var Q,pe;function Ie(){if(pe)return Q;pe=1;var e=qe(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},n={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},p={};p[e.ForwardRef]=n,p[e.Memo]=s;function j(y){return e.isMemo(y)?s:p[y.$$typeof]||t}var v=Object.defineProperty,g=Object.getOwnPropertyNames,o=Object.getOwnPropertySymbols,l=Object.getOwnPropertyDescriptor,a=Object.getPrototypeOf,u=Object.prototype;function b(y,R,w){if(typeof R!="string"){if(u){var m=a(R);m&&m!==u&&b(y,m,w)}var _=g(R);o&&(_=_.concat(o(R)));for(var f=j(y),N=j(R),c=0;c<_.length;++c){var T=_[c];if(!i[T]&&!(w&&w[T])&&!(N&&N[T])&&!(f&&f[T])){var P=l(R,T);try{v(y,T,P)}catch{}}}}return y}return Q=b,Q}var Fe=Ie();const Ue=fe(Fe);function te(){return te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},te.apply(this,arguments)}function De(e,t){if(e==null)return{};var i={},n=Object.keys(e),s,p;for(p=0;p<n.length;p++)s=n[p],!(t.indexOf(s)>=0)&&(i[s]=e[s]);return i}function Ve(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var I={},Me=0;function He(e,t){return t=t||{},function(n){var s=n.displayName||n.name||"Component",p=(function(v){Ve(g,v);function g(l,a){var u;return u=v.call(this,l,a)||this,u.state={},u.__scriptURL="",u}var o=g.prototype;return o.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+Me++),this.__scriptLoaderID},o.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},o.asyncScriptLoaderHandleLoad=function(a){var u=this;this.setState(a,function(){return u.props.asyncScriptOnLoad&&u.props.asyncScriptOnLoad(u.state)})},o.asyncScriptLoaderTriggerOnScriptLoaded=function(){var a=I[this.__scriptURL];if(!a||!a.loaded)throw new Error("Script is not loaded.");for(var u in a.observers)a.observers[u](a);delete window[t.callbackName]},o.componentDidMount=function(){var a=this,u=this.setupScriptURL(),b=this.asyncScriptLoaderGetScriptLoaderID(),y=t,R=y.globalName,w=y.callbackName,m=y.scriptId;if(R&&typeof window[R]<"u"&&(I[u]={loaded:!0,observers:{}}),I[u]){var _=I[u];if(_&&(_.loaded||_.errored)){this.asyncScriptLoaderHandleLoad(_);return}_.observers[b]=function(P){return a.asyncScriptLoaderHandleLoad(P)};return}var f={};f[b]=function(P){return a.asyncScriptLoaderHandleLoad(P)},I[u]={loaded:!1,observers:f};var N=document.createElement("script");N.src=u,N.async=!0;for(var c in t.attributes)N.setAttribute(c,t.attributes[c]);m&&(N.id=m);var T=function(A){if(I[u]){var D=I[u],d=D.observers;for(var x in d)A(d[x])&&delete d[x]}};w&&typeof window<"u"&&(window[w]=function(){return a.asyncScriptLoaderTriggerOnScriptLoaded()}),N.onload=function(){var P=I[u];P&&(P.loaded=!0,T(function(A){return w?!1:(A(P),!0)}))},N.onerror=function(){var P=I[u];P&&(P.errored=!0,T(function(A){return A(P),!0}))},document.body.appendChild(N)},o.componentWillUnmount=function(){var a=this.__scriptURL;if(t.removeOnUnmount===!0)for(var u=document.getElementsByTagName("script"),b=0;b<u.length;b+=1)u[b].src.indexOf(a)>-1&&u[b].parentNode&&u[b].parentNode.removeChild(u[b]);var y=I[a];y&&(delete y.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete I[a])},o.render=function(){var a=t.globalName,u=this.props;u.asyncScriptOnLoad;var b=u.forwardedRef,y=De(u,["asyncScriptOnLoad","forwardedRef"]);return a&&typeof window<"u"&&(y[a]=typeof window[a]<"u"?window[a]:void 0),y.ref=b,h.createElement(n,y)},g})(h.Component),j=h.forwardRef(function(v,g){return h.createElement(p,te({},v,{forwardedRef:g}))});return j.displayName="AsyncScriptLoader("+s+")",j.propTypes={asyncScriptOnLoad:L.func},Ue(j,n)}}var re="onloadcallback",Be="grecaptcha";function ne(){return typeof window<"u"&&window.recaptchaOptions||{}}function Ge(){var e=ne(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+re+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+re+"&render=explicit"}const We=He(Ge,{callbackName:re,globalName:Be,attributes:ne().nonce?{nonce:ne().nonce}:{}})(W),me=({index:e,guest:t,onUpdate:i,onRemove:n,onConfirm:s,isDraft:p=!1,isRostered:j=!1})=>{const{t:v}=H(["rsvp"]),[g,o]=h.useState(!1),[l,a]=h.useState(!1),u=t.firstName.trim()&&t.lastName.trim(),b=m=>m.replace(/[^a-zA-ZÀ-ÿ\s'-]/g,""),y=(m,_)=>m.slice(0,_),R=(m,_)=>{const f=y(b(_),30);i?.(e,m,f)},w=(m,_,f)=>{const N=f?y(_,f):_;i?.(e,m,N)};return h.useEffect(()=>{t.dietary&&o(!0),t.note&&a(!0)},[t.dietary,t.note]),r.jsxs(C.div,{className:`guest-card ${u?"":"invalid"}`,layout:"position",initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{type:"spring",stiffness:400,damping:30,layout:{type:"spring",stiffness:500}},children:[r.jsxs("div",{className:"inputs-container",children:[r.jsxs("div",{className:"form-row",children:[r.jsx("input",{type:"text",placeholder:v("rsvp:firstName"),value:t.firstName,onChange:m=>R("firstName",m.target.value),maxLength:30}),r.jsx("input",{type:"text",placeholder:v("rsvp:lastName"),value:t.lastName,onChange:m=>R("lastName",m.target.value),maxLength:30})]}),r.jsxs(se,{children:[g&&r.jsxs(C.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[r.jsx("input",{type:"text",placeholder:v("rsvp:dietaryPlaceholder"),value:t.dietary,onChange:m=>w("dietary",m.target.value,100),maxLength:100}),r.jsx("button",{type:"button",className:"close-btn",onClick:()=>o(!1),children:"×"})]}),l&&r.jsxs(C.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[r.jsx("textarea",{placeholder:v("rsvp:notePlaceholder"),value:t.note||"",onChange:m=>w("note",m.target.value,200),maxLength:200}),r.jsx("button",{type:"button",className:"close-btn",onClick:()=>a(!1),children:"×"})]})]})]}),r.jsx("div",{className:"guest-card-actions",children:p?r.jsx(C.button,{type:"button",className:"form-btn add-guest-btn",disabled:!u,onClick:()=>{s&&s(),o(!1),a(!1)},whileHover:u?{scale:1.02}:{},title:v("rsvp:addGuest"),children:r.jsx(q.Add,{})}):r.jsxs(r.Fragment,{children:[!g&&r.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>o(!0),title:v("rsvp:addDietary"),children:r.jsx(q.Food,{})}),!l&&r.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>a(!0),title:v("rsvp:addNote"),children:r.jsx(q.Note,{})}),r.jsx("button",{type:"button",className:"remove-guest",onClick:()=>{window.confirm(`Are you sure you want to remove ${t.firstName} ${t.lastName} from the guest roster?`)&&n?.(e)},children:r.jsx(q.Close,{})})]})})]})},he={firstName:"",lastName:"",dietary:"",note:""},ze=({guests:e,onGuestsChange:t})=>{const{t:i}=H(["rsvp"]),[n,s]=h.useState(he),p=h.useCallback(()=>{!n.firstName.trim()||!n.lastName.trim()||(t([...e,n]),s(he))},[n,e,t]),j=h.useCallback(o=>{t(e.filter((l,a)=>a!==o))},[e,t]),v=h.useCallback((o,l,a)=>{t(e.map((u,b)=>b===o?{...u,[l]:a}:u))},[e,t]),g=h.useCallback((o,l)=>{s(a=>({...a,[o]:l}))},[]);return r.jsxs("div",{className:"guests-section",children:[r.jsxs("h3",{children:[i("rsvp:guestsTitle"),e.length>0&&` (${e.length})`]}),r.jsxs(se,{children:[e.map((o,l)=>r.jsx(me,{index:l,guest:o,onUpdate:v,onRemove:j,isRostered:!0},`roster-${l}`)),r.jsx(me,{index:e.length,guest:n,onUpdate:(o,l,a)=>g(l,a),onConfirm:p,isDraft:!0},"draft")]})]})},Ke=({musicRequests:e,onChange:t})=>{const[i,n]=h.useState(""),[s,p]=h.useState(""),[j,v]=h.useState([]),[g,o]=h.useState(!1),[l,a]=h.useState(null),[u,b]=h.useState(0),[y,R]=h.useState(0),[w,m]=h.useState(null),_=h.useRef(null),f=e||[],N=h.useCallback(()=>{_.current&&(_.current.pause(),_.current.src=""),a(null),b(0),R(0)},[]),c=d=>{const x=Math.floor(d/60).toString().padStart(2,"0"),E=Math.floor(d%60).toString().padStart(2,"0");return`${x}:${E}`};h.useEffect(()=>()=>{_.current&&(_.current.pause(),_.current.src="",_.current=null)},[]),h.useEffect(()=>{const d=`${i} ${s}`.trim();if(!d){v([]),m(null),N();return}const x=new AbortController,E=x.signal,F=setTimeout(async()=>{o(!0),m(null),N();try{const O=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(d)}&entity=song&limit=20`,{signal:E});if(!O.ok)throw new Error("Failed to fetch songs");const $=await O.json();v($.results?.map(U=>({trackName:U.trackName,artistName:U.artistName,artworkUrl100:U.artworkUrl100,previewUrl:U.previewUrl}))||[]),$.results?.length===0&&(m("No songs found. Try a different search."),setTimeout(()=>m(null),5e3))}catch(O){O.name!=="AbortError"&&(console.error(O),m("Failed to search. Please try again."),setTimeout(()=>m(null),5e3))}finally{o(!1)}},400);return()=>{clearTimeout(F),x.abort()}},[i,s,N]);const T=d=>{if(!d.previewUrl)return;if(m(null),l===d.previewUrl){N();return}N();const x=new Audio(d.previewUrl);_.current=x;const E=()=>{R(x.duration)},F=()=>{b(x.currentTime)},O=()=>{a(null),b(0),R(0),U()},$=()=>{a(null),b(0),R(0),m("Failed to play preview"),setTimeout(()=>m(null),5e3),U()},U=()=>{x.removeEventListener("loadedmetadata",E),x.removeEventListener("timeupdate",F),x.removeEventListener("ended",O),x.removeEventListener("error",$)};x.addEventListener("loadedmetadata",E),x.addEventListener("timeupdate",F),x.addEventListener("ended",O),x.addEventListener("error",$),x.play().catch(we=>{console.error("Audio play error:",we),m("Failed to play preview"),setTimeout(()=>m(null),5e3),U()}),a(d.previewUrl)},P=d=>{f.some(x=>x.trackName===d.trackName&&x.artistName===d.artistName)||t([...f,d].slice(0,10)),N()},A=d=>{const x=[...f],E=x[d];x.splice(d,1),t(x),l===E?.previewUrl&&N()},D=()=>{t([]),N()};return r.jsxs("div",{className:"music-request-manager",children:[r.jsxs("h3",{className:"section-title",children:[f.length>0&&`${f.length} `,"Music Request",f.length!==1&&"s"," ",r.jsx("br",{}),r.jsx("span",{className:"optional-label",children:"(optional)"})]}),f.length>0&&r.jsxs("div",{className:"added-songs-section",children:[r.jsxs("div",{className:"added-songs-header",children:[r.jsxs("span",{className:"song-count",children:[f.length," / 10 songs"]}),r.jsx("button",{onClick:D,className:"clear-all-btn","aria-label":"Clear all songs",children:"Clear All"})]}),r.jsx("ul",{className:"added-songs-list",children:f.map((d,x)=>r.jsxs("li",{className:"added-song-item",children:[r.jsxs("div",{className:"song-info",children:[r.jsx("img",{src:d.artworkUrl100,alt:`${d.trackName} album art`,className:"song-artwork-small"}),r.jsxs("div",{className:"song-text",children:[r.jsx("span",{className:"song-name",children:d.trackName}),r.jsx("span",{className:"artist-name",children:d.artistName})]})]}),r.jsxs("div",{className:"song-actions",children:[d.previewUrl&&r.jsx("button",{onClick:()=>T(d),className:"play-btn-small","aria-label":l===d.previewUrl?"Stop preview":"Play preview",children:l===d.previewUrl?r.jsx(q.Stop,{}):r.jsx(q.Play,{})}),r.jsx("button",{onClick:()=>A(x),className:"remove-btn","aria-label":`Remove ${d.trackName}`,children:"✕"})]})]},`${d.trackName}-${d.artistName}-${x}`))})]}),r.jsxs("div",{className:"search-inputs",children:[r.jsx("input",{type:"text",value:i,onChange:d=>n(d.target.value),placeholder:"Search by song title",className:"form-input","aria-label":"Song title"}),r.jsx("input",{type:"text",value:s,onChange:d=>p(d.target.value),placeholder:"Search by artist",className:"form-input","aria-label":"Artist name"})]}),g&&r.jsx("div",{role:"status","aria-live":"polite",children:"Searching..."}),j.length>0&&r.jsx("ul",{className:"suggestions-list",role:"list",children:j.map((d,x)=>{const E=f.some(O=>O.trackName===d.trackName&&O.artistName===d.artistName),F=l===d.previewUrl;return r.jsxs("li",{className:"suggestion-item",children:[r.jsxs("div",{className:"left-controls",children:[r.jsx("img",{src:d.artworkUrl100,alt:"",className:"album-grayscale",style:{filter:"grayscale(100%)"}}),r.jsx("img",{src:d.artworkUrl100,alt:`${d.trackName} album art`,className:"album-color"}),d.previewUrl&&r.jsx("button",{onClick:()=>T(d),className:`play-btn ${F?"playing":""}`,"aria-label":F?`Stop preview of ${d.trackName}`:`Play preview of ${d.trackName}`,children:F?r.jsx(q.Stop,{}):r.jsx(q.Play,{})})]}),r.jsxs("div",{className:"suggestion-info",children:[r.jsx("div",{children:r.jsx("strong",{children:d.trackName})}),r.jsx("div",{children:r.jsx("em",{children:d.artistName})}),F&&y>0&&r.jsxs("div",{className:"playback-time","aria-live":"polite",children:[c(u)," / ",c(y)]})]}),r.jsx("button",{onClick:()=>P(d),className:"add-btn",disabled:E||f.length>=10,"aria-label":E?`${d.trackName} already added`:`Add ${d.trackName} to requests`,children:E?r.jsx(r.Fragment,{children:r.jsx(q.Tick,{})}):r.jsx(r.Fragment,{children:r.jsx(q.Add,{})})})]},`${d.trackName}-${d.artistName}-${x}`)})}),f.length>=10&&r.jsx("div",{className:"limit-message",role:"status",children:"Maximum of 10 songs reached. Remove a song to add more."})]})},V={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},Ye=({currentStep:e,form:t,isClient:i,onChange:n,onGuestsChange:s,captchaToken:p,error:j,recaptchaRef:v,setCaptchaToken:g})=>{const{t:o}=H(["home","common","rsvp"]),l=a=>a.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?null:o("rsvp:errors.invalidEmail"):o("rsvp:errors.required");return r.jsxs(se,{mode:"wait",children:[e===0&&r.jsxs(C.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"email",children:[o("rsvp:email")," ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{id:"email",name:"email",type:"email",value:t.email,onChange:n,className:`form-input ${t.email.trim()?l(t.email)?"form-input-invalid":"form-input-valid":""}`,required:!0,autoComplete:"email"}),t.email&&l(t.email)&&r.jsx("div",{className:"field-error",children:l(t.email)})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"attending",children:[o("rsvp:attending")," ",r.jsx("span",{className:"required",children:"*"})]}),r.jsxs("select",{id:"attending",name:"attending",value:t.attending,onChange:n,className:`form-input ${t.attending?"form-input-valid":""}`,required:!0,autoComplete:"off",children:[r.jsx("option",{value:"",children:o("rsvp:select")}),r.jsx("option",{value:"yes",children:o("rsvp:yes")}),r.jsx("option",{value:"no",children:o("rsvp:no")})]})]})]},"step0"),e===1&&r.jsx(C.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:t.attending==="yes"?r.jsx(ze,{guests:t.guests,onGuestsChange:s,required:!0}):r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"nonAttendingName",children:[o("rsvp:yourName")," ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{id:"nonAttendingName",name:"nonAttendingName",type:"text",value:t.nonAttendingName,onChange:n,className:"form-input",required:!0,autoComplete:"name",spellCheck:!1})]})},"guestsOrName"),e===2&&t.attending==="yes"&&r.jsx(C.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:r.jsx(Ke,{musicRequests:t.musicRequest||[],onChange:a=>n({target:{name:"musicRequest",value:a}})})},"musicRequest"),e===3&&i&&r.jsxs(C.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[t.attending==="yes"&&r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"notes",children:o("rsvp:messageToBrideGroom")}),r.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:n,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5})]}),r.jsx(We,{sitekey:"6Lcy_mcsAAAAADoT-ibwy1RvePEHG4xJ87D0fdse",onChange:a=>g(a),ref:v,style:{display:"inline-block",width:"100%",marginTop:"1rem"}}),!p&&j&&r.jsx("div",{className:"field-error",children:"Please complete reCAPTCHA"})]},"captcha"),e===4&&r.jsx(C.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:r.jsxs("div",{className:"review",children:[r.jsxs("p",{children:[r.jsxs("strong",{children:[o("rsvp:email"),":"]})," ",t.email]}),r.jsxs("p",{children:[r.jsxs("strong",{children:[o("rsvp:attending"),":"]})," ",o(`rsvp:${t.attending}`)]}),t.attending==="yes"&&t.guests.length>0&&r.jsxs("div",{children:[r.jsxs("strong",{children:[o("rsvp:guestsTitle"),":"]}),r.jsx("ul",{children:t.guests.map((a,u)=>r.jsxs("li",{children:[a.firstName," ",a.lastName,a.dietary&&` - ${o("rsvp:dietary")}: ${a.dietary}`,a.note&&` - ${o("rsvp:guestNote")}: ${a.note}`]},u))}),t.musicRequest&&t.musicRequest.length>0&&r.jsxs("p",{children:[r.jsxs("strong",{children:[o("rsvp:musicRequest"),":"]})," ",t.musicRequest.join(", ")]})]}),t.attending==="no"&&r.jsxs("p",{children:[r.jsxs("strong",{children:[o("rsvp:name"),":"]})," ",t.nonAttendingName]}),t.notes&&r.jsxs("p",{children:[r.jsxs("strong",{children:[o("rsvp:messageToBrideGroom"),":"]})," ",t.notes]})]})},"review")]})},Je=({submittedRef:e})=>{const{t}=H(["home","common","rsvp"]),[i,n]=h.useState(!1);return h.useEffect(()=>{const s=setTimeout(()=>n(!0),50),p=setInterval(()=>{n(!1),setTimeout(()=>n(!0),55)},1e4);return()=>{clearTimeout(s),clearInterval(p)}},[]),r.jsxs(C.div,{className:"rsvp-page container",ref:e,initial:{opacity:0,scale:.9,y:30},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25,duration:.6}},children:[r.jsx(C.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:20,delay:1},className:"heart-animated",style:{fontSize:"4rem",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:r.jsxs("svg",{viewBox:"0 0 24 24",children:[r.jsx("defs",{children:r.jsx("path",{id:"heart",d:"M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"})}),r.jsx(C.use,{xlinkHref:"#heart",initial:{opacity:0,scale:.33},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:15},style:{transformOrigin:"center"}},i?"on":"off")]})}),r.jsx(C.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},style:{textAlign:"center",marginBottom:"1rem"},children:t("rsvp:thankYou")}),r.jsx(C.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},style:{textAlign:"center",maxWidth:"500px",margin:"0 auto 2rem",lineHeight:1.6},children:t("rsvp:confirmation")})]})};function Qe(e){const t=ae(),[i,n]=h.useState({...e,musicRequest:e.musicRequest||""}),[s,p]=h.useState(0),[j,v]=h.useState(null),[g,o]=h.useState(!1),l=["contactAndAttendance","guestsOrName","musicRequest","captcha","review"];return{form:i,setForm:n,currentStep:s,steps:l,error:j,setError:v,hasValidGuests:g,handleChange:w=>{const{name:m,value:_}=w.target;n(f=>({...f,[m]:_})),v(null)},handleGuestsChange:w=>{n(m=>({...m,guests:w})),o(w.some(m=>m.firstName.trim()&&m.lastName.trim()))},nextStep:()=>{t.event("rsvp_step_complete",{event_label:l[s],step_number:s+1,step_name:l[s]}),p(w=>w+1)},prevStep:()=>{t.event("rsvp_step_back",{event_label:l[s],step_number:s+1,step_name:l[s]}),p(w=>w-1)},goToStep:w=>p(w)}}class B{constructor(t=0,i="Network Error"){this.status=t,this.text=i}}const Ze=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},k={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:Ze()},ie=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},Xe=(e,t="https://api.emailjs.com")=>{if(!e)return;const i=ie(e);k.publicKey=i.publicKey,k.blockHeadless=i.blockHeadless,k.storageProvider=i.storageProvider,k.blockList=i.blockList,k.limitRate=i.limitRate,k.origin=i.origin||t},ve=async(e,t,i={})=>{const n=await fetch(k.origin+e,{method:"POST",headers:i,body:t}),s=await n.text(),p=new B(n.status,s);if(n.ok)return p;throw p},ye=(e,t,i)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!i||typeof i!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},et=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},ge=e=>e.webdriver||!e.languages||e.languages.length===0,be=()=>new B(451,"Unavailable For Headless Browser"),tt=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},rt=e=>!e.list?.length||!e.watchVariable,nt=(e,t)=>e instanceof FormData?e.get(t):e[t],xe=(e,t)=>{if(rt(e))return!1;tt(e.list,e.watchVariable);const i=nt(t,e.watchVariable);return typeof i!="string"?!1:e.list.includes(i)},je=()=>new B(403,"Forbidden"),st=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},at=async(e,t,i)=>{const n=Number(await i.get(e)||0);return t-Date.now()+n},_e=async(e,t,i)=>{if(!t.throttle||!i)return!1;st(t.throttle,t.id);const n=t.id||e;return await at(n,t.throttle,i)>0?!0:(await i.set(n,Date.now().toString()),!1)},Ne=()=>new B(429,"Too Many Requests"),it=async(e,t,i,n)=>{const s=ie(n),p=s.publicKey||k.publicKey,j=s.blockHeadless||k.blockHeadless,v=s.storageProvider||k.storageProvider,g={...k.blockList,...s.blockList},o={...k.limitRate,...s.limitRate};return j&&ge(navigator)?Promise.reject(be()):(ye(p,e,t),et(i),i&&xe(g,i)?Promise.reject(je()):await _e(location.pathname,o,v)?Promise.reject(Ne()):ve("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:p,service_id:e,template_id:t,template_params:i}),{"Content-type":"application/json"}))},ot=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ct=e=>typeof e=="string"?document.querySelector(e):e,lt=async(e,t,i,n)=>{const s=ie(n),p=s.publicKey||k.publicKey,j=s.blockHeadless||k.blockHeadless,v=k.storageProvider||s.storageProvider,g={...k.blockList,...s.blockList},o={...k.limitRate,...s.limitRate};if(j&&ge(navigator))return Promise.reject(be());const l=ct(i);ye(p,e,t),ot(l);const a=new FormData(l);return xe(g,a)?Promise.reject(je()):await _e(location.pathname,o,v)?Promise.reject(Ne()):(a.append("lib_version","4.4.1"),a.append("service_id",e),a.append("template_id",t),a.append("user_id",p),ve("/api/v1.0/email/send-form",a))},Se={init:Xe,send:it,sendForm:lt,EmailJSResponseStatus:B},dt="gVksEDEDoKBjB0TJU";Se.init(dt);function ut(e,t,i=0){const n=ae(),[s,p]=h.useState(!1),[j,v]=h.useState(!1),[g,o]=h.useState(null),l=async()=>{if(console.log("Submitting RSVP...",{form:e,captchaToken:t}),!t){const a="Please complete reCAPTCHA.";o(a),n.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!1});return}if(!e.email){const a="Email is required.";o(a),n.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}if(!e.attending){const a="Please indicate if you're attending.";o(a),n.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,has_captcha_token:!!t});return}if(e.attending==="yes"&&e.guests.length===0){const a="Please add at least one guest.";o(a),n.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}if(e.attending==="no"&&!e.nonAttendingName){const a="Please provide your name.";o(a),n.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}p(!0),o(null);try{const a=e.attending==="yes"?e.guests.map((y,R)=>`${R+1}. ${y.firstName} ${y.lastName}`+(y.dietary?` - Dietary: ${y.dietary}`:"")+(y.note?` - Note: ${y.note}`:"")).join(`
`):`Not attending: ${e.nonAttendingName}`,u={email:e.email,attending:e.attending,guestsCount:e.attending==="yes"?e.guests.length:1,guests:a,notes:e.notes||"None",musicRequest:e.musicRequest||"None",recaptchaToken:t};console.log("Sending email with params:",u);const b=await Se.send("service_vvuhisc","template_4m25aki",u);console.log("EmailJS response:",b),n.event("rsvp_submit_success",{event_label:`RSVP ${e.attending==="yes"?"Accepted":"Declined"}`,attending:e.attending,guest_count:e.attending==="yes"?e.guests.length:1,dietary_requirements:e.guests[0]?.dietary||"none",music_request:e.musicRequest||"none",locale:document.documentElement.lang}),n.event("conversion",{event_label:"RSVP Completed",send_to:"AW-CONVERSION-ID"}),n.event("rsvp_confirmation_view",{event_label:"Viewed confirmation page"}),n.event("page_view",{page_title:"RSVP Confirmation",page_location:window.location.href,page_path:"/rsvp/confirmation"}),v(!0)}catch(a){console.error("Submission error:",a);const u=a?.text||a?.message||"Failed to submit RSVP. Please try again.",b=a?.text?"emailjs_error":"network_error";o(u),n.event("rsvp_submit_error",{event_label:b,error_message:u,error_type:b,current_step:i,attending_status:e.attending,has_captcha_token:!!t}),n.event("exception",{description:`RSVP Error: ${b} - ${u}`,fatal:!1})}finally{p(!1)}};return h.useEffect(()=>{g&&console.error("RSVP Error:",g)},[g]),{submit:l,sending:s,submitted:j,error:g,setError:o,setSubmitted:v}}const pt=({currentStep:e,totalSteps:t})=>{const i=(e+1)/t*100;return Array.from({length:t},(n,s)=>s),r.jsx("div",{className:"progress-bar-container",children:r.jsx("div",{className:"progress-bar",children:r.jsx("div",{className:"progress-bar__fill",style:{width:`${i}%`}})})})};let Z=!1,M=!1;const bt=Re(function(){const{t,ready:i}=H(["home","common","rsvp"]),n=ae();Pe();const[s,p]=h.useState(!1),[j,v]=h.useState(null),g=h.useRef(null),{form:o,currentStep:l,steps:a,error:u,handleChange:b,handleGuestsChange:y,nextStep:R,prevStep:w,hasValidGuests:m}=Qe({email:"",attending:"",guests:[],nonAttendingName:"",notes:"",website:""}),{submit:_,sending:f,submitted:N,error:c,setSubmitted:T}=ut(o,j,l),P=h.useRef(null),A=h.useRef(null),D=h.useRef(null),d=u||c;if(h.useEffect(()=>{Z||(n.event("rsvp_start",{event_label:"User started RSVP form"}),Z=!0),M=!1;const $=()=>{!N&&!M&&(n.event("rsvp_abandonment",{event_label:`Abandoned at ${a[l]}`,step_number:l+1,step_name:a[l]}),M=!0)};return window.addEventListener("beforeunload",$),()=>{window.removeEventListener("beforeunload",$),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{!window.location.pathname.includes("/rsvp")&&(!N&&!M&&(n.event("rsvp_abandonment",{event_label:`Abandoned at ${a[l]}`,step_number:l+1,step_name:a[l]}),M=!0),Z=!1),g.current=null},100)}},[l,a,N,n]),h.useEffect(()=>p(!0),[]),h.useEffect(()=>{d&&P.current&&(P.current.scrollIntoView({behavior:"smooth",block:"center"}),P.current.focus()),N&&A.current&&A.current.focus()},[d,N]),!i)return r.jsx("div",{className:"loading",children:t("common:loading")});if(N)return r.jsx(Je,{onReset:()=>T(!1),submittedRef:A});(l+1)/a.length*100;const x=()=>l===0?!o.attending||!o.email:l===1?o.attending==="yes"?!m:!o.nonAttendingName:l===2?!1:l===3?!j:!1,E=t("rsvp:steps",{returnObjects:!0}),O=a.map($=>E[$])[l];return r.jsxs("div",{className:"rsvp-page container",children:[r.jsx("h1",{children:"Rsvp"}),r.jsx("p",{className:"step-description",children:O}),r.jsx(pt,{currentStep:l,totalSteps:a.length}),r.jsxs("form",{className:"rsvp-form",onSubmit:$=>$.preventDefault(),children:[r.jsxs("div",{className:"form-navigation",children:[r.jsx("button",{type:"button",onClick:w,disabled:l===0,title:t("common:back")||"Back",children:r.jsx(q.Back,{})}),r.jsxs("span",{children:[l+1,"/",a.length]}),l<a.length-1?r.jsx("button",{type:"button",onClick:R,disabled:x(),title:t("common:next")||"Next",children:r.jsx(q.Next,{})}):r.jsx("button",{type:"button",onClick:_,disabled:f||x(),children:t(f?"rsvp:sending":"rsvp:submit")})]}),r.jsx(Ye,{currentStep:l,form:o,isClient:s,onChange:b,onGuestsChange:y,captchaToken:j,setCaptchaToken:v,recaptchaRef:D,error:d}),d&&r.jsx("div",{className:"rsvp-error",ref:P,role:"alert",tabIndex:-1,children:d})]})]})});export{bt as default};
