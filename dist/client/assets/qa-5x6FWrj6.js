import{a as o,w as X}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{I as v}from"./Icon-CCUsaovU.js";import{u as P}from"./useWeddingData-DQXGzUEP.js";import{m as N,A as O}from"./proxy-DBX3VoSC.js";import{M as V}from"./Map-n5kWIKdX.js";import{T as Z,D as ee}from"./DonateButton-DdRvjh9U.js";import{u as te}from"./useTranslation-B9zSoiKr.js";import"./i18next-BDvusv7y.js";const z=(c,y)=>c>60?v.Rain:c>30?v.Cloud:y<=0?v.Snow:v.Sun,ae=({test:c})=>{console.log("WeatherForecast rendered with test =",c);const y=P(),{lat:n,lng:x}=y.wedding.ceremony.venue.coordinates,d=o.useMemo(()=>new Date(y.wedding.date),[y.wedding.date]),[m,M]=o.useState([]),[t,D]=o.useState(null),[l,$]=o.useState(null),[C,S]=o.useState(!0),[i,u]=o.useState(!1),p=a=>a.toISOString().split("T")[0],r=a=>a.toLocaleDateString(void 0,{month:"short",day:"numeric"}),f=o.useMemo(()=>{if(!m.length)return"";const a=new Date(m[0].rawDate),h=new Date(m[m.length-1].rawDate),w=`${a.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}, ${a.getFullYear()}`,s=`${h.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}, ${h.getFullYear()}`;return`${w} â€“ ${s}`},[m]),L=o.useMemo(()=>{if(!t)return"";const[a,h]=t.measuredRange.split(" â€“ ");return`${a}, ${d.getFullYear()-1} â€“ ${h}, ${d.getFullYear()-1}`},[t,d]),T=o.useMemo(()=>l?`${l.date}, ${l.year}`:"",[l]);return o.useEffect(()=>{let a=!1;return(async()=>{try{const w=`https://api.open-meteo.com/v1/forecast?latitude=${n}&longitude=${x}&daily=temperature_2m_max,precipitation_probability_max&timezone=auto`,s=d.getFullYear()-1,j=d.getMonth(),_=new Date(s,j,1),q=new Date(s,j+1,0),H=`https://archive-api.open-meteo.com/v1/archive?latitude=${n}&longitude=${x}&start_date=${p(_)}&end_date=${p(q)}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto`,[W,R]=await Promise.all([fetch(w),fetch(H)]);if(!W.ok||!R.ok)throw new Error("Weather fetch failed");const F=await W.json(),b=await R.json();if(a)return;const J=F.daily.time.slice(0,7).map((g,k)=>({rawDate:g,date:new Date(g).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),temp:Math.round(F.daily.temperature_2m_max[k]),precipitation:Math.round(F.daily.precipitation_probability_max?.[k]??0)}));M(J);const Y=b.daily.temperature_2m_max,K=b.daily.temperature_2m_min,A=b.daily.precipitation_sum,U=A.length,B=A.filter(g=>g>1).length,Q=U-B;D({avgTemp:Math.round((g=>g.reduce((k,G)=>k+G,0)/g.length)(Y)),maxTemp:Math.round(Math.max(...Y)),minTemp:Math.round(Math.min(...K)),rainyDays:B,sunnyDays:Q,totalDays:U,measuredRange:`${r(_)} â€“ ${r(q)}`});const E=p(new Date(s,j,d.getDate())),I=b.daily.time.findIndex(g=>g===E);I>=0&&$({temp:Math.round(b.daily.temperature_2m_max[I]),precipitation:Math.round(b.daily.precipitation_sum[I]),date:r(new Date(E)),year:s})}catch{a||u(!0)}finally{a||S(!1)}})(),()=>{a=!0}},[n,x,d]),C?e.jsxs("div",{className:"weather-forecast loading",children:[e.jsx(v.More,{className:"loading-spinner"}),e.jsx("p",{children:"Loading weatherâ€¦"})]}):i?e.jsxs("div",{className:"weather-forecast error",children:[e.jsx(v.Cloud,{}),e.jsx("p",{children:e.jsx("strong",{children:"Weather unavailable"})}),e.jsx("small",{children:"Typical summer weather: warm & sunny â˜€ï¸"})]}):e.jsxs(N.div,{className:"weather-forecast compact",initial:{opacity:0},animate:{opacity:1},children:[m.length>0&&e.jsx("strong",{children:f}),e.jsx("div",{className:"weather-forecast__forecast",children:m.slice(0,5).map((a,h)=>{const w=z(a.precipitation,a.temp),s=new Date,j=new Date(a.rawDate),_=s.getFullYear()===j.getFullYear()&&s.getMonth()===j.getMonth()&&s.getDate()===j.getDate();return e.jsxs("div",{className:`weather-day${_?" today":""}`,children:[e.jsxs("div",{className:"date",children:[e.jsx("div",{className:"icon",children:e.jsx(w,{size:18})}),a.date," ",_&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"(today)"]})]}),e.jsxs("div",{children:[a.precipitation>30&&e.jsxs("div",{className:"rain",children:[a.precipitation,"% prec."]}),e.jsxs("div",{className:"temp",children:[a.temp,"Â°"]})]})]},h)})}),l&&e.jsxs("div",{className:"weather-forecast__wedding-day",children:[e.jsxs("strong",{children:[T,":"]}),e.jsx("div",{className:"icon",children:z(l.precipitation,l.temp)({size:18})}),e.jsxs("span",{children:[l.temp,"Â°"]}),l.precipitation>0&&e.jsxs("span",{children:[" â€¢ ðŸ’§ ",l.precipitation,"mm"]})]}),t&&e.jsxs("div",{className:"weather-forecast__typical",children:[e.jsx("small",{children:L}),e.jsxs("span",{children:["ðŸŒ§ ",t.rainyDays," rainy days â€¢ â˜€ï¸ ",t.sunnyDays," sunny days"]}),e.jsxs("span",{children:["ðŸŒ¡ ",t.avgTemp,"Â°C avg / ",t.maxTemp,"Â° / ",t.minTemp,"Â°"]})]})]})},ne=()=>{const{t:c,ready:y}=te("qa"),n=P(),[x,d]=o.useState("essentials"),[m,M]=o.useState(null);if(!y)return e.jsx("div",{className:"loading",children:c("loading","Loading...")});const t=o.useMemo(()=>{const i=n.schedule.find(s=>s.id==="bus"),u=n.contact.find(s=>s.name.includes(n.bride.firstName)),p=n.contact.find(s=>s.name.includes(n.groom.firstName)),r=n.schedule.find(s=>s.id==="bus"),f=r?.maps[1]?.coordinates||null,L=r?.maps[1]?.extraCoordinates||[],T=r?.maps[1]?.mapUrl||"",a=r?.maps[1]?.showRoute||!1,h=r?.maps[1]?.interactive||!1,w=r?.maps[1]?.label||"Bus Route";return{bus:{mainCoords:f,extraCoords:L.map(s=>({lat:s.lat,lng:s.lng,label:s.label||"",showMarker:!0})),mapUrl:T,showRoute:a,interactive:h,label:w},venueCoordinates:n.wedding.ceremony.venue.coordinates,rsvpDeadline:n.rsvp.deadline,ceremonyTime:n.wedding.ceremony.time,ceremonyVenue:n.wedding.ceremony.venue.longName,venueMapLink:n.wedding.ceremony.venue.mapLink,venueWebsite:n.wedding.ceremony.venue.website,busTime:i?.time||"13:00",weddingDate:new Date(n.wedding.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),brideFirstName:n.bride.firstName,bridePhone:u?.phone||"",groomFirstName:n.groom.firstName,groomPhone:p?.phone||"",airports:n.travel?.nearestAirport||[],hotels:n.travel?.hotels||[]}},[n]),D=o.useMemo(()=>c("items",{returnObjects:!0,...t})||[],[c,t]),l=o.useMemo(()=>D.filter(i=>x==="all"?!0:i.category===x),[D,x]),$=o.useCallback(i=>{M(u=>u===i?null:i)},[]),C=o.useCallback(i=>{d(i),M(null)},[]),S=["essentials","logistics","style","family","gifts","travel","all"];return e.jsxs("div",{className:"qa-page container",children:[e.jsx(N.h1,{className:"qa-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:c("title")}),e.jsx("div",{className:"qa-categories",children:S.map(i=>e.jsx(N.button,{className:`category-tab ${x===i?"active":""}`,onClick:()=>C(i),whileHover:{},whileTap:{},children:c(i)},i))}),e.jsx("div",{className:"qa-list",children:e.jsx(O,{mode:"popLayout",children:l.map(i=>{const u=D.findIndex(r=>r.question===i.question),p=m===u;return e.jsxs(N.div,{className:"qa-item",layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsxs("button",{className:`qa-question ${p?"open":""}`,onClick:()=>$(u),children:[e.jsx("span",{children:i.question}),e.jsx(v.Down,{className:`chevron ${p?"rotate-180":""}`})]}),e.jsx(O,{children:p&&e.jsx(N.div,{className:"qa-answer",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:e.jsx("div",{className:"answer-content",children:e.jsx(Z,{i18nKey:`items.${u}.answer`,t:c,values:t,components:{VenueLink:e.jsx("a",{href:t.venueWebsite,target:"_blank",rel:"noopener noreferrer",style:{fontWeight:"bold",textDecoration:"none",color:"inherit"},children:t.ceremonyVenue}),MapVenue:e.jsx(V,{coordinates:t.venueCoordinates,label:t.ceremonyVenue,mapUrl:t.venueMapLink,interactive:!0,zoom:12}),MapBus:e.jsx(V,{label:t.bus.label,coordinates:t.bus.mainCoords,extraCoordinates:t.bus.extraCoords,mapUrl:t.bus.mapUrl,showRoute:t.bus.showRoute,interactive:t.bus.interactive,width:"100%",height:"400px"}),DonateButton:e.jsx(ee,{}),WeatherForecast:e.jsx(ae,{}),SkyscannerLink:e.jsx("a",{href:"https://www.skyscanner.com/",target:"_blank",rel:"noopener noreferrer",children:c("links.skyscanner","Skyscanner")}),AirBnbLink:e.jsx("a",{href:"https://www.airbnb.com/",target:"_blank",rel:"noopener noreferrer",children:c("links.airbnb","AirBnB")}),AirportsList:e.jsx("ul",{children:t.airports.map((r,f)=>e.jsxs("li",{children:[e.jsxs("strong",{children:[r.name," (",r.code,")"]})," ","â€“ ",c("distance",{distance:r.distance}),","," ",c("transport",{transport:r.transportOptions.join(", ")})]},f))}),HotelLinks:e.jsx("ul",{children:t.hotels.map((r,f)=>e.jsx("li",{children:e.jsxs("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",children:[r.name," â€“ ",r.address]})},f))}),strong:e.jsx("strong",{}),p:e.jsx("p",{}),br:e.jsx("br",{})}})})})})]},i.question)})})})]})},he=X(ne);export{he as default};
