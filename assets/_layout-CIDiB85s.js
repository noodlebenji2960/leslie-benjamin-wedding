import{p as w,a as u,t as I,w as P,v as R}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{u as A,C as q,a as W,R as $}from"./CookieConsentModal-GFIkp2ao.js";import{u as b}from"./useTranslation-B9zSoiKr.js";import{u as E,b as z}from"./SessionContext-zqiVhUqH.js";import{u as V}from"./ThemeContext-_9vuco75.js";import{I as B}from"./Icon-D5em7eLC.js";import{u as H}from"./useWeddingData-DmPkR6aw.js";import{M as S,T as L}from"./Modal-DHSU4XOf.js";import{A as T,m as M}from"./proxy-DBX3VoSC.js";import"./i18next-BDvusv7y.js";function O({locale:o,links:s}){const{buildLink:l}=A(),{t:c}=b(["common"]),a=w(),i=u.useRef(null),[r,h]=u.useState({left:0,top:0,width:0}),[f,p]=u.useState(!1),m=(n=>n.replace(/^\/(en|es)/,"")||"/")(a.pathname),x=m==="/"||m==="",j=n=>{if(!i.current||!n)return;const t=i.current.getBoundingClientRect(),d=n.getBoundingClientRect();h({left:d.left-t.left,top:d.bottom-t.top-3,width:d.width})},g=n=>{p(!0),j(n)},v=()=>p(!1);return u.useEffect(()=>{if(f||!i.current)return;const n=Array.from(i.current.querySelectorAll(".nav-link")),t=s.findIndex(d=>d.path==="/"?x:m===d.path);t!==-1&&j(n[t])},[a.pathname,o,f,s,x,m]),u.useLayoutEffect(()=>{const n=()=>{if(!i.current)return;const t=Array.from(i.current.querySelectorAll(".nav-link")),d=s.findIndex(N=>N.path==="/"?x:m===N.path);d!==-1&&j(t[d])};return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[s,x,m]),e.jsx("nav",{className:"nav",children:e.jsxs("div",{className:"nav-links desktop",ref:i,children:[s.map(n=>e.jsx(I,{to:l(n.path),className:"nav-link",ref:t=>{},onMouseEnter:t=>g(t.currentTarget),onMouseLeave:v,children:n.label},n.path)),e.jsx("div",{className:"nav-indicator",style:{transform:`translate(${r.left}px)`,width:r.width}})]})})}function D({currentLocale:o,onSwitch:s,isPending:l=!1}){return e.jsx("button",{className:"language-switcher",onClick:s,disabled:l,"aria-label":`Switch to ${o==="es"?"English":"Spanish"}`,children:e.jsxs("div",{className:"language-icons",children:[e.jsx("span",{className:`language-label ${o==="es"?"active":""}`,children:"ES"}),e.jsx("span",{className:`language-label ${o==="en"?"active":""}`,children:"EN"})]})})}const _=["light","dark"],K={light:"Light mode",dark:"Dark mode",system:"System"};function Y(){const{theme:o,setTheme:s}=V(),l=_.indexOf(o),c=()=>{const a=(l+1)%_.length,i=_[a]??_[0];s(i)};return e.jsx("button",{className:"theme-toggle-slider",onClick:c,"aria-label":`${K[o]}. Click to switch theme.`,children:e.jsxs("div",{className:"toggle-icons",children:[e.jsx("span",{className:`icon sun ${o==="light"?"active":""}`,children:"â˜€ï¸Ž"}),e.jsx("span",{className:`icon moon ${o==="dark"?"active":""}`,children:"â¾"})]})})}function F({onClick:o}){const[s,l]=u.useState(!1);return u.useEffect(()=>{const c=()=>{l(window.scrollY>150)};return c(),window.addEventListener("scroll",c),()=>window.removeEventListener("scroll",c)},[]),e.jsx("button",{className:`back-to-top ${s?"visible":""}`,onClick:o,"aria-label":"Back to top",children:e.jsx(B.Up,{})})}const G=({openCookieConsentModal:o})=>{const s=w(),{locale:l}=E(),c=H(),{t:a}=b(),i=s.pathname==="/"||s.pathname===""||s.pathname===`/${l}`;if(!c?.wedding)return null;const{date:r}=c.wedding,{time:h}=c.wedding.ceremony;return e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-content",children:[!i&&e.jsx(q,{size:"sm",date:r,time:h}),e.jsx("button",{onClick:o,className:"footer__cookie-btn",children:a("common:change_cookie_preferences","See cookie Preferences.")})]})})};function U({isOpen:o,onClose:s,children:l,autoClose:c=3e3}){const a=u.useRef(null);u.useEffect(()=>(a.current&&(clearTimeout(a.current),a.current=null),o&&c&&(a.current=setTimeout(()=>{s(),a.current=null},c)),()=>{a.current&&(clearTimeout(a.current),a.current=null)}),[o,c,s]);const i={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95}};return e.jsx(T,{children:o&&e.jsx(M.div,{className:"toast-wrapper",variants:i,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.4,ease:"easeInOut"},children:e.jsx("div",{className:"toast-content",children:l})})})}function C(){return e.jsx("span",{className:"wave-emoji",role:"img","aria-label":"waving hand",children:"ðŸ‘‹"})}const k=[{key:"necessary",label:"Necessary cookies (required)",required:!0},{key:"analytics",label:"Analytics cookies"},{key:"personalization",label:"Personalization cookies"}];function J({isOpen:o,onClose:s,mode:l="first_visit"}){const{visitor:c,cookiePreference:a,setCookiePreference:i}=z(),{t:r}=b(["home","common"]),[h,f]=u.useState(()=>k.reduce((n,t)=>(n[t.key]=t.required?!0:a?.[t.key]??!1,n),{})),p=h.personalization===!0,[y,m]=u.useState(l==="change_preferences"||a===null);if(u.useEffect(()=>{o&&(f(k.reduce((n,t)=>(n[t.key]=t.required?!0:a?.[t.key]??!1,n),{})),m(l==="change_preferences"||a===null))},[o,a,l]),!c)return e.jsx(S,{isOpen:o,onClose:s,children:e.jsx("p",{className:"ccm__loading",children:r("common:loading","Loading...")})});const x=()=>{i(h),s()},j=()=>{const n=k.reduce((t,d)=>(t[d.key]=!0,t),{});f(n),i(n),s()},g=()=>{const n=k.reduce((t,d)=>(t[d.key]=!!d.required,t),{});f(n),i(n),s()},v=()=>p?l!=="first_visit"?r("common:change_preferences_prompt","Change your preferences to improve your experience."):c.isFirstVisit?e.jsxs(L,{i18nKey:"home:welcome_first_visit",components:{emoji:e.jsx(C,{})},children:["Welcome to our wedding website! ",e.jsx("emoji",{})]}):c.daysSinceLastVisit===0?e.jsxs(L,{i18nKey:"home:welcome_back_today",components:{emoji:e.jsx(C,{})},children:["Welcome back! ",e.jsx("emoji",{})]}):c.daysSinceLastVisit===1?r("home:welcome_back_yesterday","Great to see you again! You were here yesterday."):c.daysSinceLastVisit<7?r("home:welcome_back_days","Welcome back! It's been {{days}} days since your last visit.",{days:c.daysSinceLastVisit}):r("home:welcome_back_long_time","Welcome back! We've missed you! It's been {{days}} days.",{days:c.daysSinceLastVisit}):r("common:welcome_generic","Welcome to our wedding website!");return a&&l==="first_visit"?e.jsx(U,{isOpen:o,onClose:s,autoClose:3e3,children:e.jsx("p",{className:"ccm__greeting",children:v()})}):e.jsx(S,{isOpen:o,onClose:s,children:e.jsxs("div",{className:"ccm",children:[e.jsx("button",{className:"ccm__close",onClick:s,"aria-label":r("common:close","Close modal"),children:"Ã—"}),e.jsx("p",{className:"ccm__greeting",children:v()}),y?e.jsxs("div",{className:"ccm__preferences",id:"cookie-preferences",children:[e.jsx("p",{className:"ccm__intro",children:r("common:cookie_intro","We use cookies to improve your experience. You can choose which types of cookies you allow:")}),e.jsx("div",{className:"ccm__checkboxes",children:k.map(n=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h[n.key],disabled:n.required,onChange:t=>f({...h,[n.key]:t.target.checked})}),n.label]},n.key))}),e.jsxs("div",{className:"ccm__actions",children:[e.jsx("button",{className:"ccm__save-btn",onClick:x,children:r("common:save_preferences","Save Preferences")}),e.jsx("button",{className:"ccm__accept-all-btn",onClick:j,children:r("common:accept_all","Accept All")}),e.jsx("button",{className:"ccm__reject-all-btn",onClick:g,children:r("common:reject_all","Reject All")})]})]}):e.jsx("button",{className:"ccm__toggle-btn",onClick:()=>m(!0),children:r("common:show_preferences","Show Preferences")})]})})}const re=P(function(){const s=w(),l=R(),[c,a]=u.useTransition(),{locale:i,switchLanguage:r}=E(),[h,f]=u.useState(!1),{t:p}=b(["common"]),y=u.useRef(null),[m,x]=u.useState("first_visit"),[j,g]=u.useState(!0),v=W(()=>{});u.useEffect(()=>{v?.scrollTo(0,{immediate:!0})},[s.pathname,v]);const n=[{path:"/",label:p("nav.home")},{path:"/rsvp",label:p("nav.rsvp")},{path:"/schedule",label:p("nav.schedule")},{path:"/qa",label:p("nav.qa")}],t=()=>{x("change_preferences"),g(!0)},d=()=>{g(!1)};return u.useEffect(()=>{console.log("cookieConsentModalMode",m),j||x("first_visit")},[m]),e.jsxs($,{root:!0,children:[e.jsx(J,{isOpen:j,onClose:d,mode:m}),e.jsxs("div",{className:"container",children:[e.jsx(O,{menuOpen:h,setMenuOpen:f,locale:i,links:n,onLanguageSwitch:()=>a(r),isPending:c,hamburgerRef:y}),e.jsxs("main",{className:"main",children:[e.jsx(T,{mode:"wait",children:e.jsx(M.div,{className:"page-content",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},children:l},s.pathname)}),e.jsxs("div",{className:"fixed-container",children:[e.jsx(D,{currentLocale:i,onSwitch:r,isPending:c}),e.jsxs("div",{className:"group",children:[e.jsx(F,{onClick:()=>v?.scrollTo(0,{duration:1})}),e.jsx(Y,{})]})]}),e.jsx(G,{openCookieConsentModal:t})]})]})]})});export{re as default};
