import{p as M,a,t as W,w as z,v as V}from"./chunk-LFPYN7LY-BSAdruXa.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{u as Y,m as S,a as H,A as P,M as C,T as R}from"./Modal-Dty3x_TM.js";import{u as E,b as L,c as K}from"./ConfigContext-CvZK-xEr.js";import{L as D,B as F,T as G}from"./BackToTopButton-BX6E2S2K.js";import{u as $,R as J}from"./lenis-react-fYMU8h9a.js";import{u as N}from"./LayoutContext-p-UZ0jeN.js";import{u as Q}from"./SessionContext-B5pbQPxO.js";import"./i18next-CMP4XeMd.js";import"./ThemeContext-C78cNuM2.js";function U({locale:d,links:o}){const u=E(),{buildLink:i}=Y(),n=M(),l=a.useRef(null),[c,x]=a.useState({left:0,top:0,width:0}),[h,p]=a.useState(!1),f=(t=>t.replace(/^\/(en|es)/,"")||"/")(n.pathname),k=f==="/"||f==="",y=a.useMemo(()=>o.filter(t=>{const r=t.path.replace("/","")||"home";return u[r]?.enabled??!0}),[o,u]),j=t=>{if(!l.current||!t)return;const r=l.current.getBoundingClientRect(),m=t.getBoundingClientRect();x({left:m.left-r.left,top:m.bottom-r.top-3,width:m.width})},v=t=>{p(!0),j(t)},s=()=>p(!1);return a.useEffect(()=>{if(h||!l.current)return;const t=Array.from(l.current.querySelectorAll(".nav-link")),r=y.findIndex(m=>m.path==="/"?k:f===m.path);r!==-1&&j(t[r])},[n.pathname,d,h,y,k,f]),a.useLayoutEffect(()=>{const t=()=>{if(!l.current)return;const r=Array.from(l.current.querySelectorAll(".nav-link")),m=y.findIndex(g=>g.path==="/"?k:f===g.path);m!==-1&&j(r[m])};return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[y,k,f]),u.layout?.showHeader?.enabled?e.jsx("nav",{className:"nav",children:e.jsxs("div",{className:"nav-links desktop",ref:l,children:[y.map(t=>e.jsx(W,{to:i(t.path),className:"nav-link",ref:r=>{},onMouseEnter:r=>v(r.currentTarget),onMouseLeave:s,children:t.label},t.path)),e.jsx("div",{className:"nav-indicator",style:{transform:`translate(${c.left}px)`,width:c.width}})]})}):null}const X=({openCookieConsentModal:d})=>{const{state:{fixedOffsetY:o}}=N(),u=H(),{t:i}=L();if(!u?.wedding)return null;const n=Math.max(20,-o+20);return e.jsx(S.footer,{className:"footer",animate:{paddingBottom:`${n}px`,opacity:1,y:0},initial:{opacity:0,y:20,paddingBottom:"20px"},transition:{paddingBottom:{type:"spring",stiffness:300,damping:30},opacity:{duration:.4},y:{duration:.4}},children:e.jsx("div",{className:"footer-content",children:e.jsx("button",{onClick:d,className:"footer__cookie-btn",children:i("common:change_cookie_preferences","See cookie Preferences.")})})})};function Z({isOpen:d,onClose:o,children:u,autoClose:i=3e3}){const n=a.useRef(null);a.useEffect(()=>(n.current&&(clearTimeout(n.current),n.current=null),d&&i&&(n.current=setTimeout(()=>{o(),n.current=null},i)),()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[d,i,o]);const l={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95}};return e.jsx(P,{children:d&&e.jsx(S.div,{className:"toast-wrapper",variants:l,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.4,ease:"easeInOut"},children:e.jsx("div",{className:"toast-content",children:u})})})}function T(){return e.jsx("span",{className:"wave-emoji",role:"img","aria-label":"waving hand",children:"ðŸ‘‹"})}const b=[{key:"necessary",label:"Necessary cookies (required)",required:!0},{key:"analytics",label:"Analytics cookies"},{key:"personalization",label:"Personalization cookies"}];function ee({isOpen:d,onClose:o,mode:u="first_visit"}){const{visitor:i,cookiePreference:n,setCookiePreference:l}=Q(),{t:c}=L(["home","common"]),[x,h]=a.useState(()=>b.reduce((s,t)=>(s[t.key]=t.required?!0:n?.[t.key]??!1,s),{})),p=x.personalization===!0,[w,f]=a.useState(u==="change_preferences"||n===null);if(a.useEffect(()=>{d&&(h(b.reduce((s,t)=>(s[t.key]=t.required?!0:n?.[t.key]??!1,s),{})),f(u==="change_preferences"||n===null))},[d,n,u]),!i)return e.jsx(C,{isOpen:d,onClose:o,children:e.jsx("p",{className:"ccm__loading",children:c("common:loading","Loading...")})});const k=()=>{l(x),o()},y=()=>{const s=b.reduce((t,r)=>(t[r.key]=!0,t),{});h(s),l(s),o()},j=()=>{const s=b.reduce((t,r)=>(t[r.key]=!!r.required,t),{});h(s),l(s),o()},v=()=>p?u!=="first_visit"?c("common:change_preferences_prompt","Change your preferences to improve your experience."):i.isFirstVisit?e.jsxs(R,{i18nKey:"home:welcome_first_visit",components:{emoji:e.jsx(T,{})},children:["Welcome to our wedding website! ",e.jsx("emoji",{})]}):i.daysSinceLastVisit===0?e.jsxs(R,{i18nKey:"home:welcome_back_today",components:{emoji:e.jsx(T,{})},children:["Welcome back! ",e.jsx("emoji",{})]}):i.daysSinceLastVisit===1?c("home:welcome_back_yesterday","Great to see you again! You were here yesterday."):i.daysSinceLastVisit<7?c("home:welcome_back_days","Welcome back! It's been {{days}} days since your last visit.",{days:i.daysSinceLastVisit}):c("home:welcome_back_long_time","Welcome back! We've missed you! It's been {{days}} days.",{days:i.daysSinceLastVisit}):c("common:welcome_generic","Welcome to our wedding website!");return n&&u==="first_visit"?e.jsx(Z,{isOpen:d,onClose:o,autoClose:3e3,children:e.jsx("p",{className:"ccm__greeting",children:v()})}):e.jsx(C,{isOpen:d,onClose:o,children:e.jsxs("div",{className:"ccm",children:[e.jsx("button",{className:"ccm__close",onClick:o,"aria-label":c("common:close","Close modal"),children:"Ã—"}),e.jsx("p",{className:"ccm__greeting",children:v()}),w?e.jsxs("div",{className:"ccm__preferences",id:"cookie-preferences",children:[e.jsx("p",{className:"ccm__intro",children:c("common:cookie_intro","We use cookies to improve your experience. You can choose which types of cookies you allow:")}),e.jsx("div",{className:"ccm__checkboxes",children:b.map(s=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:x[s.key],disabled:s.required,onChange:t=>h({...x,[s.key]:t.target.checked})}),s.label]},s.key))}),e.jsxs("div",{className:"ccm__actions",children:[e.jsx("button",{className:"ccm__save-btn",onClick:k,children:c("common:save_preferences","Save Preferences")}),e.jsx("button",{className:"ccm__accept-all-btn",onClick:y,children:c("common:accept_all","Accept All")}),e.jsx("button",{className:"ccm__reject-all-btn",onClick:j,children:c("common:reject_all","Reject All")})]})]}):e.jsx("button",{className:"ccm__toggle-btn",onClick:()=>f(!0),children:c("common:show_preferences","Show Preferences")})]})})}const de=z(function(){const o=M(),u=V(),[i,n]=a.useTransition(),{locale:l,switchLanguage:c}=K(),[x,h]=a.useState(!1),{t:p}=L(["common"]),w=a.useRef(null),[f,k]=a.useState("first_visit"),[y,j]=a.useState(!0),v=a.useRef(null),s=N(),t=E(),r=$(()=>{}),{state:{fixedOffsetY:m}}=N(),g=a.useRef(!1);a.useEffect(()=>{if(!r||g.current)return;g.current=!0;const _=setTimeout(()=>{r.scrollTo(0,{immediate:!0})},400);return()=>{clearTimeout(_),g.current=!1}},[o.pathname,r]);const A=[{path:"/",label:p("nav.home")},{path:"/rsvp",label:p("nav.rsvp"),feature:"rsvp"},{path:"/schedule",label:p("nav.schedule"),feature:"schedule"},{path:"/qa",label:p("nav.qa"),feature:"qa"}].filter(_=>_.feature?!!_.feature.split(".").reduce((B,O)=>B?.[O],t):!0),I=()=>{k("change_preferences"),j(!0)},q=()=>{j(!1)};return a.useEffect(()=>{v.current&&v.current.style.setProperty("--y-offset",s.state.fixedOffsetY*-1+"px")},[s.state.fixedOffsetY]),e.jsxs(J,{root:!0,options:{prevent:_=>_.closest(".search-dropdown__list")!==null},children:[e.jsx(ee,{isOpen:y,onClose:q,mode:f}),e.jsxs("div",{className:"container",children:[e.jsx(U,{menuOpen:x,setMenuOpen:h,locale:l,links:A,onLanguageSwitch:()=>n(c),isPending:i,hamburgerRef:w}),e.jsxs("main",{className:"main",ref:v,children:[e.jsx(P,{mode:"wait",children:e.jsx(S.div,{className:"page-content",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},children:u},o.pathname)}),e.jsxs(S.div,{className:"fixed-container",animate:{y:m},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsx(D,{currentLocale:l,onSwitch:c,isPending:i}),e.jsxs("div",{className:"group",children:[e.jsx(F,{onClick:()=>r?.scrollTo(0,{duration:1})}),t.layout.theme.enabled&&e.jsx(G,{})]})]}),e.jsx(X,{openCookieConsentModal:I})]})]})]})});export{de as default};
