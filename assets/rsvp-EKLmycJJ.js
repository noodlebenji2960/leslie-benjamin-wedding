import{a as h,y as ue,w as Re,p as we}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as s}from"./jsx-runtime-u17CrQMm.js";import{I as k}from"./Icon-BmBaWoLz.js";import{u as I}from"./useTranslation-B9zSoiKr.js";import{m as O,A as ee}from"./proxy-DBX3VoSC.js";import{u as te}from"./AnalyticsContext-CJAiYubj.js";const se=({index:e,guest:t,onUpdate:i,onRemove:r,onConfirm:n,isDraft:d=!1,isRostered:g=!1})=>{const{t:m}=I(["rsvp"]),[v,p]=h.useState(!1),[o,a]=h.useState(!1),[c,f]=h.useState(!1),[y,R]=h.useState(!1),x=h.useRef(null),S=t.firstName.trim()&&t.lastName.trim(),j=(u,_)=>{i?.(e,u,_)};return h.useEffect(()=>{t.dietary&&p(!0),t.note&&a(!0),t.musicRequest&&f(!0)},[t.dietary,t.note,t.musicRequest]),h.useEffect(()=>{const u=_=>{x.current&&!x.current.contains(_.target)&&R(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]),s.jsxs(O.div,{className:`guest-card ${S?"":"invalid"}`,layout:"position",initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{type:"spring",stiffness:400,damping:30,layout:{type:"spring",stiffness:500}},children:[s.jsxs("div",{className:"inputs-container",children:[s.jsxs("div",{className:"form-row",children:[s.jsx("input",{type:"text",placeholder:m("rsvp:firstName"),value:t.firstName,onChange:u=>j("firstName",u.target.value)}),s.jsx("input",{type:"text",placeholder:m("rsvp:lastName"),value:t.lastName,onChange:u=>j("lastName",u.target.value)})]}),s.jsxs(ee,{children:[v&&s.jsxs(O.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[s.jsx("input",{type:"text",placeholder:m("rsvp:dietaryPlaceholder"),value:t.dietary,onChange:u=>j("dietary",u.target.value)}),s.jsx("button",{type:"button",className:"close-btn",onClick:()=>p(!1),children:"×"})]}),o&&s.jsxs(O.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[s.jsx("textarea",{placeholder:m("rsvp:notePlaceholder"),value:t.note||"",onChange:u=>j("note",u.target.value)}),s.jsx("button",{type:"button",className:"close-btn",onClick:()=>a(!1),children:"×"})]}),c&&s.jsxs(O.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[s.jsx("input",{type:"text",placeholder:m("rsvp:musicRequestPlaceholder"),value:t.musicRequest||"",onChange:u=>j("musicRequest",u.target.value)}),s.jsx("button",{type:"button",className:"close-btn",onClick:()=>f(!1),children:"×"})]})]})]}),s.jsx("div",{className:"guest-card-actions",children:d?s.jsx(s.Fragment,{children:s.jsx(O.button,{type:"button",className:"form-btn add-guest-btn",disabled:!S,onClick:()=>{n&&n(),R(!1),p(!1),a(!1),f(!1)},whileHover:S?{scale:1.02}:{},title:m("rsvp:addGuest"),children:s.jsx(k.Add,{})})}):s.jsxs(s.Fragment,{children:[!v&&s.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>p(!0),title:m("rsvp:addDietary"),children:s.jsx(k.Food,{})}),!o&&s.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>a(!0),title:m("rsvp:addNote"),children:s.jsx(k.Note,{})}),!c&&s.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>f(!0),title:m("rsvp:addMusicRequest"),children:s.jsx(k.Music,{})}),s.jsx("button",{type:"button",className:"remove-guest",onClick:()=>{window.confirm(`Are you sure you want to remove ${t.firstName} ${t.lastName} from the guest roster?`)&&r?.(e)},children:s.jsx(k.Close,{})})]})})]})},ie={firstName:"",lastName:"",dietary:"",note:""},Ne=({guests:e,onGuestsChange:t})=>{const{t:i}=I(["rsvp"]),[r,n]=h.useState(ie),d=h.useCallback(()=>{!r.firstName.trim()||!r.lastName.trim()||(t([...e,r]),n(ie))},[r,e,t]),g=h.useCallback(p=>{t(e.filter((o,a)=>a!==p))},[e,t]),m=h.useCallback((p,o,a)=>{t(e.map((c,f)=>f===p?{...c,[o]:a}:c))},[e,t]),v=h.useCallback((p,o)=>{n(a=>({...a,[p]:o}))},[]);return s.jsxs("div",{className:"guests-section",children:[s.jsxs("h3",{children:[i("rsvp:guestsTitle"),e.length>0&&` (${e.length})`]}),s.jsxs(ee,{children:[e.map((p,o)=>s.jsx(se,{index:o,guest:p,onUpdate:m,onRemove:g,isRostered:!0},`roster-${o}`)),s.jsx(se,{index:e.length,guest:r,onUpdate:(p,o,a)=>v(o,a),onConfirm:d,isDraft:!0},"draft")]})]})};var U={exports:{}},G,ae;function Pe(){if(ae)return G;ae=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return G=e,G}var B,oe;function Te(){if(oe)return B;oe=1;var e=Pe();function t(){}function i(){}return i.resetWarningCache=t,B=function(){function r(g,m,v,p,o,a){if(a!==e){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}r.isRequired=r;function n(){return r}var d={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:n,element:r,elementType:r,instanceOf:n,node:r,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:i,resetWarningCache:t};return d.PropTypes=d,d},B}var ce;function Oe(){return ce||(ce=1,U.exports=Te()()),U.exports}var Ee=Oe();const T=ue(Ee);var Ce=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},z.apply(this,arguments)}function Le(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,d;for(d=0;d<r.length;d++)n=r[d],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function D(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,J(e,t)}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},J(e,t)}var H=(function(e){ke(t,e);function t(){var r;return r=e.call(this)||this,r.handleExpired=r.handleExpired.bind(D(r)),r.handleErrored=r.handleErrored.bind(D(r)),r.handleChange=r.handleChange.bind(D(r)),r.handleRecaptchaRef=r.handleRecaptchaRef.bind(D(r)),r}var i=t.prototype;return i.getCaptchaFunction=function(n){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[n]:this.props.grecaptcha[n]:null},i.getValue=function(){var n=this.getCaptchaFunction("getResponse");return n&&this._widgetId!==void 0?n(this._widgetId):null},i.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},i.execute=function(){var n=this.getCaptchaFunction("execute");if(n&&this._widgetId!==void 0)return n(this._widgetId);this._executeRequested=!0},i.executeAsync=function(){var n=this;return new Promise(function(d,g){n.executionResolve=d,n.executionReject=g,n.execute()})},i.reset=function(){var n=this.getCaptchaFunction("reset");n&&this._widgetId!==void 0&&n(this._widgetId)},i.forceReset=function(){var n=this.getCaptchaFunction("reset");n&&n()},i.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},i.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},i.handleChange=function(n){this.props.onChange&&this.props.onChange(n),this.executionResolve&&(this.executionResolve(n),delete this.executionReject,delete this.executionResolve)},i.explicitRender=function(){var n=this.getCaptchaFunction("render");if(n&&this._widgetId===void 0){var d=document.createElement("div");this._widgetId=n(d,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(d)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},i.componentDidMount=function(){this.explicitRender()},i.componentDidUpdate=function(){this.explicitRender()},i.handleRecaptchaRef=function(n){this.captcha=n},i.render=function(){var n=this.props;n.sitekey,n.onChange,n.theme,n.type,n.tabindex,n.onExpired,n.onErrored,n.size,n.stoken,n.grecaptcha,n.badge,n.hl,n.isolated;var d=Le(n,Ce);return h.createElement("div",z({},d,{ref:this.handleRecaptchaRef}))},t})(h.Component);H.displayName="ReCAPTCHA";H.propTypes={sitekey:T.string.isRequired,onChange:T.func,grecaptcha:T.object,theme:T.oneOf(["dark","light"]),type:T.oneOf(["image","audio"]),tabindex:T.number,onExpired:T.func,onErrored:T.func,size:T.oneOf(["compact","normal","invisible"]),stoken:T.string,hl:T.string,badge:T.oneOf(["bottomright","bottomleft","inline"]),isolated:T.bool};H.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var W={exports:{}},b={};var le;function Ae(){if(le)return b;le=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,i=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,d=e?Symbol.for("react.profiler"):60114,g=e?Symbol.for("react.provider"):60109,m=e?Symbol.for("react.context"):60110,v=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,o=e?Symbol.for("react.forward_ref"):60112,a=e?Symbol.for("react.suspense"):60113,c=e?Symbol.for("react.suspense_list"):60120,f=e?Symbol.for("react.memo"):60115,y=e?Symbol.for("react.lazy"):60116,R=e?Symbol.for("react.block"):60121,x=e?Symbol.for("react.fundamental"):60117,S=e?Symbol.for("react.responder"):60118,j=e?Symbol.for("react.scope"):60119;function u(l){if(typeof l=="object"&&l!==null){var P=l.$$typeof;switch(P){case t:switch(l=l.type,l){case v:case p:case r:case d:case n:case a:return l;default:switch(l=l&&l.$$typeof,l){case m:case o:case y:case f:case g:return l;default:return P}}case i:return P}}}function _(l){return u(l)===p}return b.AsyncMode=v,b.ConcurrentMode=p,b.ContextConsumer=m,b.ContextProvider=g,b.Element=t,b.ForwardRef=o,b.Fragment=r,b.Lazy=y,b.Memo=f,b.Portal=i,b.Profiler=d,b.StrictMode=n,b.Suspense=a,b.isAsyncMode=function(l){return _(l)||u(l)===v},b.isConcurrentMode=_,b.isContextConsumer=function(l){return u(l)===m},b.isContextProvider=function(l){return u(l)===g},b.isElement=function(l){return typeof l=="object"&&l!==null&&l.$$typeof===t},b.isForwardRef=function(l){return u(l)===o},b.isFragment=function(l){return u(l)===r},b.isLazy=function(l){return u(l)===y},b.isMemo=function(l){return u(l)===f},b.isPortal=function(l){return u(l)===i},b.isProfiler=function(l){return u(l)===d},b.isStrictMode=function(l){return u(l)===n},b.isSuspense=function(l){return u(l)===a},b.isValidElementType=function(l){return typeof l=="string"||typeof l=="function"||l===r||l===p||l===d||l===n||l===a||l===c||typeof l=="object"&&l!==null&&(l.$$typeof===y||l.$$typeof===f||l.$$typeof===g||l.$$typeof===m||l.$$typeof===o||l.$$typeof===x||l.$$typeof===S||l.$$typeof===j||l.$$typeof===R)},b.typeOf=u,b}var de;function $e(){return de||(de=1,W.exports=Ae()),W.exports}var Y,pe;function Ie(){if(pe)return Y;pe=1;var e=$e(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},d={};d[e.ForwardRef]=r,d[e.Memo]=n;function g(y){return e.isMemo(y)?n:d[y.$$typeof]||t}var m=Object.defineProperty,v=Object.getOwnPropertyNames,p=Object.getOwnPropertySymbols,o=Object.getOwnPropertyDescriptor,a=Object.getPrototypeOf,c=Object.prototype;function f(y,R,x){if(typeof R!="string"){if(c){var S=a(R);S&&S!==c&&f(y,S,x)}var j=v(R);p&&(j=j.concat(p(R)));for(var u=g(y),_=g(R),l=0;l<j.length;++l){var P=j[l];if(!i[P]&&!(x&&x[P])&&!(_&&_[P])&&!(u&&u[P])){var w=o(R,P);try{m(y,P,w)}catch{}}}}return y}return Y=f,Y}var Fe=Ie();const qe=ue(Fe);function Q(){return Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Q.apply(this,arguments)}function De(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,d;for(d=0;d<r.length;d++)n=r[d],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function Ve(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var E={},He=0;function Me(e,t){return t=t||{},function(r){var n=r.displayName||r.name||"Component",d=(function(m){Ve(v,m);function v(o,a){var c;return c=m.call(this,o,a)||this,c.state={},c.__scriptURL="",c}var p=v.prototype;return p.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+He++),this.__scriptLoaderID},p.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},p.asyncScriptLoaderHandleLoad=function(a){var c=this;this.setState(a,function(){return c.props.asyncScriptOnLoad&&c.props.asyncScriptOnLoad(c.state)})},p.asyncScriptLoaderTriggerOnScriptLoaded=function(){var a=E[this.__scriptURL];if(!a||!a.loaded)throw new Error("Script is not loaded.");for(var c in a.observers)a.observers[c](a);delete window[t.callbackName]},p.componentDidMount=function(){var a=this,c=this.setupScriptURL(),f=this.asyncScriptLoaderGetScriptLoaderID(),y=t,R=y.globalName,x=y.callbackName,S=y.scriptId;if(R&&typeof window[R]<"u"&&(E[c]={loaded:!0,observers:{}}),E[c]){var j=E[c];if(j&&(j.loaded||j.errored)){this.asyncScriptLoaderHandleLoad(j);return}j.observers[f]=function(w){return a.asyncScriptLoaderHandleLoad(w)};return}var u={};u[f]=function(w){return a.asyncScriptLoaderHandleLoad(w)},E[c]={loaded:!1,observers:u};var _=document.createElement("script");_.src=c,_.async=!0;for(var l in t.attributes)_.setAttribute(l,t.attributes[l]);S&&(_.id=S);var P=function(C){if(E[c]){var M=E[c],L=M.observers;for(var q in L)C(L[q])&&delete L[q]}};x&&typeof window<"u"&&(window[x]=function(){return a.asyncScriptLoaderTriggerOnScriptLoaded()}),_.onload=function(){var w=E[c];w&&(w.loaded=!0,P(function(C){return x?!1:(C(w),!0)}))},_.onerror=function(){var w=E[c];w&&(w.errored=!0,P(function(C){return C(w),!0}))},document.body.appendChild(_)},p.componentWillUnmount=function(){var a=this.__scriptURL;if(t.removeOnUnmount===!0)for(var c=document.getElementsByTagName("script"),f=0;f<c.length;f+=1)c[f].src.indexOf(a)>-1&&c[f].parentNode&&c[f].parentNode.removeChild(c[f]);var y=E[a];y&&(delete y.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete E[a])},p.render=function(){var a=t.globalName,c=this.props;c.asyncScriptOnLoad;var f=c.forwardedRef,y=De(c,["asyncScriptOnLoad","forwardedRef"]);return a&&typeof window<"u"&&(y[a]=typeof window[a]<"u"?window[a]:void 0),y.ref=f,h.createElement(r,y)},v})(h.Component),g=h.forwardRef(function(m,v){return h.createElement(d,Q({},m,{forwardedRef:v}))});return g.displayName="AsyncScriptLoader("+n+")",g.propTypes={asyncScriptOnLoad:T.func},qe(g,r)}}var X="onloadcallback",Ue="grecaptcha";function Z(){return typeof window<"u"&&window.recaptchaOptions||{}}function Ge(){var e=Z(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+X+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+X+"&render=explicit"}const Be=Me(Ge,{callbackName:X,globalName:Ue,attributes:Z().nonce?{nonce:Z().nonce}:{}})(H),V={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},We=({currentStep:e,form:t,isClient:i,onChange:r,onGuestsChange:n,captchaToken:d,error:g,recaptchaRef:m,setCaptchaToken:v,recaptchaSiteKey:p})=>{const{t:o}=I(["home","common","rsvp"]),a=c=>c.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)?null:o("rsvp:errors.invalidEmail"):o("rsvp:errors.required");return s.jsxs(ee,{mode:"wait",children:[e===0&&s.jsxs(O.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"email",children:[o("rsvp:email")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsx("input",{id:"email",name:"email",type:"email",value:t.email,spellCheck:!1,onKeyDown:c=>c.key===" "&&c.preventDefault(),onPaste:c=>/\s/.test(c.clipboardData.getData("text"))&&c.preventDefault(),onChange:r,className:`form-input ${t.email.trim()?a(t.email)?"form-input-invalid":"form-input-valid":""}`,required:!0,autoComplete:"email"}),t.email&&a(t.email)&&s.jsx("div",{className:"field-error",children:a(t.email)})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"attending",children:[o("rsvp:attending")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsxs("select",{id:"attending",name:"attending",value:t.attending,onChange:r,className:`form-input ${t.attending?"form-input-valid":""}`,required:!0,autoComplete:"off",children:[s.jsx("option",{value:"",children:o("rsvp:select")}),s.jsx("option",{value:"yes",children:o("rsvp:yes")}),s.jsx("option",{value:"no",children:o("rsvp:no")})]})]})]},"step0"),e===1&&s.jsx(O.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:t.attending==="yes"?s.jsx(Ne,{guests:t.guests,onGuestsChange:n,required:!0}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"nonAttendingName",children:[o("rsvp:yourName")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsx("input",{id:"nonAttendingName",name:"nonAttendingName",type:"text",value:t.nonAttendingName,onChange:r,className:"form-input",required:!0,autoComplete:"name",spellCheck:!1})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"notes",children:[o("rsvp:messageToBrideGroom")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:r,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5,required:!0})]})]})},"guestsOrName"),e===2&&i&&s.jsxs(O.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[t.attending==="yes"&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"notes",children:o("rsvp:messageToBrideGroom")}),s.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:r,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5})]}),s.jsx(Be,{sitekey:p,onChange:c=>v(c),ref:m,style:{display:"inline-block",width:"100%",marginTop:"1rem"}}),!d&&g&&s.jsx("div",{className:"field-error",children:"Please complete reCAPTCHA"})]},"step3"),e===3&&s.jsx(O.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:s.jsxs("div",{className:"review",children:[s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:email"),":"]})," ",t.email]}),s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:attending"),":"]})," ",o(`rsvp:${t.attending}`)]}),t.attending==="yes"&&t.guests.length>0&&s.jsxs("div",{children:[s.jsxs("strong",{children:[o("rsvp:guestsTitle"),":"]}),s.jsx("ul",{children:t.guests.map((c,f)=>s.jsxs("li",{children:[c.firstName," ",c.lastName,c.dietary&&` - ${o("rsvp:dietary")}: ${c.dietary}`,c.note&&` - ${o("rsvp:guestNote")}: ${c.note}`]},f))})]}),t.attending==="no"&&s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:name"),":"]})," ",t.nonAttendingName]}),t.notes&&s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:messageToBrideGroom"),":"]})," ",t.notes]})]})},"step4")]})},Ye=({submittedRef:e})=>{const{t}=I(["home","common","rsvp"]),[i,r]=h.useState(!1);return h.useEffect(()=>{const n=setTimeout(()=>r(!0),50),d=setInterval(()=>{r(!1),setTimeout(()=>r(!0),55)},1e4);return()=>{clearTimeout(n),clearInterval(d)}},[]),s.jsxs(O.div,{className:"rsvp-page container",ref:e,initial:{opacity:0,scale:.9,y:30},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25,duration:.6}},children:[s.jsx(O.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:20,delay:1},className:"heart-animated",style:{fontSize:"4rem",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:s.jsxs("svg",{viewBox:"0 0 24 24",children:[s.jsx("defs",{children:s.jsx("path",{id:"heart",d:"M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"})}),s.jsx(O.use,{xlinkHref:"#heart",initial:{opacity:0,scale:.33},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:15},style:{transformOrigin:"center"}},i?"on":"off")]})}),s.jsx(O.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},style:{textAlign:"center",marginBottom:"1rem"},children:t("rsvp:thankYou")}),s.jsx(O.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},style:{textAlign:"center",maxWidth:"500px",margin:"0 auto 2rem",lineHeight:1.6},children:t("rsvp:confirmation")})]})};function Ke(e){const t=te(),[i,r]=h.useState(e),[n,d]=h.useState(0),[g,m]=h.useState(null),[v,p]=h.useState(!1),o=["contactAndAttendance","guestsOrName","captcha","review"];return{form:i,setForm:r,currentStep:n,steps:o,error:g,setError:m,hasValidGuests:v,handleChange:x=>{const{name:S,value:j}=x.target;r(u=>({...u,[S]:j})),m(null)},handleGuestsChange:x=>{r(S=>({...S,guests:x})),p(x.some(S=>S.firstName.trim()&&S.lastName.trim()))},nextStep:()=>{t.event("rsvp_step_complete",{event_label:o[n],step_number:n+1,step_name:o[n]}),d(x=>x+1)},prevStep:()=>{t.event("rsvp_step_back",{event_label:o[n],step_number:n+1,step_name:o[n]}),d(x=>x-1)},goToStep:x=>d(x)}}class F{constructor(t=0,i="Network Error"){this.status=t,this.text=i}}const ze=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},N={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:ze()},re=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},Je=(e,t="https://api.emailjs.com")=>{if(!e)return;const i=re(e);N.publicKey=i.publicKey,N.blockHeadless=i.blockHeadless,N.storageProvider=i.storageProvider,N.blockList=i.blockList,N.limitRate=i.limitRate,N.origin=i.origin||t},me=async(e,t,i={})=>{const r=await fetch(N.origin+e,{method:"POST",headers:i,body:t}),n=await r.text(),d=new F(r.status,n);if(r.ok)return d;throw d},fe=(e,t,i)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!i||typeof i!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Qe=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},he=e=>e.webdriver||!e.languages||e.languages.length===0,ve=()=>new F(451,"Unavailable For Headless Browser"),Xe=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},Ze=e=>!e.list?.length||!e.watchVariable,et=(e,t)=>e instanceof FormData?e.get(t):e[t],ye=(e,t)=>{if(Ze(e))return!1;Xe(e.list,e.watchVariable);const i=et(t,e.watchVariable);return typeof i!="string"?!1:e.list.includes(i)},ge=()=>new F(403,"Forbidden"),tt=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},rt=async(e,t,i)=>{const r=Number(await i.get(e)||0);return t-Date.now()+r},be=async(e,t,i)=>{if(!t.throttle||!i)return!1;tt(t.throttle,t.id);const r=t.id||e;return await rt(r,t.throttle,i)>0?!0:(await i.set(r,Date.now().toString()),!1)},xe=()=>new F(429,"Too Many Requests"),nt=async(e,t,i,r)=>{const n=re(r),d=n.publicKey||N.publicKey,g=n.blockHeadless||N.blockHeadless,m=n.storageProvider||N.storageProvider,v={...N.blockList,...n.blockList},p={...N.limitRate,...n.limitRate};return g&&he(navigator)?Promise.reject(ve()):(fe(d,e,t),Qe(i),i&&ye(v,i)?Promise.reject(ge()):await be(location.pathname,p,m)?Promise.reject(xe()):me("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:d,service_id:e,template_id:t,template_params:i}),{"Content-type":"application/json"}))},st=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},it=e=>typeof e=="string"?document.querySelector(e):e,at=async(e,t,i,r)=>{const n=re(r),d=n.publicKey||N.publicKey,g=n.blockHeadless||N.blockHeadless,m=N.storageProvider||n.storageProvider,v={...N.blockList,...n.blockList},p={...N.limitRate,...n.limitRate};if(g&&he(navigator))return Promise.reject(ve());const o=it(i);fe(d,e,t),st(o);const a=new FormData(o);return ye(v,a)?Promise.reject(ge()):await be(location.pathname,p,m)?Promise.reject(xe()):(a.append("lib_version","4.4.1"),a.append("service_id",e),a.append("template_id",t),a.append("user_id",d),me("/api/v1.0/email/send-form",a))},_e={init:Je,send:nt,sendForm:at,EmailJSResponseStatus:F},ot=void 0;_e.init(ot);function ct(e,t,i=0){const r=te(),[n,d]=h.useState(!1),[g,m]=h.useState(!1),[v,p]=h.useState(null),o=async()=>{if(console.log("Submitting RSVP...",{form:e,captchaToken:t}),!t){const a="Please complete reCAPTCHA.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!1});return}if(!e.email){const a="Email is required.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}if(!e.attending){const a="Please indicate if you're attending.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,has_captcha_token:!!t});return}if(e.attending==="yes"&&e.guests.length===0){const a="Please add at least one guest.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}if(e.attending==="no"&&!e.nonAttendingName){const a="Please provide your name.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}d(!0),p(null);try{const a=e.attending==="yes"?e.guests.map((y,R)=>`${R+1}. ${y.firstName} ${y.lastName}`+(y.dietary?` - Dietary: ${y.dietary}`:"")+(y.note?` - Note: ${y.note}`:"")).join(`
`):`Not attending: ${e.nonAttendingName}`,c={email:e.email,attending:e.attending,guestsCount:e.attending==="yes"?e.guests.length:1,guests:a,notes:e.notes||"None",recaptchaToken:t};console.log("Sending email with params:",c);const f=await _e.send("service_vvuhisc","template_4m25aki",c);console.log("EmailJS response:",f),r.event("rsvp_submit_success",{event_label:`RSVP ${e.attending==="yes"?"Accepted":"Declined"}`,attending:e.attending,guest_count:e.attending==="yes"?e.guests.length:1,dietary_requirements:e.guests[0]?.dietary||"none",locale:document.documentElement.lang}),r.event("conversion",{event_label:"RSVP Completed",send_to:"AW-CONVERSION-ID"}),r.event("rsvp_confirmation_view",{event_label:"Viewed confirmation page"}),r.event("page_view",{page_title:"RSVP Confirmation",page_location:window.location.href,page_path:"/rsvp/confirmation"}),m(!0)}catch(a){console.error("Submission error:",a);const c=a?.text||a?.message||"Failed to submit RSVP. Please try again.",f=a?.text?"emailjs_error":"network_error";p(c),r.event("rsvp_submit_error",{event_label:f,error_message:c,error_type:f,current_step:i,attending_status:e.attending,has_captcha_token:!!t}),r.event("exception",{description:`RSVP Error: ${f} - ${c}`,fatal:!1})}finally{d(!1)}};return h.useEffect(()=>{v&&console.error("RSVP Error:",v)},[v]),{submit:o,sending:n,submitted:g,error:v,setError:p,setSubmitted:m}}const lt=void 0;let K=!1,$=!1;const gt=Re(function(){const{t,ready:i}=I(["home","common","rsvp"]),r=te();we();const[n,d]=h.useState(!1),[g,m]=h.useState(null),v=h.useRef(null),{form:p,currentStep:o,steps:a,error:c,handleChange:f,handleGuestsChange:y,nextStep:R,prevStep:x,hasValidGuests:S}=Ke({email:"",attending:"",guests:[],nonAttendingName:"",notes:"",website:""}),{submit:j,sending:u,submitted:_,error:l,setSubmitted:P}=ct(p,g,o),w=h.useRef(null),C=h.useRef(null),M=h.useRef(null),L=c||l;if(h.useEffect(()=>{K||(r.event("rsvp_start",{event_label:"User started RSVP form"}),K=!0),$=!1;const A=()=>{!_&&!$&&(r.event("rsvp_abandonment",{event_label:`Abandoned at ${a[o]}`,step_number:o+1,step_name:a[o]}),$=!0)};return window.addEventListener("beforeunload",A),()=>{window.removeEventListener("beforeunload",A),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{!window.location.pathname.includes("/rsvp")&&(!_&&!$&&(r.event("rsvp_abandonment",{event_label:`Abandoned at ${a[o]}`,step_number:o+1,step_name:a[o]}),$=!0),K=!1),v.current=null},100)}},[o,a,_,r]),h.useEffect(()=>d(!0),[]),h.useEffect(()=>{L&&w.current&&(w.current.scrollIntoView({behavior:"smooth",block:"center"}),w.current.focus()),_&&C.current&&C.current.focus()},[L,_]),!i)return s.jsx("div",{className:"loading",children:t("common:loading")});if(_)return s.jsx(Ye,{onReset:()=>P(!1),submittedRef:C});const q=(o+1)/a.length*100,ne=()=>o===0?!p.attending||!p.email:o===1?p.attending==="yes"?!S:!p.nonAttendingName:o===2?!g:!1,je=t("rsvp:steps",{returnObjects:!0}),Se=a.map(A=>je[A])[o];return s.jsxs("div",{className:"rsvp-page container",children:[s.jsx("h1",{children:"Rsvp"}),s.jsx("p",{className:"step-description",children:Se}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${q}%`}})}),s.jsxs("form",{className:"rsvp-form",onSubmit:A=>A.preventDefault(),children:[s.jsx(We,{currentStep:o,form:p,isClient:n,onChange:f,onGuestsChange:y,captchaToken:g,setCaptchaToken:m,recaptchaRef:M,recaptchaSiteKey:lt,error:L}),L&&s.jsx("div",{className:"rsvp-error",ref:w,role:"alert",tabIndex:-1,children:L}),s.jsxs("div",{className:"form-navigation",children:[s.jsx("button",{type:"button",onClick:x,disabled:o===0,title:t("common:back")||"Back",children:s.jsx(k.Back,{})}),s.jsxs("span",{children:[o+1,"/",a.length]}),o<a.length-1?s.jsx("button",{type:"button",onClick:R,disabled:ne(),title:t("common:next")||"Next",children:s.jsx(k.Next,{})}):s.jsx("button",{type:"button",onClick:j,disabled:u||ne(),children:t(u?"rsvp:sending":"rsvp:submit")})]})]})]})});export{gt as default};
