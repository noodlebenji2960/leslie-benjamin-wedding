import{a as o,w as X}from"./chunk-EPOLDU6W-C9vtjoJn.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{I as j}from"./Icon-fSrDZDb7.js";import{u as P}from"./useWeddingData-DmPkR6aw.js";import{m as N,A as O,T as Z}from"./Modal-Sal8OyIs.js";import{M as V}from"./Map-DFeI_dnp.js";import{D as ee}from"./DonateButton-Cmwhl_YA.js";import{u as te}from"./ConfigContext-DNqFIZ_3.js";import{u as ae}from"./useTranslation-DvHpW7Xw.js";import"./i18next-BDvusv7y.js";import"./lenis-react-DQp2-cqK.js";const z=(v,c)=>v>60?j.Rain:v>30?j.Cloud:c<=0?j.Snow:j.Sun,ne=({test:v})=>{console.log("WeatherForecast rendered with test =",v);const c=P(),{lat:D,lng:a}=c.wedding.ceremony.venue.coordinates,d=o.useMemo(()=>new Date(c.wedding.date),[c.wedding.date]),[p,k]=o.useState([]),[m,i]=o.useState(null),[l,$]=o.useState(null),[C,S]=o.useState(!0),[L,s]=o.useState(!1),u=t=>t.toISOString().split("T")[0],h=t=>t.toLocaleDateString(void 0,{month:"short",day:"numeric"}),r=o.useMemo(()=>{if(!p.length)return"";const t=new Date(p[0].rawDate),g=new Date(p[p.length-1].rawDate),f=`${t.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}, ${t.getFullYear()}`,n=`${g.toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})}, ${g.getFullYear()}`;return`${f} â€“ ${n}`},[p]),y=o.useMemo(()=>{if(!m)return"";const[t,g]=m.measuredRange.split(" â€“ ");return`${t}, ${d.getFullYear()-1} â€“ ${g}, ${d.getFullYear()-1}`},[m,d]),T=o.useMemo(()=>l?`${l.date}, ${l.year}`:"",[l]);return o.useEffect(()=>{let t=!1;return(async()=>{try{const f=`https://api.open-meteo.com/v1/forecast?latitude=${D}&longitude=${a}&daily=temperature_2m_max,precipitation_probability_max&timezone=auto`,n=d.getFullYear()-1,w=d.getMonth(),_=new Date(n,w,1),q=new Date(n,w+1,0),H=`https://archive-api.open-meteo.com/v1/archive?latitude=${D}&longitude=${a}&start_date=${u(_)}&end_date=${u(q)}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum&timezone=auto`,[W,R]=await Promise.all([fetch(f),fetch(H)]);if(!W.ok||!R.ok)throw new Error("Weather fetch failed");const F=await W.json(),b=await R.json();if(t)return;const J=F.daily.time.slice(0,7).map((x,M)=>({rawDate:x,date:new Date(x).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"}),temp:Math.round(F.daily.temperature_2m_max[M]),precipitation:Math.round(F.daily.precipitation_probability_max?.[M]??0)}));k(J);const Y=b.daily.temperature_2m_max,K=b.daily.temperature_2m_min,A=b.daily.precipitation_sum,U=A.length,B=A.filter(x=>x>1).length,Q=U-B;i({avgTemp:Math.round((x=>x.reduce((M,G)=>M+G,0)/x.length)(Y)),maxTemp:Math.round(Math.max(...Y)),minTemp:Math.round(Math.min(...K)),rainyDays:B,sunnyDays:Q,totalDays:U,measuredRange:`${h(_)} â€“ ${h(q)}`});const E=u(new Date(n,w,d.getDate())),I=b.daily.time.findIndex(x=>x===E);I>=0&&$({temp:Math.round(b.daily.temperature_2m_max[I]),precipitation:Math.round(b.daily.precipitation_sum[I]),date:h(new Date(E)),year:n})}catch{t||s(!0)}finally{t||S(!1)}})(),()=>{t=!0}},[D,a,d]),C?e.jsxs("div",{className:"weather-forecast loading",children:[e.jsx(j.More,{className:"loading-spinner"}),e.jsx("p",{children:"Loading weatherâ€¦"})]}):L?e.jsxs("div",{className:"weather-forecast error",children:[e.jsx(j.Cloud,{}),e.jsx("p",{children:e.jsx("strong",{children:"Weather unavailable"})}),e.jsx("small",{children:"Typical summer weather: warm & sunny â˜€ï¸"})]}):e.jsxs(N.div,{className:"weather-forecast compact",initial:{opacity:0},animate:{opacity:1},children:[p.length>0&&e.jsx("strong",{children:r}),e.jsx("div",{className:"weather-forecast__forecast",children:p.slice(0,5).map((t,g)=>{const f=z(t.precipitation,t.temp),n=new Date,w=new Date(t.rawDate),_=n.getFullYear()===w.getFullYear()&&n.getMonth()===w.getMonth()&&n.getDate()===w.getDate();return e.jsxs("div",{className:`weather-day${_?" today":""}`,children:[e.jsxs("div",{className:"date",children:[e.jsx("div",{className:"icon",children:e.jsx(f,{size:18})}),t.date," ",_&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"(today)"]})]}),e.jsxs("div",{children:[t.precipitation>30&&e.jsxs("div",{className:"rain",children:[t.precipitation,"% prec."]}),e.jsxs("div",{className:"temp",children:[t.temp,"Â°"]})]})]},g)})}),l&&e.jsxs("div",{className:"weather-forecast__wedding-day",children:[e.jsxs("strong",{children:[T,":"]}),e.jsx("div",{className:"icon",children:z(l.precipitation,l.temp)({size:18})}),e.jsxs("span",{children:[l.temp,"Â°"]}),l.precipitation>0&&e.jsxs("span",{children:[" â€¢ ðŸ’§ ",l.precipitation,"mm"]})]}),m&&e.jsxs("div",{className:"weather-forecast__typical",children:[e.jsx("small",{children:y}),e.jsxs("span",{children:["ðŸŒ§ ",m.rainyDays," rainy days â€¢ â˜€ï¸ ",m.sunnyDays," sunny days"]}),e.jsxs("span",{children:["ðŸŒ¡ ",m.avgTemp,"Â°C avg / ",m.maxTemp,"Â° / ",m.minTemp,"Â°"]})]})]})},se=()=>{const v=te(),{t:c,ready:D}=ae("qa"),a=P(),[d,p]=o.useState("essentials"),[k,m]=o.useState(null);if(!D)return e.jsx("div",{className:"loading",children:c("loading","Loading...")});const i=o.useMemo(()=>{const s=a.schedule.find(n=>n.id==="bus"),u=a.contact.find(n=>n.name.includes(a.bride.firstName)),h=a.contact.find(n=>n.name.includes(a.groom.firstName)),r=a.schedule.find(n=>n.id==="bus"),y=r?.maps[1]?.coordinates||null,T=r?.maps[1]?.extraCoordinates||[],t=r?.maps[1]?.mapUrl||"",g=r?.maps[1]?.showRoute||!1,f=r?.maps[1]?.label||"Bus Route";return{bus:{mainCoords:y,extraCoords:T.map(n=>({lat:n.lat,lng:n.lng,label:n.label||"",showMarker:!0})),mapUrl:t,showRoute:g,label:f},venueCoordinates:a.wedding.ceremony.venue.coordinates,rsvpDeadline:a.rsvp.deadline,ceremonyTime:a.wedding.ceremony.time,ceremonyVenue:a.wedding.ceremony.venue.longName,venueMapLink:a.wedding.ceremony.venue.mapLink,venueWebsite:a.wedding.ceremony.venue.website,busTime:s?.time||"13:00",weddingDate:new Date(a.wedding.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}),brideFirstName:a.bride.firstName,bridePhone:u?.phone||"",groomFirstName:a.groom.firstName,groomPhone:h?.phone||"",airports:a.travel?.nearestAirport||[],hotels:a.travel?.hotels||[]}},[a]),l=o.useMemo(()=>c("items",{returnObjects:!0,...i})||[],[c,i]),$=o.useMemo(()=>l.filter(s=>d==="all"?!0:s.category===d),[l,d]),C=o.useCallback(s=>{m(u=>u===s?null:s)},[]),S=o.useCallback(s=>{p(s),m(null)},[]),L=["essentials","logistics","style","family","gifts","travel","all"];return e.jsxs("div",{className:"qa-page container",children:[e.jsx(N.h1,{className:"qa-title",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},children:c("title")}),e.jsx("div",{className:"qa-categories",children:L.map(s=>e.jsx(N.button,{className:`category-tab ${d===s?"active":""}`,onClick:()=>S(s),whileHover:{},whileTap:{},children:c(s)},s))}),e.jsx("div",{className:"qa-list",children:e.jsx(O,{mode:"popLayout",children:$.map(s=>{const u=l.findIndex(r=>r.question===s.question),h=k===u;return e.jsxs(N.div,{className:"qa-item",layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsxs("button",{className:`qa-question ${h?"open":""}`,onClick:()=>C(u),children:[e.jsx("span",{children:s.question}),e.jsx(j.Down,{className:`chevron ${h?"rotate-180":""}`})]}),e.jsx(O,{children:h&&e.jsx(N.div,{className:"qa-answer",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},children:e.jsx("div",{className:"answer-content",children:e.jsx(Z,{i18nKey:`items.${u}.answer`,t:c,values:i,components:{VenueLink:e.jsx("a",{href:i.venueWebsite,target:"_blank",rel:"noopener noreferrer",style:{fontWeight:"bold",textDecoration:"none",color:"inherit"},children:i.ceremonyVenue}),MapVenue:e.jsx(V,{coordinates:i.venueCoordinates,label:i.ceremonyVenue,mapUrl:i.venueMapLink,interactive:!1,zoom:12}),MapBus:e.jsx(V,{label:i.bus.label,coordinates:i.bus.mainCoords,extraCoordinates:i.bus.extraCoords,mapUrl:i.bus.mapUrl,showRoute:i.bus.showRoute,interactive:!1,width:"100%",height:"400px"}),DonateButton:e.jsx(ee,{}),WeatherForecast:v.weather.enabled?e.jsx(ne,{}):e.jsx(e.Fragment,{}),SkyscannerLink:e.jsx("a",{href:"https://www.skyscanner.com/",target:"_blank",rel:"noopener noreferrer",children:c("links.skyscanner","Skyscanner")}),AirBnbLink:e.jsx("a",{href:"https://www.airbnb.com/",target:"_blank",rel:"noopener noreferrer",children:c("links.airbnb","AirBnB")}),AirportsList:e.jsx("ul",{children:i.airports.map((r,y)=>e.jsxs("li",{children:[e.jsxs("strong",{children:[r.name," (",r.code,")"]})," ","â€“ ",c("distance",{distance:r.distance}),","," ",c("transport",{transport:r.transportOptions.join(", ")})]},y))}),HotelLinks:e.jsx("ul",{children:i.hotels.map((r,y)=>e.jsx("li",{children:e.jsxs("a",{href:r.website,target:"_blank",rel:"noopener noreferrer",children:[r.name," â€“ ",r.address]})},y))}),strong:e.jsx("strong",{}),p:e.jsx("p",{}),br:e.jsx("br",{})}})})})})]},s.question)})})})]})},ye=X(se);export{ye as default};
