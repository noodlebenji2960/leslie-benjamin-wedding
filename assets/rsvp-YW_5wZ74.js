import{a as v,y as ue,w as we,p as Re}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as n}from"./jsx-runtime-u17CrQMm.js";import{I as k}from"./Icon-D5em7eLC.js";import{u as $}from"./useTranslation-B9zSoiKr.js";import{A as M,m as E}from"./proxy-DBX3VoSC.js";import{u as te}from"./AnalyticsContext-CJAiYubj.js";const Ne=({songs:e=[],onUpdate:t})=>{const{t:a}=$(["rsvp"]),[r,s]=v.useState({title:"",artist:""}),d=()=>{!r.title.trim()&&!r.artist.trim()||(t([...e,r]),s({title:"",artist:""}))},g=u=>{const o=e.filter((l,i)=>i!==u);t(o)},m=!r.title.trim()&&!r.artist.trim();return n.jsxs("div",{className:"songs-container",children:[n.jsx(M,{children:e.map((u,o)=>n.jsxs(E.div,{className:"form-row song-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[n.jsxs("div",{className:"song-display",children:[n.jsx("span",{className:"song-title",children:u.title||"Untitled"}),u.artist&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"song-separator",children:" — "}),n.jsx("span",{className:"song-artist",children:u.artist})]})]}),n.jsx("button",{type:"button",className:"close-btn",onClick:()=>g(o),title:a("rsvp:removeSong"),children:n.jsx(k.Close,{})})]},o))}),n.jsxs("div",{className:"form-row song-row draft-row",children:[n.jsx("input",{type:"text",placeholder:a("rsvp:songTitlePlaceholder"),value:r.title,onChange:u=>s(o=>({...o,title:u.target.value}))}),n.jsx("input",{type:"text",placeholder:a("rsvp:songArtistPlaceholder"),value:r.artist,onChange:u=>s(o=>({...o,artist:u.target.value}))}),n.jsx("button",{type:"button",className:"form-btn add-song-btn",onClick:d,disabled:m,title:a("rsvp:addSong"),children:n.jsx(k.Add,{})})]})]})},se=({index:e,guest:t,onUpdate:a,onRemove:r,onConfirm:s,isDraft:d=!1,isRostered:g=!1})=>{const{t:m}=$(["rsvp"]),[u,o]=v.useState(!1),[l,i]=v.useState(!1),[p,y]=v.useState(!1),f=t.firstName.trim()&&t.lastName.trim(),_=(h,S)=>{a?.(e,h,S)};return v.useEffect(()=>{t.dietary&&o(!0),t.note&&i(!0),t.songs&&t.songs.length>0&&y(!0)},[t.dietary,t.note,t.musicRequest,t.songs]),n.jsxs(E.div,{className:`guest-card ${f?"":"invalid"}`,layout:"position",initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{type:"spring",stiffness:400,damping:30,layout:{type:"spring",stiffness:500}},children:[n.jsxs("div",{className:"inputs-container",children:[n.jsxs("div",{className:"form-row",children:[n.jsx("input",{type:"text",placeholder:m("rsvp:firstName"),value:t.firstName,onChange:h=>_("firstName",h.target.value)}),n.jsx("input",{type:"text",placeholder:m("rsvp:lastName"),value:t.lastName,onChange:h=>_("lastName",h.target.value)})]}),n.jsxs(M,{children:[u&&n.jsxs(E.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[n.jsx("input",{type:"text",placeholder:m("rsvp:dietaryPlaceholder"),value:t.dietary,onChange:h=>_("dietary",h.target.value)}),n.jsx("button",{type:"button",className:"close-btn",onClick:()=>o(!1),children:"×"})]}),l&&n.jsxs(E.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[n.jsx("textarea",{placeholder:m("rsvp:notePlaceholder"),value:t.note||"",onChange:h=>_("note",h.target.value)}),n.jsx("button",{type:"button",className:"close-btn",onClick:()=>i(!1),children:"×"})]})]}),p&&n.jsx(Ne,{songs:t.songs,onUpdate:h=>_("songs",h)})]}),n.jsx("div",{className:"guest-card-actions",children:d?n.jsx(E.button,{type:"button",className:"form-btn add-guest-btn",disabled:!f,onClick:()=>{s&&s(),o(!1),i(!1),y(!1)},whileHover:f?{scale:1.02}:{},title:m("rsvp:addGuest"),children:n.jsx(k.Add,{})}):n.jsxs(n.Fragment,{children:[!u&&n.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>o(!0),title:m("rsvp:addDietary"),children:n.jsx(k.Food,{})}),!l&&n.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>i(!0),title:m("rsvp:addNote"),children:n.jsx(k.Note,{})}),n.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>y(h=>!h),title:m("rsvp:addMusicRequest"),children:p?n.jsx(k.Music.on,{}):n.jsx(k.Music.off,{})}),n.jsx("button",{type:"button",className:"remove-guest",onClick:()=>{window.confirm(`Are you sure you want to remove ${t.firstName} ${t.lastName} from the guest roster?`)&&r?.(e)},children:n.jsx(k.Close,{})})]})})]})},ie={firstName:"",lastName:"",dietary:"",note:""},Pe=({guests:e,onGuestsChange:t})=>{const{t:a}=$(["rsvp"]),[r,s]=v.useState(ie),d=v.useCallback(()=>{!r.firstName.trim()||!r.lastName.trim()||(t([...e,r]),s(ie))},[r,e,t]),g=v.useCallback(o=>{t(e.filter((l,i)=>i!==o))},[e,t]),m=v.useCallback((o,l,i)=>{t(e.map((p,y)=>y===o?{...p,[l]:i}:p))},[e,t]),u=v.useCallback((o,l)=>{s(i=>({...i,[o]:l}))},[]);return n.jsxs("div",{className:"guests-section",children:[n.jsxs("h3",{children:[a("rsvp:guestsTitle"),e.length>0&&` (${e.length})`]}),n.jsxs(M,{children:[e.map((o,l)=>n.jsx(se,{index:l,guest:o,onUpdate:m,onRemove:g,isRostered:!0},`roster-${l}`)),n.jsx(se,{index:e.length,guest:r,onUpdate:(o,l,i)=>u(l,i),onConfirm:d,isDraft:!0},"draft")]})]})};var B={exports:{}},G,ae;function Te(){if(ae)return G;ae=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return G=e,G}var W,oe;function Ee(){if(oe)return W;oe=1;var e=Te();function t(){}function a(){}return a.resetWarningCache=t,W=function(){function r(g,m,u,o,l,i){if(i!==e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}r.isRequired=r;function s(){return r}var d={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:a,resetWarningCache:t};return d.PropTypes=d,d},W}var ce;function Ce(){return ce||(ce=1,B.exports=Ee()()),B.exports}var Oe=Ce();const T=ue(Oe);var ke=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},J.apply(this,arguments)}function Le(e,t){if(e==null)return{};var a={},r=Object.keys(e),s,d;for(d=0;d<r.length;d++)s=r[d],!(t.indexOf(s)>=0)&&(a[s]=e[s]);return a}function q(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Q(e,t)}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Q(e,t)}var H=(function(e){Ae(t,e);function t(){var r;return r=e.call(this)||this,r.handleExpired=r.handleExpired.bind(q(r)),r.handleErrored=r.handleErrored.bind(q(r)),r.handleChange=r.handleChange.bind(q(r)),r.handleRecaptchaRef=r.handleRecaptchaRef.bind(q(r)),r}var a=t.prototype;return a.getCaptchaFunction=function(s){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[s]:this.props.grecaptcha[s]:null},a.getValue=function(){var s=this.getCaptchaFunction("getResponse");return s&&this._widgetId!==void 0?s(this._widgetId):null},a.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},a.execute=function(){var s=this.getCaptchaFunction("execute");if(s&&this._widgetId!==void 0)return s(this._widgetId);this._executeRequested=!0},a.executeAsync=function(){var s=this;return new Promise(function(d,g){s.executionResolve=d,s.executionReject=g,s.execute()})},a.reset=function(){var s=this.getCaptchaFunction("reset");s&&this._widgetId!==void 0&&s(this._widgetId)},a.forceReset=function(){var s=this.getCaptchaFunction("reset");s&&s()},a.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},a.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},a.handleChange=function(s){this.props.onChange&&this.props.onChange(s),this.executionResolve&&(this.executionResolve(s),delete this.executionReject,delete this.executionResolve)},a.explicitRender=function(){var s=this.getCaptchaFunction("render");if(s&&this._widgetId===void 0){var d=document.createElement("div");this._widgetId=s(d,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(d)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},a.componentDidMount=function(){this.explicitRender()},a.componentDidUpdate=function(){this.explicitRender()},a.handleRecaptchaRef=function(s){this.captcha=s},a.render=function(){var s=this.props;s.sitekey,s.onChange,s.theme,s.type,s.tabindex,s.onExpired,s.onErrored,s.size,s.stoken,s.grecaptcha,s.badge,s.hl,s.isolated;var d=Le(s,ke);return v.createElement("div",J({},d,{ref:this.handleRecaptchaRef}))},t})(v.Component);H.displayName="ReCAPTCHA";H.propTypes={sitekey:T.string.isRequired,onChange:T.func,grecaptcha:T.object,theme:T.oneOf(["dark","light"]),type:T.oneOf(["image","audio"]),tabindex:T.number,onExpired:T.func,onErrored:T.func,size:T.oneOf(["compact","normal","invisible"]),stoken:T.string,hl:T.string,badge:T.oneOf(["bottomright","bottomleft","inline"]),isolated:T.bool};H.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var Y={exports:{}},b={};var le;function $e(){if(le)return b;le=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,d=e?Symbol.for("react.profiler"):60114,g=e?Symbol.for("react.provider"):60109,m=e?Symbol.for("react.context"):60110,u=e?Symbol.for("react.async_mode"):60111,o=e?Symbol.for("react.concurrent_mode"):60111,l=e?Symbol.for("react.forward_ref"):60112,i=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,y=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,_=e?Symbol.for("react.block"):60121,h=e?Symbol.for("react.fundamental"):60117,S=e?Symbol.for("react.responder"):60118,N=e?Symbol.for("react.scope"):60119;function x(c){if(typeof c=="object"&&c!==null){var P=c.$$typeof;switch(P){case t:switch(c=c.type,c){case u:case o:case r:case d:case s:case i:return c;default:switch(c=c&&c.$$typeof,c){case m:case l:case f:case y:case g:return c;default:return P}}case a:return P}}}function j(c){return x(c)===o}return b.AsyncMode=u,b.ConcurrentMode=o,b.ContextConsumer=m,b.ContextProvider=g,b.Element=t,b.ForwardRef=l,b.Fragment=r,b.Lazy=f,b.Memo=y,b.Portal=a,b.Profiler=d,b.StrictMode=s,b.Suspense=i,b.isAsyncMode=function(c){return j(c)||x(c)===u},b.isConcurrentMode=j,b.isContextConsumer=function(c){return x(c)===m},b.isContextProvider=function(c){return x(c)===g},b.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===t},b.isForwardRef=function(c){return x(c)===l},b.isFragment=function(c){return x(c)===r},b.isLazy=function(c){return x(c)===f},b.isMemo=function(c){return x(c)===y},b.isPortal=function(c){return x(c)===a},b.isProfiler=function(c){return x(c)===d},b.isStrictMode=function(c){return x(c)===s},b.isSuspense=function(c){return x(c)===i},b.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===r||c===o||c===d||c===s||c===i||c===p||typeof c=="object"&&c!==null&&(c.$$typeof===f||c.$$typeof===y||c.$$typeof===g||c.$$typeof===m||c.$$typeof===l||c.$$typeof===h||c.$$typeof===S||c.$$typeof===N||c.$$typeof===_)},b.typeOf=x,b}var de;function Ie(){return de||(de=1,Y.exports=$e()),Y.exports}var K,pe;function De(){if(pe)return K;pe=1;var e=Ie(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},d={};d[e.ForwardRef]=r,d[e.Memo]=s;function g(f){return e.isMemo(f)?s:d[f.$$typeof]||t}var m=Object.defineProperty,u=Object.getOwnPropertyNames,o=Object.getOwnPropertySymbols,l=Object.getOwnPropertyDescriptor,i=Object.getPrototypeOf,p=Object.prototype;function y(f,_,h){if(typeof _!="string"){if(p){var S=i(_);S&&S!==p&&y(f,S,h)}var N=u(_);o&&(N=N.concat(o(_)));for(var x=g(f),j=g(_),c=0;c<N.length;++c){var P=N[c];if(!a[P]&&!(h&&h[P])&&!(j&&j[P])&&!(x&&x[P])){var w=l(_,P);try{m(f,P,w)}catch{}}}}return f}return K=y,K}var Fe=De();const qe=ue(Fe);function X(){return X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},X.apply(this,arguments)}function Ve(e,t){if(e==null)return{};var a={},r=Object.keys(e),s,d;for(d=0;d<r.length;d++)s=r[d],!(t.indexOf(s)>=0)&&(a[s]=e[s]);return a}function Me(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var C={},He=0;function Ue(e,t){return t=t||{},function(r){var s=r.displayName||r.name||"Component",d=(function(m){Me(u,m);function u(l,i){var p;return p=m.call(this,l,i)||this,p.state={},p.__scriptURL="",p}var o=u.prototype;return o.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+He++),this.__scriptLoaderID},o.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},o.asyncScriptLoaderHandleLoad=function(i){var p=this;this.setState(i,function(){return p.props.asyncScriptOnLoad&&p.props.asyncScriptOnLoad(p.state)})},o.asyncScriptLoaderTriggerOnScriptLoaded=function(){var i=C[this.__scriptURL];if(!i||!i.loaded)throw new Error("Script is not loaded.");for(var p in i.observers)i.observers[p](i);delete window[t.callbackName]},o.componentDidMount=function(){var i=this,p=this.setupScriptURL(),y=this.asyncScriptLoaderGetScriptLoaderID(),f=t,_=f.globalName,h=f.callbackName,S=f.scriptId;if(_&&typeof window[_]<"u"&&(C[p]={loaded:!0,observers:{}}),C[p]){var N=C[p];if(N&&(N.loaded||N.errored)){this.asyncScriptLoaderHandleLoad(N);return}N.observers[y]=function(w){return i.asyncScriptLoaderHandleLoad(w)};return}var x={};x[y]=function(w){return i.asyncScriptLoaderHandleLoad(w)},C[p]={loaded:!1,observers:x};var j=document.createElement("script");j.src=p,j.async=!0;for(var c in t.attributes)j.setAttribute(c,t.attributes[c]);S&&(j.id=S);var P=function(O){if(C[p]){var U=C[p],L=U.observers;for(var F in L)O(L[F])&&delete L[F]}};h&&typeof window<"u"&&(window[h]=function(){return i.asyncScriptLoaderTriggerOnScriptLoaded()}),j.onload=function(){var w=C[p];w&&(w.loaded=!0,P(function(O){return h?!1:(O(w),!0)}))},j.onerror=function(){var w=C[p];w&&(w.errored=!0,P(function(O){return O(w),!0}))},document.body.appendChild(j)},o.componentWillUnmount=function(){var i=this.__scriptURL;if(t.removeOnUnmount===!0)for(var p=document.getElementsByTagName("script"),y=0;y<p.length;y+=1)p[y].src.indexOf(i)>-1&&p[y].parentNode&&p[y].parentNode.removeChild(p[y]);var f=C[i];f&&(delete f.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete C[i])},o.render=function(){var i=t.globalName,p=this.props;p.asyncScriptOnLoad;var y=p.forwardedRef,f=Ve(p,["asyncScriptOnLoad","forwardedRef"]);return i&&typeof window<"u"&&(f[i]=typeof window[i]<"u"?window[i]:void 0),f.ref=y,v.createElement(r,f)},u})(v.Component),g=v.forwardRef(function(m,u){return v.createElement(d,X({},m,{forwardedRef:u}))});return g.displayName="AsyncScriptLoader("+s+")",g.propTypes={asyncScriptOnLoad:T.func},qe(g,r)}}var Z="onloadcallback",Be="grecaptcha";function ee(){return typeof window<"u"&&window.recaptchaOptions||{}}function Ge(){var e=ee(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+Z+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+Z+"&render=explicit"}const We=Ue(Ge,{callbackName:Z,globalName:Be,attributes:ee().nonce?{nonce:ee().nonce}:{}})(H),Ye="6Lcy_mcsAAAAADoT-ibwy1RvePEHG4xJ87D0fdse",V={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},Ke=({currentStep:e,form:t,isClient:a,onChange:r,onGuestsChange:s,captchaToken:d,error:g,recaptchaRef:m,setCaptchaToken:u})=>{const{t:o}=$(["home","common","rsvp"]),l=i=>i.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)?null:o("rsvp:errors.invalidEmail"):o("rsvp:errors.required");return n.jsxs(M,{mode:"wait",children:[e===0&&n.jsxs(E.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[n.jsxs("div",{className:"form-group",children:[n.jsxs("label",{htmlFor:"email",children:[o("rsvp:email")," ",n.jsx("span",{className:"required",children:"*"})]}),n.jsx("input",{id:"email",name:"email",type:"email",value:t.email,spellCheck:!1,onKeyDown:i=>i.key===" "&&i.preventDefault(),onPaste:i=>/\s/.test(i.clipboardData.getData("text"))&&i.preventDefault(),onChange:r,className:`form-input ${t.email.trim()?l(t.email)?"form-input-invalid":"form-input-valid":""}`,required:!0,autoComplete:"email"}),t.email&&l(t.email)&&n.jsx("div",{className:"field-error",children:l(t.email)})]}),n.jsxs("div",{className:"form-group",children:[n.jsxs("label",{htmlFor:"attending",children:[o("rsvp:attending")," ",n.jsx("span",{className:"required",children:"*"})]}),n.jsxs("select",{id:"attending",name:"attending",value:t.attending,onChange:r,className:`form-input ${t.attending?"form-input-valid":""}`,required:!0,autoComplete:"off",children:[n.jsx("option",{value:"",children:o("rsvp:select")}),n.jsx("option",{value:"yes",children:o("rsvp:yes")}),n.jsx("option",{value:"no",children:o("rsvp:no")})]})]})]},"step0"),e===1&&n.jsx(E.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:t.attending==="yes"?n.jsx(Pe,{guests:t.guests,onGuestsChange:s,required:!0}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"form-group",children:[n.jsxs("label",{htmlFor:"nonAttendingName",children:[o("rsvp:yourName")," ",n.jsx("span",{className:"required",children:"*"})]}),n.jsx("input",{id:"nonAttendingName",name:"nonAttendingName",type:"text",value:t.nonAttendingName,onChange:r,className:"form-input",required:!0,autoComplete:"name",spellCheck:!1})]}),n.jsxs("div",{className:"form-group",children:[n.jsxs("label",{htmlFor:"notes",children:[o("rsvp:messageToBrideGroom")," ",n.jsx("span",{className:"required",children:"*"})]}),n.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:r,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5,required:!0})]})]})},"guestsOrName"),e===2&&a&&n.jsxs(E.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[t.attending==="yes"&&n.jsxs("div",{className:"form-group",children:[n.jsx("label",{htmlFor:"notes",children:o("rsvp:messageToBrideGroom")}),n.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:r,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5})]}),n.jsx(We,{sitekey:Ye,onChange:i=>u(i),ref:m,style:{display:"inline-block",width:"100%",marginTop:"1rem"}}),!d&&g&&n.jsx("div",{className:"field-error",children:"Please complete reCAPTCHA"})]},"step3"),e===3&&n.jsx(E.div,{variants:V,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:n.jsxs("div",{className:"review",children:[n.jsxs("p",{children:[n.jsxs("strong",{children:[o("rsvp:email"),":"]})," ",t.email]}),n.jsxs("p",{children:[n.jsxs("strong",{children:[o("rsvp:attending"),":"]})," ",o(`rsvp:${t.attending}`)]}),t.attending==="yes"&&t.guests.length>0&&n.jsxs("div",{children:[n.jsxs("strong",{children:[o("rsvp:guestsTitle"),":"]}),n.jsx("ul",{children:t.guests.map((i,p)=>n.jsxs("li",{children:[i.firstName," ",i.lastName,i.dietary&&` - ${o("rsvp:dietary")}: ${i.dietary}`,i.note&&` - ${o("rsvp:guestNote")}: ${i.note}`]},p))})]}),t.attending==="no"&&n.jsxs("p",{children:[n.jsxs("strong",{children:[o("rsvp:name"),":"]})," ",t.nonAttendingName]}),t.notes&&n.jsxs("p",{children:[n.jsxs("strong",{children:[o("rsvp:messageToBrideGroom"),":"]})," ",t.notes]})]})},"step4")]})},ze=({submittedRef:e})=>{const{t}=$(["home","common","rsvp"]),[a,r]=v.useState(!1);return v.useEffect(()=>{const s=setTimeout(()=>r(!0),50),d=setInterval(()=>{r(!1),setTimeout(()=>r(!0),55)},1e4);return()=>{clearTimeout(s),clearInterval(d)}},[]),n.jsxs(E.div,{className:"rsvp-page container",ref:e,initial:{opacity:0,scale:.9,y:30},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25,duration:.6}},children:[n.jsx(E.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:20,delay:1},className:"heart-animated",style:{fontSize:"4rem",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:n.jsxs("svg",{viewBox:"0 0 24 24",children:[n.jsx("defs",{children:n.jsx("path",{id:"heart",d:"M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"})}),n.jsx(E.use,{xlinkHref:"#heart",initial:{opacity:0,scale:.33},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:15},style:{transformOrigin:"center"}},a?"on":"off")]})}),n.jsx(E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},style:{textAlign:"center",marginBottom:"1rem"},children:t("rsvp:thankYou")}),n.jsx(E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},style:{textAlign:"center",maxWidth:"500px",margin:"0 auto 2rem",lineHeight:1.6},children:t("rsvp:confirmation")})]})};function Je(e){const t=te(),[a,r]=v.useState(e),[s,d]=v.useState(0),[g,m]=v.useState(null),[u,o]=v.useState(!1),l=["contactAndAttendance","guestsOrName","captcha","review"];return{form:a,setForm:r,currentStep:s,steps:l,error:g,setError:m,hasValidGuests:u,handleChange:h=>{const{name:S,value:N}=h.target;r(x=>({...x,[S]:N})),m(null)},handleGuestsChange:h=>{r(S=>({...S,guests:h})),o(h.some(S=>S.firstName.trim()&&S.lastName.trim()))},nextStep:()=>{t.event("rsvp_step_complete",{event_label:l[s],step_number:s+1,step_name:l[s]}),d(h=>h+1)},prevStep:()=>{t.event("rsvp_step_back",{event_label:l[s],step_number:s+1,step_name:l[s]}),d(h=>h-1)},goToStep:h=>d(h)}}class D{constructor(t=0,a="Network Error"){this.status=t,this.text=a}}const Qe=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},R={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:Qe()},re=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},Xe=(e,t="https://api.emailjs.com")=>{if(!e)return;const a=re(e);R.publicKey=a.publicKey,R.blockHeadless=a.blockHeadless,R.storageProvider=a.storageProvider,R.blockList=a.blockList,R.limitRate=a.limitRate,R.origin=a.origin||t},me=async(e,t,a={})=>{const r=await fetch(R.origin+e,{method:"POST",headers:a,body:t}),s=await r.text(),d=new D(r.status,s);if(r.ok)return d;throw d},fe=(e,t,a)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!a||typeof a!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Ze=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},he=e=>e.webdriver||!e.languages||e.languages.length===0,ve=()=>new D(451,"Unavailable For Headless Browser"),et=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},tt=e=>!e.list?.length||!e.watchVariable,rt=(e,t)=>e instanceof FormData?e.get(t):e[t],ye=(e,t)=>{if(tt(e))return!1;et(e.list,e.watchVariable);const a=rt(t,e.watchVariable);return typeof a!="string"?!1:e.list.includes(a)},ge=()=>new D(403,"Forbidden"),nt=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},st=async(e,t,a)=>{const r=Number(await a.get(e)||0);return t-Date.now()+r},be=async(e,t,a)=>{if(!t.throttle||!a)return!1;nt(t.throttle,t.id);const r=t.id||e;return await st(r,t.throttle,a)>0?!0:(await a.set(r,Date.now().toString()),!1)},xe=()=>new D(429,"Too Many Requests"),it=async(e,t,a,r)=>{const s=re(r),d=s.publicKey||R.publicKey,g=s.blockHeadless||R.blockHeadless,m=s.storageProvider||R.storageProvider,u={...R.blockList,...s.blockList},o={...R.limitRate,...s.limitRate};return g&&he(navigator)?Promise.reject(ve()):(fe(d,e,t),Ze(a),a&&ye(u,a)?Promise.reject(ge()):await be(location.pathname,o,m)?Promise.reject(xe()):me("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:d,service_id:e,template_id:t,template_params:a}),{"Content-type":"application/json"}))},at=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ot=e=>typeof e=="string"?document.querySelector(e):e,ct=async(e,t,a,r)=>{const s=re(r),d=s.publicKey||R.publicKey,g=s.blockHeadless||R.blockHeadless,m=R.storageProvider||s.storageProvider,u={...R.blockList,...s.blockList},o={...R.limitRate,...s.limitRate};if(g&&he(navigator))return Promise.reject(ve());const l=ot(a);fe(d,e,t),at(l);const i=new FormData(l);return ye(u,i)?Promise.reject(ge()):await be(location.pathname,o,m)?Promise.reject(xe()):(i.append("lib_version","4.4.1"),i.append("service_id",e),i.append("template_id",t),i.append("user_id",d),me("/api/v1.0/email/send-form",i))},_e={init:Xe,send:it,sendForm:ct,EmailJSResponseStatus:D},lt="gVksEDEDoKBjB0TJU";_e.init(lt);function dt(e,t,a=0){const r=te(),[s,d]=v.useState(!1),[g,m]=v.useState(!1),[u,o]=v.useState(null),l=async()=>{if(console.log("Submitting RSVP...",{form:e,captchaToken:t}),!t){const i="Please complete reCAPTCHA.";o(i),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:i,error_type:"validation_error",current_step:a,attending_status:e.attending,has_captcha_token:!1});return}if(!e.email){const i="Email is required.";o(i),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:i,error_type:"validation_error",current_step:a,attending_status:e.attending,has_captcha_token:!!t});return}if(!e.attending){const i="Please indicate if you're attending.";o(i),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:i,error_type:"validation_error",current_step:a,has_captcha_token:!!t});return}if(e.attending==="yes"&&e.guests.length===0){const i="Please add at least one guest.";o(i),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:i,error_type:"validation_error",current_step:a,attending_status:e.attending,has_captcha_token:!!t});return}if(e.attending==="no"&&!e.nonAttendingName){const i="Please provide your name.";o(i),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:i,error_type:"validation_error",current_step:a,attending_status:e.attending,has_captcha_token:!!t});return}d(!0),o(null);try{const i=e.attending==="yes"?e.guests.map((f,_)=>`${_+1}. ${f.firstName} ${f.lastName}`+(f.dietary?` - Dietary: ${f.dietary}`:"")+(f.note?` - Note: ${f.note}`:"")).join(`
`):`Not attending: ${e.nonAttendingName}`,p={email:e.email,attending:e.attending,guestsCount:e.attending==="yes"?e.guests.length:1,guests:i,notes:e.notes||"None",recaptchaToken:t};console.log("Sending email with params:",p);const y=await _e.send("service_vvuhisc","template_4m25aki",p);console.log("EmailJS response:",y),r.event("rsvp_submit_success",{event_label:`RSVP ${e.attending==="yes"?"Accepted":"Declined"}`,attending:e.attending,guest_count:e.attending==="yes"?e.guests.length:1,dietary_requirements:e.guests[0]?.dietary||"none",locale:document.documentElement.lang}),r.event("conversion",{event_label:"RSVP Completed",send_to:"AW-CONVERSION-ID"}),r.event("rsvp_confirmation_view",{event_label:"Viewed confirmation page"}),r.event("page_view",{page_title:"RSVP Confirmation",page_location:window.location.href,page_path:"/rsvp/confirmation"}),m(!0)}catch(i){console.error("Submission error:",i);const p=i?.text||i?.message||"Failed to submit RSVP. Please try again.",y=i?.text?"emailjs_error":"network_error";o(p),r.event("rsvp_submit_error",{event_label:y,error_message:p,error_type:y,current_step:a,attending_status:e.attending,has_captcha_token:!!t}),r.event("exception",{description:`RSVP Error: ${y} - ${p}`,fatal:!1})}finally{d(!1)}};return v.useEffect(()=>{u&&console.error("RSVP Error:",u)},[u]),{submit:l,sending:s,submitted:g,error:u,setError:o,setSubmitted:m}}let z=!1,I=!1;const bt=we(function(){const{t,ready:a}=$(["home","common","rsvp"]),r=te();Re();const[s,d]=v.useState(!1),[g,m]=v.useState(null),u=v.useRef(null),{form:o,currentStep:l,steps:i,error:p,handleChange:y,handleGuestsChange:f,nextStep:_,prevStep:h,hasValidGuests:S}=Je({email:"",attending:"",guests:[],nonAttendingName:"",notes:"",website:""}),{submit:N,sending:x,submitted:j,error:c,setSubmitted:P}=dt(o,g,l),w=v.useRef(null),O=v.useRef(null),U=v.useRef(null),L=p||c;if(v.useEffect(()=>{z||(r.event("rsvp_start",{event_label:"User started RSVP form"}),z=!0),I=!1;const A=()=>{!j&&!I&&(r.event("rsvp_abandonment",{event_label:`Abandoned at ${i[l]}`,step_number:l+1,step_name:i[l]}),I=!0)};return window.addEventListener("beforeunload",A),()=>{window.removeEventListener("beforeunload",A),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{!window.location.pathname.includes("/rsvp")&&(!j&&!I&&(r.event("rsvp_abandonment",{event_label:`Abandoned at ${i[l]}`,step_number:l+1,step_name:i[l]}),I=!0),z=!1),u.current=null},100)}},[l,i,j,r]),v.useEffect(()=>d(!0),[]),v.useEffect(()=>{L&&w.current&&(w.current.scrollIntoView({behavior:"smooth",block:"center"}),w.current.focus()),j&&O.current&&O.current.focus()},[L,j]),!a)return n.jsx("div",{className:"loading",children:t("common:loading")});if(j)return n.jsx(ze,{onReset:()=>P(!1),submittedRef:O});const F=(l+1)/i.length*100,ne=()=>l===0?!o.attending||!o.email:l===1?o.attending==="yes"?!S:!o.nonAttendingName:l===2?!g:!1,je=t("rsvp:steps",{returnObjects:!0}),Se=i.map(A=>je[A])[l];return n.jsxs("div",{className:"rsvp-page container",children:[n.jsx("h1",{children:"Rsvp"}),n.jsx("p",{className:"step-description",children:Se}),n.jsx("div",{className:"progress-bar",children:n.jsx("div",{className:"progress-bar-fill",style:{width:`${F}%`}})}),n.jsxs("form",{className:"rsvp-form",onSubmit:A=>A.preventDefault(),children:[n.jsx(Ke,{currentStep:l,form:o,isClient:s,onChange:y,onGuestsChange:f,captchaToken:g,setCaptchaToken:m,recaptchaRef:U,error:L}),L&&n.jsx("div",{className:"rsvp-error",ref:w,role:"alert",tabIndex:-1,children:L}),n.jsxs("div",{className:"form-navigation",children:[n.jsx("button",{type:"button",onClick:h,disabled:l===0,title:t("common:back")||"Back",children:n.jsx(k.Back,{})}),n.jsxs("span",{children:[l+1,"/",i.length]}),l<i.length-1?n.jsx("button",{type:"button",onClick:_,disabled:ne(),title:t("common:next")||"Next",children:n.jsx(k.Next,{})}):n.jsx("button",{type:"button",onClick:N,disabled:x||ne(),children:t(x?"rsvp:sending":"rsvp:submit")})]})]})]})});export{bt as default};
