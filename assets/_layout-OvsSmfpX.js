import{p as w,a as i,t as T,w as E,v as R}from"./chunk-EPOLDU6W-C9vtjoJn.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{u as A,C as I}from"./Countdown-Bfv8YoBK.js";import{u as g}from"./useTranslation-DvHpW7Xw.js";import{u as C}from"./LanguageContext-BPaMIK5g.js";import{L as q,B as W,T as z}from"./BackToTopButton-BbEM-k7o.js";import{M as N,T as S,u as V,R as B}from"./Modal-B4v9BM00.js";import{u as O}from"./useWeddingData-DmPkR6aw.js";import{u as H}from"./ThemeContext-BZ3X1HL9.js";import{A as M,m as P}from"./proxy-B0g1OEgh.js";import"./Icon-CNAYQKQe.js";import"./i18next-BDvusv7y.js";function K({locale:u,links:s}){const{buildLink:d}=A(),{t:r}=g(["common"]),o=w(),a=i.useRef(null),[c,f]=i.useState({left:0,top:0,width:0}),[h,p]=i.useState(!1),m=(t=>t.replace(/^\/(en|es)/,"")||"/")(o.pathname),x=m==="/"||m==="",y=t=>{if(!a.current||!t)return;const n=a.current.getBoundingClientRect(),l=t.getBoundingClientRect();f({left:l.left-n.left,top:l.bottom-n.top-3,width:l.width})},k=t=>{p(!0),y(t)},j=()=>p(!1);return i.useEffect(()=>{if(h||!a.current)return;const t=Array.from(a.current.querySelectorAll(".nav-link")),n=s.findIndex(l=>l.path==="/"?x:m===l.path);n!==-1&&y(t[n])},[o.pathname,u,h,s,x,m]),i.useLayoutEffect(()=>{const t=()=>{if(!a.current)return;const n=Array.from(a.current.querySelectorAll(".nav-link")),l=s.findIndex(b=>b.path==="/"?x:m===b.path);l!==-1&&y(n[l])};return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[s,x,m]),e.jsx("nav",{className:"nav",children:e.jsxs("div",{className:"nav-links desktop",ref:a,children:[s.map(t=>e.jsx(T,{to:d(t.path),className:"nav-link",ref:n=>{},onMouseEnter:n=>k(n.currentTarget),onMouseLeave:j,children:t.label},t.path)),e.jsx("div",{className:"nav-indicator",style:{transform:`translate(${c.left}px)`,width:c.width}})]})})}const D=({openCookieConsentModal:u})=>{const s=w(),{locale:d}=C(),r=O(),{t:o}=g(),a=s.pathname==="/"||s.pathname===""||s.pathname===`/${d}`;if(!r?.wedding)return null;const{date:c}=r.wedding,{time:f}=r.wedding.ceremony;return e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-content",children:[!a&&e.jsx(I,{size:"sm",date:c,time:f}),e.jsx("button",{onClick:u,className:"footer__cookie-btn",children:o("common:change_cookie_preferences","See cookie Preferences.")})]})})};function F({isOpen:u,onClose:s,children:d,autoClose:r=3e3}){const o=i.useRef(null);i.useEffect(()=>(o.current&&(clearTimeout(o.current),o.current=null),u&&r&&(o.current=setTimeout(()=>{s(),o.current=null},r)),()=>{o.current&&(clearTimeout(o.current),o.current=null)}),[u,r,s]);const a={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95}};return e.jsx(M,{children:u&&e.jsx(P.div,{className:"toast-wrapper",variants:a,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.4,ease:"easeInOut"},children:e.jsx("div",{className:"toast-content",children:d})})})}function L(){return e.jsx("span",{className:"wave-emoji",role:"img","aria-label":"waving hand",children:"ðŸ‘‹"})}const v=[{key:"necessary",label:"Necessary cookies (required)",required:!0},{key:"analytics",label:"Analytics cookies"},{key:"personalization",label:"Personalization cookies"}];function G({isOpen:u,onClose:s,mode:d="first_visit"}){const{visitor:r,cookiePreference:o,setCookiePreference:a}=H(),{t:c}=g(["home","common"]),[f,h]=i.useState(()=>v.reduce((t,n)=>(t[n.key]=n.required?!0:o?.[n.key]??!1,t),{})),p=f.personalization===!0,[_,m]=i.useState(d==="change_preferences"||o===null);if(i.useEffect(()=>{u&&(h(v.reduce((t,n)=>(t[n.key]=n.required?!0:o?.[n.key]??!1,t),{})),m(d==="change_preferences"||o===null))},[u,o,d]),!r)return e.jsx(N,{isOpen:u,onClose:s,children:e.jsx("p",{className:"ccm__loading",children:c("common:loading","Loading...")})});const x=()=>{a(f),s()},y=()=>{const t=v.reduce((n,l)=>(n[l.key]=!0,n),{});h(t),a(t),s()},k=()=>{const t=v.reduce((n,l)=>(n[l.key]=!!l.required,n),{});h(t),a(t),s()},j=()=>p?d!=="first_visit"?c("common:change_preferences_prompt","Change your preferences to improve your experience."):r.isFirstVisit?e.jsxs(S,{i18nKey:"home:welcome_first_visit",components:{emoji:e.jsx(L,{})},children:["Welcome to our wedding website! ",e.jsx("emoji",{})]}):r.daysSinceLastVisit===0?e.jsxs(S,{i18nKey:"home:welcome_back_today",components:{emoji:e.jsx(L,{})},children:["Welcome back! ",e.jsx("emoji",{})]}):r.daysSinceLastVisit===1?c("home:welcome_back_yesterday","Great to see you again! You were here yesterday."):r.daysSinceLastVisit<7?c("home:welcome_back_days","Welcome back! It's been {{days}} days since your last visit.",{days:r.daysSinceLastVisit}):c("home:welcome_back_long_time","Welcome back! We've missed you! It's been {{days}} days.",{days:r.daysSinceLastVisit}):c("common:welcome_generic","Welcome to our wedding website!");return o&&d==="first_visit"?e.jsx(F,{isOpen:u,onClose:s,autoClose:3e3,children:e.jsx("p",{className:"ccm__greeting",children:j()})}):e.jsx(N,{isOpen:u,onClose:s,children:e.jsxs("div",{className:"ccm",children:[e.jsx("button",{className:"ccm__close",onClick:s,"aria-label":c("common:close","Close modal"),children:"Ã—"}),e.jsx("p",{className:"ccm__greeting",children:j()}),_?e.jsxs("div",{className:"ccm__preferences",id:"cookie-preferences",children:[e.jsx("p",{className:"ccm__intro",children:c("common:cookie_intro","We use cookies to improve your experience. You can choose which types of cookies you allow:")}),e.jsx("div",{className:"ccm__checkboxes",children:v.map(t=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:f[t.key],disabled:t.required,onChange:n=>h({...f,[t.key]:n.target.checked})}),t.label]},t.key))}),e.jsxs("div",{className:"ccm__actions",children:[e.jsx("button",{className:"ccm__save-btn",onClick:x,children:c("common:save_preferences","Save Preferences")}),e.jsx("button",{className:"ccm__accept-all-btn",onClick:y,children:c("common:accept_all","Accept All")}),e.jsx("button",{className:"ccm__reject-all-btn",onClick:k,children:c("common:reject_all","Reject All")})]})]}):e.jsx("button",{className:"ccm__toggle-btn",onClick:()=>m(!0),children:c("common:show_preferences","Show Preferences")})]})})}const ce=E(function(){const s=w(),d=R(),[r,o]=i.useTransition(),{locale:a,switchLanguage:c}=C(),[f,h]=i.useState(!1),{t:p}=g(["common"]),_=i.useRef(null),[m,x]=i.useState("first_visit"),[y,k]=i.useState(!0),j=V(()=>{});i.useEffect(()=>{j?.scrollTo(0,{immediate:!0})},[s.pathname,j]);const t=[{path:"/",label:p("nav.home")},{path:"/rsvp",label:p("nav.rsvp")},{path:"/schedule",label:p("nav.schedule")},{path:"/qa",label:p("nav.qa")}],n=()=>{x("change_preferences"),k(!0)},l=()=>{k(!1)};return i.useEffect(()=>{console.log("cookieConsentModalMode",m),y||x("first_visit")},[m]),e.jsxs(B,{root:!0,children:[e.jsx(G,{isOpen:y,onClose:l,mode:m}),e.jsxs("div",{className:"container",children:[e.jsx(K,{menuOpen:f,setMenuOpen:h,locale:a,links:t,onLanguageSwitch:()=>o(c),isPending:r,hamburgerRef:_}),e.jsxs("main",{className:"main",children:[e.jsx(M,{mode:"wait",children:e.jsx(P.div,{className:"page-content",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},children:d},s.pathname)}),e.jsxs("div",{className:"fixed-container",children:[e.jsx(q,{currentLocale:a,onSwitch:c,isPending:r}),e.jsxs("div",{className:"group",children:[e.jsx(W,{onClick:()=>j?.scrollTo(0,{duration:1})}),e.jsx(z,{})]})]}),e.jsx(D,{openCookieConsentModal:n})]})]})]})});export{ce as default};
