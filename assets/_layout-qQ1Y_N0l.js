import{p as L,a as r,t as z,w as V,v as H}from"./chunk-EPOLDU6W-C9vtjoJn.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{u as Y,C as K}from"./Countdown-Bfv8YoBK.js";import{u as P}from"./ConfigContext-3bXf0CwC.js";import{u as E}from"./LanguageContext-BPaMIK5g.js";import{L as $,B as D,T as F}from"./BackToTopButton-BZzlhLsz.js";import{u as G,R as J}from"./lenis-react-DQp2-cqK.js";import{u as Q}from"./useWeddingData-DmPkR6aw.js";import{u as N}from"./LayoutContext-CEUgmXuB.js";import{u as C}from"./useTranslation-DvHpW7Xw.js";import{m as S,A,M,T as R}from"./Modal-Sal8OyIs.js";import{u as U}from"./SessionContext-DZuC17a2.js";import"./ThemeContext-CWFw_am7.js";import"./Icon-fSrDZDb7.js";import"./i18next-BDvusv7y.js";function X({locale:d,links:a}){const u=P(),{buildLink:c}=Y(),n=L(),l=r.useRef(null),[i,y]=r.useState({left:0,top:0,width:0}),[h,p]=r.useState(!1),m=(t=>t.replace(/^\/(en|es)/,"")||"/")(n.pathname),k=m==="/"||m==="",x=r.useMemo(()=>a.filter(t=>{const o=t.path.replace("/","")||"home";return u[o]?.enabled??!0}),[a,u]),g=t=>{if(!l.current||!t)return;const o=l.current.getBoundingClientRect(),f=t.getBoundingClientRect();y({left:f.left-o.left,top:f.bottom-o.top-3,width:f.width})},j=t=>{p(!0),g(t)},s=()=>p(!1);return r.useEffect(()=>{if(h||!l.current)return;const t=Array.from(l.current.querySelectorAll(".nav-link")),o=x.findIndex(f=>f.path==="/"?k:m===f.path);o!==-1&&g(t[o])},[n.pathname,d,h,x,k,m]),r.useLayoutEffect(()=>{const t=()=>{if(!l.current)return;const o=Array.from(l.current.querySelectorAll(".nav-link")),f=x.findIndex(v=>v.path==="/"?k:m===v.path);f!==-1&&g(o[f])};return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[x,k,m]),u.layout?.showHeader?.enabled?e.jsx("nav",{className:"nav",children:e.jsxs("div",{className:"nav-links desktop",ref:l,children:[x.map(t=>e.jsx(z,{to:c(t.path),className:"nav-link",ref:o=>{},onMouseEnter:o=>j(o.currentTarget),onMouseLeave:s,children:t.label},t.path)),e.jsx("div",{className:"nav-indicator",style:{transform:`translate(${i.left}px)`,width:i.width}})]})}):null}const Z=({openCookieConsentModal:d})=>{const a=L(),{locale:u}=E(),{state:{fixedOffsetY:c}}=N(),n=Q(),{t:l}=C(),i=a.pathname==="/"||a.pathname===""||a.pathname===`/${u}`;if(!n?.wedding)return null;const{date:y}=n.wedding,{time:h}=n.wedding.ceremony,p=Math.max(20,-c+20);return e.jsx(S.footer,{className:"footer",animate:{paddingBottom:`${p}px`,opacity:1,y:0},initial:{opacity:0,y:20,paddingBottom:"20px"},transition:{paddingBottom:{type:"spring",stiffness:300,damping:30},opacity:{duration:.4},y:{duration:.4}},children:e.jsxs("div",{className:"footer-content",children:[!i&&e.jsx(K,{size:"sm",date:y,time:h}),e.jsx("button",{onClick:d,className:"footer__cookie-btn",children:l("common:change_cookie_preferences","See cookie Preferences.")})]})})};function ee({isOpen:d,onClose:a,children:u,autoClose:c=3e3}){const n=r.useRef(null);r.useEffect(()=>(n.current&&(clearTimeout(n.current),n.current=null),d&&c&&(n.current=setTimeout(()=>{a(),n.current=null},c)),()=>{n.current&&(clearTimeout(n.current),n.current=null)}),[d,c,a]);const l={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95}};return e.jsx(A,{children:d&&e.jsx(S.div,{className:"toast-wrapper",variants:l,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.4,ease:"easeInOut"},children:e.jsx("div",{className:"toast-content",children:u})})})}function T(){return e.jsx("span",{className:"wave-emoji",role:"img","aria-label":"waving hand",children:"ðŸ‘‹"})}const w=[{key:"necessary",label:"Necessary cookies (required)",required:!0},{key:"analytics",label:"Analytics cookies"},{key:"personalization",label:"Personalization cookies"}];function te({isOpen:d,onClose:a,mode:u="first_visit"}){const{visitor:c,cookiePreference:n,setCookiePreference:l}=U(),{t:i}=C(["home","common"]),[y,h]=r.useState(()=>w.reduce((s,t)=>(s[t.key]=t.required?!0:n?.[t.key]??!1,s),{})),p=y.personalization===!0,[b,m]=r.useState(u==="change_preferences"||n===null);if(r.useEffect(()=>{d&&(h(w.reduce((s,t)=>(s[t.key]=t.required?!0:n?.[t.key]??!1,s),{})),m(u==="change_preferences"||n===null))},[d,n,u]),!c)return e.jsx(M,{isOpen:d,onClose:a,children:e.jsx("p",{className:"ccm__loading",children:i("common:loading","Loading...")})});const k=()=>{l(y),a()},x=()=>{const s=w.reduce((t,o)=>(t[o.key]=!0,t),{});h(s),l(s),a()},g=()=>{const s=w.reduce((t,o)=>(t[o.key]=!!o.required,t),{});h(s),l(s),a()},j=()=>p?u!=="first_visit"?i("common:change_preferences_prompt","Change your preferences to improve your experience."):c.isFirstVisit?e.jsxs(R,{i18nKey:"home:welcome_first_visit",components:{emoji:e.jsx(T,{})},children:["Welcome to our wedding website! ",e.jsx("emoji",{})]}):c.daysSinceLastVisit===0?e.jsxs(R,{i18nKey:"home:welcome_back_today",components:{emoji:e.jsx(T,{})},children:["Welcome back! ",e.jsx("emoji",{})]}):c.daysSinceLastVisit===1?i("home:welcome_back_yesterday","Great to see you again! You were here yesterday."):c.daysSinceLastVisit<7?i("home:welcome_back_days","Welcome back! It's been {{days}} days since your last visit.",{days:c.daysSinceLastVisit}):i("home:welcome_back_long_time","Welcome back! We've missed you! It's been {{days}} days.",{days:c.daysSinceLastVisit}):i("common:welcome_generic","Welcome to our wedding website!");return n&&u==="first_visit"?e.jsx(ee,{isOpen:d,onClose:a,autoClose:3e3,children:e.jsx("p",{className:"ccm__greeting",children:j()})}):e.jsx(M,{isOpen:d,onClose:a,children:e.jsxs("div",{className:"ccm",children:[e.jsx("button",{className:"ccm__close",onClick:a,"aria-label":i("common:close","Close modal"),children:"Ã—"}),e.jsx("p",{className:"ccm__greeting",children:j()}),b?e.jsxs("div",{className:"ccm__preferences",id:"cookie-preferences",children:[e.jsx("p",{className:"ccm__intro",children:i("common:cookie_intro","We use cookies to improve your experience. You can choose which types of cookies you allow:")}),e.jsx("div",{className:"ccm__checkboxes",children:w.map(s=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:y[s.key],disabled:s.required,onChange:t=>h({...y,[s.key]:t.target.checked})}),s.label]},s.key))}),e.jsxs("div",{className:"ccm__actions",children:[e.jsx("button",{className:"ccm__save-btn",onClick:k,children:i("common:save_preferences","Save Preferences")}),e.jsx("button",{className:"ccm__accept-all-btn",onClick:x,children:i("common:accept_all","Accept All")}),e.jsx("button",{className:"ccm__reject-all-btn",onClick:g,children:i("common:reject_all","Reject All")})]})]}):e.jsx("button",{className:"ccm__toggle-btn",onClick:()=>m(!0),children:i("common:show_preferences","Show Preferences")})]})})}const xe=V(function(){const a=L(),u=H(),[c,n]=r.useTransition(),{locale:l,switchLanguage:i}=E(),[y,h]=r.useState(!1),{t:p}=C(["common"]),b=r.useRef(null),[m,k]=r.useState("first_visit"),[x,g]=r.useState(!0),j=r.useRef(null),s=N(),t=P(),o=G(()=>{}),{state:{fixedOffsetY:f}}=N(),v=r.useRef(!1);r.useEffect(()=>{if(!o||v.current)return;v.current=!0;const _=setTimeout(()=>{o.scrollTo(0,{immediate:!0})},400);return()=>{clearTimeout(_),v.current=!1}},[a.pathname,o]);const I=[{path:"/",label:p("nav.home")},{path:"/rsvp",label:p("nav.rsvp"),feature:"rsvp"},{path:"/schedule",label:p("nav.schedule"),feature:"schedule"},{path:"/qa",label:p("nav.qa"),feature:"qa"}].filter(_=>_.feature?!!_.feature.split(".").reduce((O,W)=>O?.[W],t):!0),q=()=>{k("change_preferences"),g(!0)},B=()=>{g(!1)};return r.useEffect(()=>{console.log("cookieConsentModalMode",m),x||k("first_visit")},[m]),r.useEffect(()=>{j.current&&j.current.style.setProperty("--y-offset",s.state.fixedOffsetY*-1+"px")},[s.state.fixedOffsetY]),e.jsxs(J,{root:!0,options:{prevent:_=>_.closest(".search-dropdown__list")!==null},children:[e.jsx(te,{isOpen:x,onClose:B,mode:m}),e.jsxs("div",{className:"container",children:[e.jsx(X,{menuOpen:y,setMenuOpen:h,locale:l,links:I,onLanguageSwitch:()=>n(i),isPending:c,hamburgerRef:b}),e.jsxs("main",{className:"main",ref:j,children:[e.jsx(A,{mode:"wait",children:e.jsx(S.div,{className:"page-content",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},children:u},a.pathname)}),e.jsxs(S.div,{className:"fixed-container",animate:{y:f},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsx($,{currentLocale:l,onSwitch:i,isPending:c}),e.jsxs("div",{className:"group",children:[e.jsx(D,{onClick:()=>o?.scrollTo(0,{duration:1})}),t.layout.theme.enabled&&e.jsx(F,{})]})]}),e.jsx(Z,{openCookieConsentModal:q})]})]})]})});export{xe as default};
