import{a as h,y as ue,w as we,p as Re}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as s}from"./jsx-runtime-u17CrQMm.js";import{I as A}from"./Icon-Dk5l_C6R.js";import{u as I}from"./useTranslation-B9zSoiKr.js";import{m as E,A as ee}from"./proxy-DBX3VoSC.js";import{u as te}from"./AnalyticsContext-CJAiYubj.js";const se=({index:e,guest:t,onUpdate:i,onRemove:r,onConfirm:n,isDraft:d=!1,isRostered:y=!1})=>{const{t:u}=I(["rsvp"]),[v,p]=h.useState(!1),[o,a]=h.useState(!1),[c,m]=h.useState(!1),f=h.useRef(null),j=t.firstName.trim()&&t.lastName.trim(),x=(g,S)=>{i?.(e,g,S)};return h.useEffect(()=>{t.dietary&&p(!0),t.note&&a(!0)},[t.dietary,t.note]),h.useEffect(()=>{const g=S=>{f.current&&!f.current.contains(S.target)&&m(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]),s.jsxs(E.div,{className:`guest-card ${j?"":"invalid"}`,layout:"position",initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{type:"spring",stiffness:400,damping:30,layout:{type:"spring",stiffness:500}},children:[s.jsxs("div",{children:[s.jsxs("div",{className:"form-row",children:[s.jsx("input",{type:"text",placeholder:u("rsvp:firstName"),value:t.firstName,onChange:g=>x("firstName",g.target.value)}),s.jsx("input",{type:"text",placeholder:u("rsvp:lastName"),value:t.lastName,onChange:g=>x("lastName",g.target.value)})]}),s.jsxs(ee,{children:["// Replace height animations with scaleY + maxHeight",v&&s.jsxs(E.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[s.jsx("input",{type:"text",placeholder:u("rsvp:dietaryPlaceholder"),value:t.dietary,onChange:g=>x("dietary",g.target.value)}),s.jsx("button",{type:"button",className:"close-btn",onClick:()=>p(!1),children:"×"})]}),o&&s.jsxs(E.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[s.jsx("textarea",{placeholder:u("rsvp:notePlaceholder"),value:t.note||"",onChange:g=>x("note",g.target.value)}),s.jsx("button",{type:"button",className:"close-btn",onClick:()=>a(!1),children:"×"})]})]})]}),s.jsx("div",{className:"guest-card-actions",children:d?s.jsx(s.Fragment,{children:s.jsx(E.button,{type:"button",className:"form-btn add-guest-btn",disabled:!j,onClick:()=>{n&&n(),m(!1),p(!1),a(!1)},whileHover:j?{scale:1.02}:{},title:u("rsvp:addGuest"),children:s.jsx(A.Add,{})})}):s.jsxs(s.Fragment,{children:[!v&&s.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>p(!0),title:u("rsvp:addDietary"),children:s.jsx(A.Food,{})}),!o&&s.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>a(!0),title:u("rsvp:addNote"),children:s.jsx(A.Note,{})}),s.jsx("button",{type:"button",className:"remove-guest",onClick:()=>{window.confirm(`Are you sure you want to remove ${t.firstName} ${t.lastName} from the guest roster?`)&&r?.(e)},children:s.jsx(A.Close,{})})]})})]})},ie={firstName:"",lastName:"",dietary:"",note:""},Ne=({guests:e,onGuestsChange:t})=>{const{t:i}=I(["rsvp"]),[r,n]=h.useState(ie),d=h.useCallback(()=>{!r.firstName.trim()||!r.lastName.trim()||(t([...e,r]),n(ie))},[r,e,t]),y=h.useCallback(p=>{t(e.filter((o,a)=>a!==p))},[e,t]),u=h.useCallback((p,o,a)=>{t(e.map((c,m)=>m===p?{...c,[o]:a}:c))},[e,t]),v=h.useCallback((p,o)=>{n(a=>({...a,[p]:o}))},[]);return s.jsxs("div",{className:"guests-section",children:[s.jsxs("h3",{children:[i("rsvp:guestsTitle"),e.length>0&&` (${e.length})`]}),s.jsxs(ee,{children:[e.map((p,o)=>s.jsx(se,{index:o,guest:p,onUpdate:u,onRemove:y,isRostered:!0},`roster-${o}`)),s.jsx(se,{index:e.length,guest:r,onUpdate:(p,o,a)=>v(o,a),onConfirm:d,isDraft:!0},"draft")]})]})};var U={exports:{}},B,ae;function Pe(){if(ae)return B;ae=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return B=e,B}var G,oe;function Te(){if(oe)return G;oe=1;var e=Pe();function t(){}function i(){}return i.resetWarningCache=t,G=function(){function r(y,u,v,p,o,a){if(a!==e){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}r.isRequired=r;function n(){return r}var d={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:n,element:r,elementType:r,instanceOf:n,node:r,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:i,resetWarningCache:t};return d.PropTypes=d,d},G}var ce;function Ee(){return ce||(ce=1,U.exports=Te()()),U.exports}var Oe=Ee();const T=ue(Oe);var Le=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Y.apply(this,arguments)}function ke(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,d;for(d=0;d<r.length;d++)n=r[d],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function V(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,J(e,t)}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},J(e,t)}var H=(function(e){Ce(t,e);function t(){var r;return r=e.call(this)||this,r.handleExpired=r.handleExpired.bind(V(r)),r.handleErrored=r.handleErrored.bind(V(r)),r.handleChange=r.handleChange.bind(V(r)),r.handleRecaptchaRef=r.handleRecaptchaRef.bind(V(r)),r}var i=t.prototype;return i.getCaptchaFunction=function(n){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[n]:this.props.grecaptcha[n]:null},i.getValue=function(){var n=this.getCaptchaFunction("getResponse");return n&&this._widgetId!==void 0?n(this._widgetId):null},i.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},i.execute=function(){var n=this.getCaptchaFunction("execute");if(n&&this._widgetId!==void 0)return n(this._widgetId);this._executeRequested=!0},i.executeAsync=function(){var n=this;return new Promise(function(d,y){n.executionResolve=d,n.executionReject=y,n.execute()})},i.reset=function(){var n=this.getCaptchaFunction("reset");n&&this._widgetId!==void 0&&n(this._widgetId)},i.forceReset=function(){var n=this.getCaptchaFunction("reset");n&&n()},i.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},i.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},i.handleChange=function(n){this.props.onChange&&this.props.onChange(n),this.executionResolve&&(this.executionResolve(n),delete this.executionReject,delete this.executionResolve)},i.explicitRender=function(){var n=this.getCaptchaFunction("render");if(n&&this._widgetId===void 0){var d=document.createElement("div");this._widgetId=n(d,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(d)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},i.componentDidMount=function(){this.explicitRender()},i.componentDidUpdate=function(){this.explicitRender()},i.handleRecaptchaRef=function(n){this.captcha=n},i.render=function(){var n=this.props;n.sitekey,n.onChange,n.theme,n.type,n.tabindex,n.onExpired,n.onErrored,n.size,n.stoken,n.grecaptcha,n.badge,n.hl,n.isolated;var d=ke(n,Le);return h.createElement("div",Y({},d,{ref:this.handleRecaptchaRef}))},t})(h.Component);H.displayName="ReCAPTCHA";H.propTypes={sitekey:T.string.isRequired,onChange:T.func,grecaptcha:T.object,theme:T.oneOf(["dark","light"]),type:T.oneOf(["image","audio"]),tabindex:T.number,onExpired:T.func,onErrored:T.func,size:T.oneOf(["compact","normal","invisible"]),stoken:T.string,hl:T.string,badge:T.oneOf(["bottomright","bottomleft","inline"]),isolated:T.bool};H.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var W={exports:{}},b={};var le;function Ae(){if(le)return b;le=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,i=e?Symbol.for("react.portal"):60106,r=e?Symbol.for("react.fragment"):60107,n=e?Symbol.for("react.strict_mode"):60108,d=e?Symbol.for("react.profiler"):60114,y=e?Symbol.for("react.provider"):60109,u=e?Symbol.for("react.context"):60110,v=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,o=e?Symbol.for("react.forward_ref"):60112,a=e?Symbol.for("react.suspense"):60113,c=e?Symbol.for("react.suspense_list"):60120,m=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,j=e?Symbol.for("react.block"):60121,x=e?Symbol.for("react.fundamental"):60117,g=e?Symbol.for("react.responder"):60118,S=e?Symbol.for("react.scope"):60119;function _(l){if(typeof l=="object"&&l!==null){var P=l.$$typeof;switch(P){case t:switch(l=l.type,l){case v:case p:case r:case d:case n:case a:return l;default:switch(l=l&&l.$$typeof,l){case u:case o:case f:case m:case y:return l;default:return P}}case i:return P}}}function w(l){return _(l)===p}return b.AsyncMode=v,b.ConcurrentMode=p,b.ContextConsumer=u,b.ContextProvider=y,b.Element=t,b.ForwardRef=o,b.Fragment=r,b.Lazy=f,b.Memo=m,b.Portal=i,b.Profiler=d,b.StrictMode=n,b.Suspense=a,b.isAsyncMode=function(l){return w(l)||_(l)===v},b.isConcurrentMode=w,b.isContextConsumer=function(l){return _(l)===u},b.isContextProvider=function(l){return _(l)===y},b.isElement=function(l){return typeof l=="object"&&l!==null&&l.$$typeof===t},b.isForwardRef=function(l){return _(l)===o},b.isFragment=function(l){return _(l)===r},b.isLazy=function(l){return _(l)===f},b.isMemo=function(l){return _(l)===m},b.isPortal=function(l){return _(l)===i},b.isProfiler=function(l){return _(l)===d},b.isStrictMode=function(l){return _(l)===n},b.isSuspense=function(l){return _(l)===a},b.isValidElementType=function(l){return typeof l=="string"||typeof l=="function"||l===r||l===p||l===d||l===n||l===a||l===c||typeof l=="object"&&l!==null&&(l.$$typeof===f||l.$$typeof===m||l.$$typeof===y||l.$$typeof===u||l.$$typeof===o||l.$$typeof===x||l.$$typeof===g||l.$$typeof===S||l.$$typeof===j)},b.typeOf=_,b}var de;function $e(){return de||(de=1,W.exports=Ae()),W.exports}var K,pe;function Ie(){if(pe)return K;pe=1;var e=$e(),t={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},d={};d[e.ForwardRef]=r,d[e.Memo]=n;function y(f){return e.isMemo(f)?n:d[f.$$typeof]||t}var u=Object.defineProperty,v=Object.getOwnPropertyNames,p=Object.getOwnPropertySymbols,o=Object.getOwnPropertyDescriptor,a=Object.getPrototypeOf,c=Object.prototype;function m(f,j,x){if(typeof j!="string"){if(c){var g=a(j);g&&g!==c&&m(f,g,x)}var S=v(j);p&&(S=S.concat(p(j)));for(var _=y(f),w=y(j),l=0;l<S.length;++l){var P=S[l];if(!i[P]&&!(x&&x[P])&&!(w&&w[P])&&!(_&&_[P])){var R=o(j,P);try{u(f,P,R)}catch{}}}}return f}return K=m,K}var Fe=Ie();const De=ue(Fe);function Q(){return Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Q.apply(this,arguments)}function Ve(e,t){if(e==null)return{};var i={},r=Object.keys(e),n,d;for(d=0;d<r.length;d++)n=r[d],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function qe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var O={},He=0;function Me(e,t){return t=t||{},function(r){var n=r.displayName||r.name||"Component",d=(function(u){qe(v,u);function v(o,a){var c;return c=u.call(this,o,a)||this,c.state={},c.__scriptURL="",c}var p=v.prototype;return p.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+He++),this.__scriptLoaderID},p.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},p.asyncScriptLoaderHandleLoad=function(a){var c=this;this.setState(a,function(){return c.props.asyncScriptOnLoad&&c.props.asyncScriptOnLoad(c.state)})},p.asyncScriptLoaderTriggerOnScriptLoaded=function(){var a=O[this.__scriptURL];if(!a||!a.loaded)throw new Error("Script is not loaded.");for(var c in a.observers)a.observers[c](a);delete window[t.callbackName]},p.componentDidMount=function(){var a=this,c=this.setupScriptURL(),m=this.asyncScriptLoaderGetScriptLoaderID(),f=t,j=f.globalName,x=f.callbackName,g=f.scriptId;if(j&&typeof window[j]<"u"&&(O[c]={loaded:!0,observers:{}}),O[c]){var S=O[c];if(S&&(S.loaded||S.errored)){this.asyncScriptLoaderHandleLoad(S);return}S.observers[m]=function(R){return a.asyncScriptLoaderHandleLoad(R)};return}var _={};_[m]=function(R){return a.asyncScriptLoaderHandleLoad(R)},O[c]={loaded:!1,observers:_};var w=document.createElement("script");w.src=c,w.async=!0;for(var l in t.attributes)w.setAttribute(l,t.attributes[l]);g&&(w.id=g);var P=function(L){if(O[c]){var M=O[c],k=M.observers;for(var D in k)L(k[D])&&delete k[D]}};x&&typeof window<"u"&&(window[x]=function(){return a.asyncScriptLoaderTriggerOnScriptLoaded()}),w.onload=function(){var R=O[c];R&&(R.loaded=!0,P(function(L){return x?!1:(L(R),!0)}))},w.onerror=function(){var R=O[c];R&&(R.errored=!0,P(function(L){return L(R),!0}))},document.body.appendChild(w)},p.componentWillUnmount=function(){var a=this.__scriptURL;if(t.removeOnUnmount===!0)for(var c=document.getElementsByTagName("script"),m=0;m<c.length;m+=1)c[m].src.indexOf(a)>-1&&c[m].parentNode&&c[m].parentNode.removeChild(c[m]);var f=O[a];f&&(delete f.observers[this.asyncScriptLoaderGetScriptLoaderID()],t.removeOnUnmount===!0&&delete O[a])},p.render=function(){var a=t.globalName,c=this.props;c.asyncScriptOnLoad;var m=c.forwardedRef,f=Ve(c,["asyncScriptOnLoad","forwardedRef"]);return a&&typeof window<"u"&&(f[a]=typeof window[a]<"u"?window[a]:void 0),f.ref=m,h.createElement(r,f)},v})(h.Component),y=h.forwardRef(function(u,v){return h.createElement(d,Q({},u,{forwardedRef:v}))});return y.displayName="AsyncScriptLoader("+n+")",y.propTypes={asyncScriptOnLoad:T.func},De(y,r)}}var X="onloadcallback",Ue="grecaptcha";function Z(){return typeof window<"u"&&window.recaptchaOptions||{}}function Be(){var e=Z(),t=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+t+"/recaptcha/enterprise.js?onload="+X+"&render=explicit":"https://"+t+"/recaptcha/api.js?onload="+X+"&render=explicit"}const Ge=Me(Be,{callbackName:X,globalName:Ue,attributes:Z().nonce?{nonce:Z().nonce}:{}})(H),q={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},We=({currentStep:e,form:t,isClient:i,onChange:r,onGuestsChange:n,captchaToken:d,error:y,recaptchaRef:u,setCaptchaToken:v,recaptchaSiteKey:p})=>{const{t:o}=I(["home","common","rsvp"]),a=c=>c.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)?null:o("rsvp:errors.invalidEmail"):o("rsvp:errors.required");return s.jsxs(ee,{mode:"wait",children:[e===0&&s.jsxs(E.div,{variants:q,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"email",children:[o("rsvp:email")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsx("input",{id:"email",name:"email",type:"email",value:t.email,spellCheck:!1,onKeyDown:c=>c.key===" "&&c.preventDefault(),onPaste:c=>/\s/.test(c.clipboardData.getData("text"))&&c.preventDefault(),onChange:r,className:`form-input ${t.email.trim()?a(t.email)?"form-input-invalid":"form-input-valid":""}`,required:!0,autoComplete:"email"}),t.email&&a(t.email)&&s.jsx("div",{className:"field-error",children:a(t.email)})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"attending",children:[o("rsvp:attending")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsxs("select",{id:"attending",name:"attending",value:t.attending,onChange:r,className:`form-input ${t.attending?"form-input-valid":""}`,required:!0,autoComplete:"off",children:[s.jsx("option",{value:"",children:o("rsvp:select")}),s.jsx("option",{value:"yes",children:o("rsvp:yes")}),s.jsx("option",{value:"no",children:o("rsvp:no")})]})]})]},"step0"),e===1&&s.jsx(E.div,{variants:q,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:t.attending==="yes"?s.jsx(Ne,{guests:t.guests,onGuestsChange:n,required:!0}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"nonAttendingName",children:[o("rsvp:yourName")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsx("input",{id:"nonAttendingName",name:"nonAttendingName",type:"text",value:t.nonAttendingName,onChange:r,className:"form-input",required:!0,autoComplete:"name",spellCheck:!1})]}),s.jsxs("div",{className:"form-group",children:[s.jsxs("label",{htmlFor:"notes",children:[o("rsvp:messageToBrideGroom")," ",s.jsx("span",{className:"required",children:"*"})]}),s.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:r,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5,required:!0})]})]})},"guestsOrName"),e===2&&i&&s.jsxs(E.div,{variants:q,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:[t.attending==="yes"&&s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"notes",children:o("rsvp:messageToBrideGroom")}),s.jsx("textarea",{id:"notes",name:"notes",value:t.notes,onChange:r,className:"form-input",placeholder:o("rsvp:messagePlaceholder"),rows:5})]}),s.jsx(Ge,{sitekey:p,onChange:c=>v(c),ref:u,style:{display:"inline-block",width:"100%",marginTop:"1rem"}}),!d&&y&&s.jsx("div",{className:"field-error",children:"Please complete reCAPTCHA"})]},"step3"),e===3&&s.jsx(E.div,{variants:q,initial:"initial",animate:"animate",exit:"exit",className:"form-content",children:s.jsxs("div",{className:"review",children:[s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:email"),":"]})," ",t.email]}),s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:attending"),":"]})," ",o(`rsvp:${t.attending}`)]}),t.attending==="yes"&&t.guests.length>0&&s.jsxs("div",{children:[s.jsxs("strong",{children:[o("rsvp:guestsTitle"),":"]}),s.jsx("ul",{children:t.guests.map((c,m)=>s.jsxs("li",{children:[c.firstName," ",c.lastName,c.dietary&&` - ${o("rsvp:dietary")}: ${c.dietary}`,c.note&&` - ${o("rsvp:guestNote")}: ${c.note}`]},m))})]}),t.attending==="no"&&s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:name"),":"]})," ",t.nonAttendingName]}),t.notes&&s.jsxs("p",{children:[s.jsxs("strong",{children:[o("rsvp:messageToBrideGroom"),":"]})," ",t.notes]})]})},"step4")]})},Ke=({submittedRef:e})=>{const{t}=I(["home","common","rsvp"]),[i,r]=h.useState(!1);return h.useEffect(()=>{const n=setTimeout(()=>r(!0),50),d=setInterval(()=>{r(!1),setTimeout(()=>r(!0),55)},1e4);return()=>{clearTimeout(n),clearInterval(d)}},[]),s.jsxs(E.div,{className:"rsvp-page container",ref:e,initial:{opacity:0,scale:.9,y:30},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25,duration:.6}},children:[s.jsx(E.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:20,delay:1},className:"heart-animated",style:{fontSize:"4rem",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:s.jsxs("svg",{viewBox:"0 0 24 24",children:[s.jsx("defs",{children:s.jsx("path",{id:"heart",d:"M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"})}),s.jsx(E.use,{xlinkHref:"#heart",initial:{opacity:0,scale:.33},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:15},style:{transformOrigin:"center"}},i?"on":"off")]})}),s.jsx(E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},style:{textAlign:"center",marginBottom:"1rem"},children:t("rsvp:thankYou")}),s.jsx(E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},style:{textAlign:"center",maxWidth:"500px",margin:"0 auto 2rem",lineHeight:1.6},children:t("rsvp:confirmation")})]})};function ze(e){const t=te(),[i,r]=h.useState(e),[n,d]=h.useState(0),[y,u]=h.useState(null),[v,p]=h.useState(!1),o=["contactAndAttendance","guestsOrName","captcha","review"];return{form:i,setForm:r,currentStep:n,steps:o,error:y,setError:u,hasValidGuests:v,handleChange:x=>{const{name:g,value:S}=x.target;r(_=>({..._,[g]:S})),u(null)},handleGuestsChange:x=>{r(g=>({...g,guests:x})),p(x.some(g=>g.firstName.trim()&&g.lastName.trim()))},nextStep:()=>{t.event("rsvp_step_complete",{event_label:o[n],step_number:n+1,step_name:o[n]}),d(x=>x+1)},prevStep:()=>{t.event("rsvp_step_back",{event_label:o[n],step_number:n+1,step_name:o[n]}),d(x=>x-1)},goToStep:x=>d(x)}}class F{constructor(t=0,i="Network Error"){this.status=t,this.text=i}}const Ye=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},N={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:Ye()},re=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},Je=(e,t="https://api.emailjs.com")=>{if(!e)return;const i=re(e);N.publicKey=i.publicKey,N.blockHeadless=i.blockHeadless,N.storageProvider=i.storageProvider,N.blockList=i.blockList,N.limitRate=i.limitRate,N.origin=i.origin||t},me=async(e,t,i={})=>{const r=await fetch(N.origin+e,{method:"POST",headers:i,body:t}),n=await r.text(),d=new F(r.status,n);if(r.ok)return d;throw d},fe=(e,t,i)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!i||typeof i!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Qe=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},he=e=>e.webdriver||!e.languages||e.languages.length===0,ve=()=>new F(451,"Unavailable For Headless Browser"),Xe=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},Ze=e=>!e.list?.length||!e.watchVariable,et=(e,t)=>e instanceof FormData?e.get(t):e[t],ye=(e,t)=>{if(Ze(e))return!1;Xe(e.list,e.watchVariable);const i=et(t,e.watchVariable);return typeof i!="string"?!1:e.list.includes(i)},ge=()=>new F(403,"Forbidden"),tt=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},rt=async(e,t,i)=>{const r=Number(await i.get(e)||0);return t-Date.now()+r},be=async(e,t,i)=>{if(!t.throttle||!i)return!1;tt(t.throttle,t.id);const r=t.id||e;return await rt(r,t.throttle,i)>0?!0:(await i.set(r,Date.now().toString()),!1)},xe=()=>new F(429,"Too Many Requests"),nt=async(e,t,i,r)=>{const n=re(r),d=n.publicKey||N.publicKey,y=n.blockHeadless||N.blockHeadless,u=n.storageProvider||N.storageProvider,v={...N.blockList,...n.blockList},p={...N.limitRate,...n.limitRate};return y&&he(navigator)?Promise.reject(ve()):(fe(d,e,t),Qe(i),i&&ye(v,i)?Promise.reject(ge()):await be(location.pathname,p,u)?Promise.reject(xe()):me("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:d,service_id:e,template_id:t,template_params:i}),{"Content-type":"application/json"}))},st=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},it=e=>typeof e=="string"?document.querySelector(e):e,at=async(e,t,i,r)=>{const n=re(r),d=n.publicKey||N.publicKey,y=n.blockHeadless||N.blockHeadless,u=N.storageProvider||n.storageProvider,v={...N.blockList,...n.blockList},p={...N.limitRate,...n.limitRate};if(y&&he(navigator))return Promise.reject(ve());const o=it(i);fe(d,e,t),st(o);const a=new FormData(o);return ye(v,a)?Promise.reject(ge()):await be(location.pathname,p,u)?Promise.reject(xe()):(a.append("lib_version","4.4.1"),a.append("service_id",e),a.append("template_id",t),a.append("user_id",d),me("/api/v1.0/email/send-form",a))},_e={init:Je,send:nt,sendForm:at,EmailJSResponseStatus:F};_e.init("gVksEDEDoKBjB0TJU");function ot(e,t,i=0){const r=te(),[n,d]=h.useState(!1),[y,u]=h.useState(!1),[v,p]=h.useState(null),o=async()=>{if(console.log("Submitting RSVP...",{form:e,captchaToken:t}),!t){const a="Please complete reCAPTCHA.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!1});return}if(!e.email){const a="Email is required.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}if(!e.attending){const a="Please indicate if you're attending.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,has_captcha_token:!!t});return}if(e.attending==="yes"&&e.guests.length===0){const a="Please add at least one guest.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}if(e.attending==="no"&&!e.nonAttendingName){const a="Please provide your name.";p(a),r.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:i,attending_status:e.attending,has_captcha_token:!!t});return}d(!0),p(null);try{const a=e.attending==="yes"?e.guests.map((f,j)=>`${j+1}. ${f.firstName} ${f.lastName}`+(f.dietary?` - Dietary: ${f.dietary}`:"")+(f.note?` - Note: ${f.note}`:"")).join(`
`):`Not attending: ${e.nonAttendingName}`,c={email:e.email,attending:e.attending,guestsCount:e.attending==="yes"?e.guests.length:1,guests:a,notes:e.notes||"None",recaptchaToken:t};console.log("Sending email with params:",c);const m=await _e.send("service_vvuhisc","template_4m25aki",c);console.log("EmailJS response:",m),r.event("rsvp_submit_success",{event_label:`RSVP ${e.attending==="yes"?"Accepted":"Declined"}`,attending:e.attending,guest_count:e.attending==="yes"?e.guests.length:1,dietary_requirements:e.guests[0]?.dietary||"none",locale:document.documentElement.lang}),r.event("conversion",{event_label:"RSVP Completed",send_to:"AW-CONVERSION-ID"}),r.event("rsvp_confirmation_view",{event_label:"Viewed confirmation page"}),r.event("page_view",{page_title:"RSVP Confirmation",page_location:window.location.href,page_path:"/rsvp/confirmation"}),u(!0)}catch(a){console.error("Submission error:",a);const c=a?.text||a?.message||"Failed to submit RSVP. Please try again.",m=a?.text?"emailjs_error":"network_error";p(c),r.event("rsvp_submit_error",{event_label:m,error_message:c,error_type:m,current_step:i,attending_status:e.attending,has_captcha_token:!!t}),r.event("exception",{description:`RSVP Error: ${m} - ${c}`,fatal:!1})}finally{d(!1)}};return h.useEffect(()=>{v&&console.error("RSVP Error:",v)},[v]),{submit:o,sending:n,submitted:y,error:v,setError:p,setSubmitted:u}}const ct="6Lcy_mcsAAAAADoT-ibwy1RvePEHG4xJ87D0fdse";let z=!1,$=!1;const yt=we(function(){const{t,ready:i}=I(["home","common","rsvp"]),r=te();Re();const[n,d]=h.useState(!1),[y,u]=h.useState(null),v=h.useRef(null),{form:p,currentStep:o,steps:a,error:c,handleChange:m,handleGuestsChange:f,nextStep:j,prevStep:x,hasValidGuests:g}=ze({email:"",attending:"",guests:[],nonAttendingName:"",notes:"",website:""}),{submit:S,sending:_,submitted:w,error:l,setSubmitted:P}=ot(p,y,o),R=h.useRef(null),L=h.useRef(null),M=h.useRef(null),k=c||l;if(h.useEffect(()=>{z||(r.event("rsvp_start",{event_label:"User started RSVP form"}),z=!0),$=!1;const C=()=>{!w&&!$&&(r.event("rsvp_abandonment",{event_label:`Abandoned at ${a[o]}`,step_number:o+1,step_name:a[o]}),$=!0)};return window.addEventListener("beforeunload",C),()=>{window.removeEventListener("beforeunload",C),v.current&&clearTimeout(v.current),v.current=setTimeout(()=>{!window.location.pathname.includes("/rsvp")&&(!w&&!$&&(r.event("rsvp_abandonment",{event_label:`Abandoned at ${a[o]}`,step_number:o+1,step_name:a[o]}),$=!0),z=!1),v.current=null},100)}},[o,a,w,r]),h.useEffect(()=>d(!0),[]),h.useEffect(()=>{k&&R.current&&(R.current.scrollIntoView({behavior:"smooth",block:"center"}),R.current.focus()),w&&L.current&&L.current.focus()},[k,w]),!i)return s.jsx("div",{className:"loading",children:t("common:loading")});if(w)return s.jsx(Ke,{onReset:()=>P(!1),submittedRef:L});const D=(o+1)/a.length*100,ne=()=>o===0?!p.attending||!p.email:o===1?p.attending==="yes"?!g:!p.nonAttendingName:o===2?!y:!1,je=t("rsvp:steps",{returnObjects:!0}),Se=a.map(C=>je[C])[o];return s.jsxs("div",{className:"rsvp-page container",children:[s.jsx("h1",{children:"RSVP"}),s.jsx("p",{className:"step-description",children:Se}),s.jsx("div",{className:"progress-bar",children:s.jsx("div",{className:"progress-bar-fill",style:{width:`${D}%`}})}),s.jsxs("form",{className:"rsvp-form",onSubmit:C=>C.preventDefault(),children:[s.jsx(We,{currentStep:o,form:p,isClient:n,onChange:m,onGuestsChange:f,captchaToken:y,setCaptchaToken:u,recaptchaRef:M,recaptchaSiteKey:ct,error:k}),k&&s.jsx("div",{className:"rsvp-error",ref:R,role:"alert",tabIndex:-1,children:k}),s.jsxs("div",{className:"form-navigation",children:[s.jsx("button",{type:"button",onClick:x,disabled:o===0,title:t("common:back")||"Back",children:s.jsx(A.Back,{})}),s.jsxs("span",{children:[o+1,"/",a.length]}),o<a.length-1?s.jsx("button",{type:"button",onClick:j,disabled:ne(),title:t("common:next")||"Next",children:s.jsx(A.Next,{})}):s.jsx("button",{type:"button",onClick:S,disabled:_||ne(),children:t(_?"rsvp:sending":"rsvp:submit")})]})]})]})});export{yt as default};
