import{p as L,a,t as q,w as O,v as B}from"./chunk-EPOLDU6W-C9vtjoJn.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{u as W,C as z}from"./Countdown-Bfv8YoBK.js";import{u as b}from"./useTranslation-DvHpW7Xw.js";import{u as T}from"./LanguageContext-BPaMIK5g.js";import{L as V,B as Y,T as H}from"./BackToTopButton-Cj0cupy5.js";import{u as K,R as $}from"./lenis-react-DQp2-cqK.js";import{u as D}from"./useWeddingData-DmPkR6aw.js";import{u as S}from"./LayoutContext-CEUgmXuB.js";import{m as w,A as P,M as C,T as R}from"./Modal-Sal8OyIs.js";import{u as F}from"./ThemeContext-BZ3X1HL9.js";import"./Icon-fSrDZDb7.js";import"./i18next-BDvusv7y.js";function G({locale:u,links:o}){const{buildLink:d}=W(),{t:c}=b(["common"]),s=L(),i=a.useRef(null),[r,p]=a.useState({left:0,top:0,width:0}),[f,h]=a.useState(!1),m=(t=>t.replace(/^\/(en|es)/,"")||"/")(s.pathname),y=m==="/"||m==="",x=t=>{if(!i.current||!t)return;const n=i.current.getBoundingClientRect(),l=t.getBoundingClientRect();p({left:l.left-n.left,top:l.bottom-n.top-3,width:l.width})},v=t=>{h(!0),x(t)},j=()=>h(!1);return a.useEffect(()=>{if(f||!i.current)return;const t=Array.from(i.current.querySelectorAll(".nav-link")),n=o.findIndex(l=>l.path==="/"?y:m===l.path);n!==-1&&x(t[n])},[s.pathname,u,f,o,y,m]),a.useLayoutEffect(()=>{const t=()=>{if(!i.current)return;const n=Array.from(i.current.querySelectorAll(".nav-link")),l=o.findIndex(k=>k.path==="/"?y:m===k.path);l!==-1&&x(n[l])};return window.addEventListener("resize",t),t(),()=>window.removeEventListener("resize",t)},[o,y,m]),e.jsx("nav",{className:"nav",children:e.jsxs("div",{className:"nav-links desktop",ref:i,children:[o.map(t=>e.jsx(q,{to:d(t.path),className:"nav-link",ref:n=>{},onMouseEnter:n=>v(n.currentTarget),onMouseLeave:j,children:t.label},t.path)),e.jsx("div",{className:"nav-indicator",style:{transform:`translate(${r.left}px)`,width:r.width}})]})})}const J=({openCookieConsentModal:u})=>{const o=L(),{locale:d}=T(),{state:{fixedOffsetY:c}}=S(),s=D(),{t:i}=b(),r=o.pathname==="/"||o.pathname===""||o.pathname===`/${d}`;if(!s?.wedding)return null;const{date:p}=s.wedding,{time:f}=s.wedding.ceremony,h=Math.max(20,-c+20);return e.jsx(w.footer,{className:"footer",animate:{paddingBottom:`${h}px`,opacity:1,y:0},initial:{opacity:0,y:20,paddingBottom:"20px"},transition:{paddingBottom:{type:"spring",stiffness:300,damping:30},opacity:{duration:.4},y:{duration:.4}},children:e.jsxs("div",{className:"footer-content",children:[!r&&e.jsx(z,{size:"sm",date:p,time:f}),e.jsx("button",{onClick:u,className:"footer__cookie-btn",children:i("common:change_cookie_preferences","See cookie Preferences.")})]})})};function Q({isOpen:u,onClose:o,children:d,autoClose:c=3e3}){const s=a.useRef(null);a.useEffect(()=>(s.current&&(clearTimeout(s.current),s.current=null),u&&c&&(s.current=setTimeout(()=>{o(),s.current=null},c)),()=>{s.current&&(clearTimeout(s.current),s.current=null)}),[u,c,o]);const i={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95}};return e.jsx(P,{children:u&&e.jsx(w.div,{className:"toast-wrapper",variants:i,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.4,ease:"easeInOut"},children:e.jsx("div",{className:"toast-content",children:d})})})}function M(){return e.jsx("span",{className:"wave-emoji",role:"img","aria-label":"waving hand",children:"ðŸ‘‹"})}const _=[{key:"necessary",label:"Necessary cookies (required)",required:!0},{key:"analytics",label:"Analytics cookies"},{key:"personalization",label:"Personalization cookies"}];function U({isOpen:u,onClose:o,mode:d="first_visit"}){const{visitor:c,cookiePreference:s,setCookiePreference:i}=F(),{t:r}=b(["home","common"]),[p,f]=a.useState(()=>_.reduce((t,n)=>(t[n.key]=n.required?!0:s?.[n.key]??!1,t),{})),h=p.personalization===!0,[g,m]=a.useState(d==="change_preferences"||s===null);if(a.useEffect(()=>{u&&(f(_.reduce((t,n)=>(t[n.key]=n.required?!0:s?.[n.key]??!1,t),{})),m(d==="change_preferences"||s===null))},[u,s,d]),!c)return e.jsx(C,{isOpen:u,onClose:o,children:e.jsx("p",{className:"ccm__loading",children:r("common:loading","Loading...")})});const y=()=>{i(p),o()},x=()=>{const t=_.reduce((n,l)=>(n[l.key]=!0,n),{});f(t),i(t),o()},v=()=>{const t=_.reduce((n,l)=>(n[l.key]=!!l.required,n),{});f(t),i(t),o()},j=()=>h?d!=="first_visit"?r("common:change_preferences_prompt","Change your preferences to improve your experience."):c.isFirstVisit?e.jsxs(R,{i18nKey:"home:welcome_first_visit",components:{emoji:e.jsx(M,{})},children:["Welcome to our wedding website! ",e.jsx("emoji",{})]}):c.daysSinceLastVisit===0?e.jsxs(R,{i18nKey:"home:welcome_back_today",components:{emoji:e.jsx(M,{})},children:["Welcome back! ",e.jsx("emoji",{})]}):c.daysSinceLastVisit===1?r("home:welcome_back_yesterday","Great to see you again! You were here yesterday."):c.daysSinceLastVisit<7?r("home:welcome_back_days","Welcome back! It's been {{days}} days since your last visit.",{days:c.daysSinceLastVisit}):r("home:welcome_back_long_time","Welcome back! We've missed you! It's been {{days}} days.",{days:c.daysSinceLastVisit}):r("common:welcome_generic","Welcome to our wedding website!");return s&&d==="first_visit"?e.jsx(Q,{isOpen:u,onClose:o,autoClose:3e3,children:e.jsx("p",{className:"ccm__greeting",children:j()})}):e.jsx(C,{isOpen:u,onClose:o,children:e.jsxs("div",{className:"ccm",children:[e.jsx("button",{className:"ccm__close",onClick:o,"aria-label":r("common:close","Close modal"),children:"Ã—"}),e.jsx("p",{className:"ccm__greeting",children:j()}),g?e.jsxs("div",{className:"ccm__preferences",id:"cookie-preferences",children:[e.jsx("p",{className:"ccm__intro",children:r("common:cookie_intro","We use cookies to improve your experience. You can choose which types of cookies you allow:")}),e.jsx("div",{className:"ccm__checkboxes",children:_.map(t=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:p[t.key],disabled:t.required,onChange:n=>f({...p,[t.key]:n.target.checked})}),t.label]},t.key))}),e.jsxs("div",{className:"ccm__actions",children:[e.jsx("button",{className:"ccm__save-btn",onClick:y,children:r("common:save_preferences","Save Preferences")}),e.jsx("button",{className:"ccm__accept-all-btn",onClick:x,children:r("common:accept_all","Accept All")}),e.jsx("button",{className:"ccm__reject-all-btn",onClick:v,children:r("common:reject_all","Reject All")})]})]}):e.jsx("button",{className:"ccm__toggle-btn",onClick:()=>m(!0),children:r("common:show_preferences","Show Preferences")})]})})}const de=O(function(){const o=L(),d=B(),[c,s]=a.useTransition(),{locale:i,switchLanguage:r}=T(),[p,f]=a.useState(!1),{t:h}=b(["common"]),g=a.useRef(null),[m,y]=a.useState("first_visit"),[x,v]=a.useState(!0),j=a.useRef(null),t=S(),n=K(()=>{}),{state:{fixedOffsetY:l}}=S(),k=a.useRef(!1);a.useEffect(()=>{if(!n||k.current)return;k.current=!0;const N=setTimeout(()=>{n.scrollTo(0,{immediate:!0})},400);return()=>{clearTimeout(N),k.current=!1}},[o.pathname,n]);const E=[{path:"/",label:h("nav.home")},{path:"/rsvp",label:h("nav.rsvp")},{path:"/schedule",label:h("nav.schedule")},{path:"/qa",label:h("nav.qa")}],A=()=>{y("change_preferences"),v(!0)},I=()=>{v(!1)};return a.useEffect(()=>{console.log("cookieConsentModalMode",m),x||y("first_visit")},[m]),a.useEffect(()=>{j.current&&j.current.style.setProperty("--y-offset",t.state.fixedOffsetY*-1+"px")},[t.state.fixedOffsetY]),e.jsxs($,{root:!0,options:{prevent:N=>N.closest(".search-dropdown__list")!==null},children:[e.jsx(U,{isOpen:x,onClose:I,mode:m}),e.jsxs("div",{className:"container",children:[e.jsx(G,{menuOpen:p,setMenuOpen:f,locale:i,links:E,onLanguageSwitch:()=>s(r),isPending:c,hamburgerRef:g}),e.jsxs("main",{className:"main",ref:j,children:[e.jsx(P,{mode:"wait",children:e.jsx(w.div,{className:"page-content",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},children:d},o.pathname)}),e.jsxs(w.div,{className:"fixed-container",animate:{y:l},transition:{type:"spring",stiffness:300,damping:30},children:[e.jsx(V,{currentLocale:i,onSwitch:r,isPending:c}),e.jsxs("div",{className:"group",children:[e.jsx(Y,{onClick:()=>n?.scrollTo(0,{duration:1})}),e.jsx(H,{})]})]}),e.jsx(J,{openCookieConsentModal:A})]})]})]})});export{de as default};
