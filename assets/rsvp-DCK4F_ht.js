import{y as ke,a as p,R as Me,w as qe,p as De}from"./chunk-EPOLDU6W-C9vtjoJn.js";import{j as t}from"./jsx-runtime-u17CrQMm.js";import{I}from"./Icon-CNAYQKQe.js";import{m as C,A as ee,M as Fe}from"./Modal-BKgDBMIL.js";import{u as Y}from"./useTranslation-DvHpW7Xw.js";import{u as Ue}from"./LanguageContext-BPaMIK5g.js";import{u as he}from"./AnalyticsContext-qLPwaGr0.js";var re={exports:{}},ae,ge;function Ve(){if(ge)return ae;ge=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ae=e,ae}var ne,be;function He(){if(be)return ne;be=1;var e=Ve();function r(){}function n(){}return n.resetWarningCache=r,ne=function(){function s(b,f,g,d,o,a){if(a!==e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}s.isRequired=s;function i(){return s}var m={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:i,element:s,elementType:s,instanceOf:i,node:s,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:r};return m.PropTypes=m,m},ne}var xe;function Be(){return xe||(xe=1,re.exports=He()()),re.exports}var Ge=Be();const $=ke(Ge);var Ke=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ce.apply(this,arguments)}function ze(e,r){if(e==null)return{};var n={},s=Object.keys(e),i,m;for(m=0;m<s.length;m++)i=s[m],!(r.indexOf(i)>=0)&&(n[i]=e[i]);return n}function Z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function We(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,le(e,r)}function le(e,r){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},le(e,r)}var te=(function(e){We(r,e);function r(){var s;return s=e.call(this)||this,s.handleExpired=s.handleExpired.bind(Z(s)),s.handleErrored=s.handleErrored.bind(Z(s)),s.handleChange=s.handleChange.bind(Z(s)),s.handleRecaptchaRef=s.handleRecaptchaRef.bind(Z(s)),s}var n=r.prototype;return n.getCaptchaFunction=function(i){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[i]:this.props.grecaptcha[i]:null},n.getValue=function(){var i=this.getCaptchaFunction("getResponse");return i&&this._widgetId!==void 0?i(this._widgetId):null},n.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},n.execute=function(){var i=this.getCaptchaFunction("execute");if(i&&this._widgetId!==void 0)return i(this._widgetId);this._executeRequested=!0},n.executeAsync=function(){var i=this;return new Promise(function(m,b){i.executionResolve=m,i.executionReject=b,i.execute()})},n.reset=function(){var i=this.getCaptchaFunction("reset");i&&this._widgetId!==void 0&&i(this._widgetId)},n.forceReset=function(){var i=this.getCaptchaFunction("reset");i&&i()},n.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},n.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},n.handleChange=function(i){this.props.onChange&&this.props.onChange(i),this.executionResolve&&(this.executionResolve(i),delete this.executionReject,delete this.executionResolve)},n.explicitRender=function(){var i=this.getCaptchaFunction("render");if(i&&this._widgetId===void 0){var m=document.createElement("div");this._widgetId=i(m,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(m)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},n.componentDidMount=function(){this.explicitRender()},n.componentDidUpdate=function(){this.explicitRender()},n.handleRecaptchaRef=function(i){this.captcha=i},n.render=function(){var i=this.props;i.sitekey,i.onChange,i.theme,i.type,i.tabindex,i.onExpired,i.onErrored,i.size,i.stoken,i.grecaptcha,i.badge,i.hl,i.isolated;var m=ze(i,Ke);return p.createElement("div",ce({},m,{ref:this.handleRecaptchaRef}))},r})(p.Component);te.displayName="ReCAPTCHA";te.propTypes={sitekey:$.string.isRequired,onChange:$.func,grecaptcha:$.object,theme:$.oneOf(["dark","light"]),type:$.oneOf(["image","audio"]),tabindex:$.number,onExpired:$.func,onErrored:$.func,size:$.oneOf(["compact","normal","invisible"]),stoken:$.string,hl:$.string,badge:$.oneOf(["bottomright","bottomleft","inline"]),isolated:$.bool};te.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var se={exports:{}},j={};var _e;function Ye(){if(_e)return j;_e=1;var e=typeof Symbol=="function"&&Symbol.for,r=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,i=e?Symbol.for("react.strict_mode"):60108,m=e?Symbol.for("react.profiler"):60114,b=e?Symbol.for("react.provider"):60109,f=e?Symbol.for("react.context"):60110,g=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,o=e?Symbol.for("react.forward_ref"):60112,a=e?Symbol.for("react.suspense"):60113,u=e?Symbol.for("react.suspense_list"):60120,v=e?Symbol.for("react.memo"):60115,N=e?Symbol.for("react.lazy"):60116,w=e?Symbol.for("react.block"):60121,T=e?Symbol.for("react.fundamental"):60117,x=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function h(c){if(typeof c=="object"&&c!==null){var S=c.$$typeof;switch(S){case r:switch(c=c.type,c){case g:case d:case s:case m:case i:case a:return c;default:switch(c=c&&c.$$typeof,c){case f:case o:case N:case v:case b:return c;default:return S}}case n:return S}}}function R(c){return h(c)===d}return j.AsyncMode=g,j.ConcurrentMode=d,j.ContextConsumer=f,j.ContextProvider=b,j.Element=r,j.ForwardRef=o,j.Fragment=s,j.Lazy=N,j.Memo=v,j.Portal=n,j.Profiler=m,j.StrictMode=i,j.Suspense=a,j.isAsyncMode=function(c){return R(c)||h(c)===g},j.isConcurrentMode=R,j.isContextConsumer=function(c){return h(c)===f},j.isContextProvider=function(c){return h(c)===b},j.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===r},j.isForwardRef=function(c){return h(c)===o},j.isFragment=function(c){return h(c)===s},j.isLazy=function(c){return h(c)===N},j.isMemo=function(c){return h(c)===v},j.isPortal=function(c){return h(c)===n},j.isProfiler=function(c){return h(c)===m},j.isStrictMode=function(c){return h(c)===i},j.isSuspense=function(c){return h(c)===a},j.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===s||c===d||c===m||c===i||c===a||c===u||typeof c=="object"&&c!==null&&(c.$$typeof===N||c.$$typeof===v||c.$$typeof===b||c.$$typeof===f||c.$$typeof===o||c.$$typeof===T||c.$$typeof===x||c.$$typeof===y||c.$$typeof===w)},j.typeOf=h,j}var Ne;function Je(){return Ne||(Ne=1,se.exports=Ye()),se.exports}var ie,je;function Qe(){if(je)return ie;je=1;var e=Je(),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},m={};m[e.ForwardRef]=s,m[e.Memo]=i;function b(N){return e.isMemo(N)?i:m[N.$$typeof]||r}var f=Object.defineProperty,g=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,o=Object.getOwnPropertyDescriptor,a=Object.getPrototypeOf,u=Object.prototype;function v(N,w,T){if(typeof w!="string"){if(u){var x=a(w);x&&x!==u&&v(N,x,T)}var y=g(w);d&&(y=y.concat(d(w)));for(var h=b(N),R=b(w),c=0;c<y.length;++c){var S=y[c];if(!n[S]&&!(T&&T[S])&&!(R&&R[S])&&!(h&&h[S])){var k=o(w,S);try{f(N,S,k)}catch{}}}}return N}return ie=v,ie}var Xe=Qe();const Ze=ke(Xe);function de(){return de=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},de.apply(this,arguments)}function et(e,r){if(e==null)return{};var n={},s=Object.keys(e),i,m;for(m=0;m<s.length;m++)i=s[m],!(r.indexOf(i)>=0)&&(n[i]=e[i]);return n}function tt(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r}var D={},rt=0;function at(e,r){return r=r||{},function(s){var i=s.displayName||s.name||"Component",m=(function(f){tt(g,f);function g(o,a){var u;return u=f.call(this,o,a)||this,u.state={},u.__scriptURL="",u}var d=g.prototype;return d.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+rt++),this.__scriptLoaderID},d.setupScriptURL=function(){return this.__scriptURL=typeof e=="function"?e():e,this.__scriptURL},d.asyncScriptLoaderHandleLoad=function(a){var u=this;this.setState(a,function(){return u.props.asyncScriptOnLoad&&u.props.asyncScriptOnLoad(u.state)})},d.asyncScriptLoaderTriggerOnScriptLoaded=function(){var a=D[this.__scriptURL];if(!a||!a.loaded)throw new Error("Script is not loaded.");for(var u in a.observers)a.observers[u](a);delete window[r.callbackName]},d.componentDidMount=function(){var a=this,u=this.setupScriptURL(),v=this.asyncScriptLoaderGetScriptLoaderID(),N=r,w=N.globalName,T=N.callbackName,x=N.scriptId;if(w&&typeof window[w]<"u"&&(D[u]={loaded:!0,observers:{}}),D[u]){var y=D[u];if(y&&(y.loaded||y.errored)){this.asyncScriptLoaderHandleLoad(y);return}y.observers[v]=function(k){return a.asyncScriptLoaderHandleLoad(k)};return}var h={};h[v]=function(k){return a.asyncScriptLoaderHandleLoad(k)},D[u]={loaded:!1,observers:h};var R=document.createElement("script");R.src=u,R.async=!0;for(var c in r.attributes)R.setAttribute(c,r.attributes[c]);x&&(R.id=x);var S=function(E){if(D[u]){var _=D[u],A=_.observers;for(var O in A)E(A[O])&&delete A[O]}};T&&typeof window<"u"&&(window[T]=function(){return a.asyncScriptLoaderTriggerOnScriptLoaded()}),R.onload=function(){var k=D[u];k&&(k.loaded=!0,S(function(E){return T?!1:(E(k),!0)}))},R.onerror=function(){var k=D[u];k&&(k.errored=!0,S(function(E){return E(k),!0}))},document.body.appendChild(R)},d.componentWillUnmount=function(){var a=this.__scriptURL;if(r.removeOnUnmount===!0)for(var u=document.getElementsByTagName("script"),v=0;v<u.length;v+=1)u[v].src.indexOf(a)>-1&&u[v].parentNode&&u[v].parentNode.removeChild(u[v]);var N=D[a];N&&(delete N.observers[this.asyncScriptLoaderGetScriptLoaderID()],r.removeOnUnmount===!0&&delete D[a])},d.render=function(){var a=r.globalName,u=this.props;u.asyncScriptOnLoad;var v=u.forwardedRef,N=et(u,["asyncScriptOnLoad","forwardedRef"]);return a&&typeof window<"u"&&(N[a]=typeof window[a]<"u"?window[a]:void 0),N.ref=v,p.createElement(s,N)},g})(p.Component),b=p.forwardRef(function(f,g){return p.createElement(m,de({},f,{forwardedRef:g}))});return b.displayName="AsyncScriptLoader("+i+")",b.propTypes={asyncScriptOnLoad:$.func},Ze(b,s)}}var ue="onloadcallback",nt="grecaptcha";function pe(){return typeof window<"u"&&window.recaptchaOptions||{}}function st(){var e=pe(),r=e.useRecaptchaNet?"recaptcha.net":"www.google.com";return e.enterprise?"https://"+r+"/recaptcha/enterprise.js?onload="+ue+"&render=explicit":"https://"+r+"/recaptcha/api.js?onload="+ue+"&render=explicit"}const it=at(st,{callbackName:ue,globalName:nt,attributes:pe().nonce?{nonce:pe().nonce}:{}})(te),we=({index:e,guest:r,onUpdate:n,onRemove:s,onConfirm:i,isDraft:m=!1,isRostered:b=!1})=>{const{t:f}=Y(["rsvp"]),[g,d]=p.useState(!1),[o,a]=p.useState(!1),[u,v]=p.useState(!1),[N,w]=p.useState(!1),T=p.useRef(null),x=r.firstName.trim()&&r.lastName.trim(),y=_=>_.replace(/[^a-zA-ZÀ-ÿ\s'-]/g,""),h=(_,A)=>_.slice(0,A),R=_=>_.charAt(0).toUpperCase()+_.slice(1),c=(_,A)=>{const O=h(y(R(A)),30);n?.(e,_,O)},S=(_,A,O)=>{const F=O?h(A,O):A;n?.(e,_,F)},k=()=>{if(!x){v(!0);return}i&&i(),v(!1),d(!1),a(!1),setTimeout(()=>T.current?.focus(),0)},E=_=>{m&&_.key==="Enter"&&!(_.target instanceof HTMLTextAreaElement)&&(_.preventDefault(),k())};return p.useEffect(()=>{r.dietary&&d(!0),r.note&&a(!0)},[r.dietary,r.note]),t.jsxs(t.Fragment,{children:[t.jsxs(C.div,{className:`guest-card ${u&&!x?"invalid":""}`,onKeyDown:E,layout:"position",initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{type:"spring",stiffness:400,damping:30,layout:{type:"spring",stiffness:500}},children:[t.jsxs("div",{className:"inputs-container",children:[t.jsxs("div",{className:"form-row",children:[t.jsx("input",{ref:T,type:"text",name:"firstName",placeholder:f("rsvp:firstName"),value:r.firstName,onChange:_=>c("firstName",_.target.value),maxLength:30}),t.jsx("input",{type:"text",name:"lastName",placeholder:f("rsvp:lastName"),value:r.lastName,onChange:_=>c("lastName",_.target.value),maxLength:30})]}),t.jsxs(ee,{children:[g&&t.jsxs(C.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[t.jsx("input",{type:"text",placeholder:f("rsvp:dietaryPlaceholder"),value:r.dietary,onChange:_=>S("dietary",_.target.value,100),maxLength:100}),t.jsx("button",{type:"button",className:"close-btn",onClick:()=>d(!1),children:"×"})]}),o&&t.jsxs(C.div,{className:"form-row",initial:{opacity:0,scaleY:.8,originY:0},animate:{opacity:1,scaleY:1,transition:{type:"spring",stiffness:400,damping:30}},exit:{opacity:0,scaleY:.8,transition:{duration:.15}},children:[t.jsx("textarea",{placeholder:f("rsvp:notePlaceholder"),value:r.note||"",onChange:_=>S("note",_.target.value,200),maxLength:200}),t.jsx("button",{type:"button",className:"close-btn",onClick:()=>a(!1),children:"×"})]})]})]}),t.jsx("div",{className:"guest-card-actions",children:m?t.jsx(C.button,{type:"button",className:"form-btn add-guest-btn",onClick:k,whileHover:{scale:1.02},title:f("rsvp:addGuest"),"aria-label":f("rsvp:addGuest"),children:t.jsx(I.Add,{})}):t.jsxs(t.Fragment,{children:[!g&&t.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>d(!0),title:f("rsvp:addDietary"),"aria-label":f("rsvp:addDietary"),children:t.jsx(I.Food,{})}),!o&&t.jsx("button",{type:"button",className:"three-dots-btn",onClick:()=>a(!0),title:f("rsvp:addNote"),"aria-label":f("rsvp:addNote"),children:t.jsx(I.Note,{})}),t.jsx("button",{type:"button",className:"remove-guest",onClick:()=>w(!0),"aria-label":f("rsvp:removeGuestConfirm",{name:`${r.firstName} ${r.lastName}`}),children:t.jsx(I.Close,{})})]})})]}),t.jsx(Fe,{isOpen:N,onClose:()=>w(!1),closeOnBackdropClick:!0,showCloseButton:!1,children:t.jsxs("div",{className:"confirm-modal",children:[t.jsx("p",{children:f("rsvp:removeGuestConfirm",{name:`${r.firstName} ${r.lastName}`})}),t.jsxs("div",{className:"confirm-modal-actions",children:[t.jsx("button",{type:"button",className:"button",onClick:()=>w(!1),children:f("rsvp:cancel")}),t.jsx("button",{type:"button",className:"button button--danger",onClick:()=>{s?.(e),w(!1)},children:f("rsvp:remove")})]})]})})]})},Se={firstName:"",lastName:"",dietary:"",note:""},ot=({guests:e,onGuestsChange:r})=>{const{t:n}=Y(["rsvp"]),[s,i]=p.useState(Se),m=p.useCallback(()=>{!s.firstName.trim()||!s.lastName.trim()||(r([...e,s]),i(Se))},[s,e,r]),b=p.useCallback(d=>{r(e.filter((o,a)=>a!==d))},[e,r]),f=p.useCallback((d,o,a)=>{r(e.map((u,v)=>v===d?{...u,[o]:a}:u))},[e,r]),g=p.useCallback((d,o)=>{i(a=>({...a,[d]:o}))},[]);return t.jsxs("div",{className:"guests-section","aria-label":n("rsvp:guestsTitle"),children:[t.jsx(ee,{children:e.map((d,o)=>t.jsx(we,{index:o,guest:d,onUpdate:f,onRemove:b,isRostered:!0},`roster-${o}`))}),e.length>0&&t.jsx(C.p,{className:"add-another-label",initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},children:n("rsvp:addAnotherGuest")}),t.jsx(we,{index:e.length,guest:s,onUpdate:(d,o,a)=>g(o,a),onConfirm:m,isDraft:!0},"draft")]})},K={song:null,url:null,currentTime:0,duration:0,isTransitioning:!1},ct="https://placehold.co/100x100?text=♪",B=10,lt=400,dt=({musicRequests:e=[],onChange:r})=>{const[n,s]=p.useState(""),[i,m]=p.useState(""),[b,f]=p.useState([]),[g,d]=p.useState(!1),[o,a]=p.useState(K),[u,v]=p.useState(null),[N,w]=p.useState(!1),[T,x]=p.useState(""),[y,h]=p.useState(""),[R,c]=p.useState(!1),S=p.useRef(null),k=p.useRef(),E=p.useRef(),_=p.useMemo(()=>new Set(e.map(l=>`${l.trackName}-${l.artistName}`)),[e]),A=e.length<B,O=e.length>=B,F=p.useCallback(l=>{const P=Math.floor(l/60).toString().padStart(2,"0"),M=Math.floor(l%60).toString().padStart(2,"0");return`${P}:${M}`},[]);p.useEffect(()=>{const l=new Audio;S.current=l;const P=()=>{a(G=>({...G,duration:l.duration,isTransitioning:!1}))},M=()=>{a(G=>({...G,currentTime:l.currentTime}))},q=()=>{a(K)},H=G=>{console.error("Audio error:",G),a(K),v("Failed to play preview"),setTimeout(()=>v(null),5e3)};return l.addEventListener("loadedmetadata",P),l.addEventListener("timeupdate",M),l.addEventListener("ended",q),l.addEventListener("error",H),()=>{l.pause(),l.src="",l.load(),l.removeEventListener("loadedmetadata",P),l.removeEventListener("timeupdate",M),l.removeEventListener("ended",q),l.removeEventListener("error",H),S.current=null}},[]);const U=p.useCallback(()=>{S.current&&(S.current.pause(),S.current.currentTime=0),a(K)},[]);p.useEffect(()=>{c(o.song!==null)},[o.song]),p.useEffect(()=>()=>{k.current&&clearTimeout(k.current),E.current&&E.current.abort()},[]),p.useEffect(()=>{const l=`${n} ${i}`.trim();if(k.current&&clearTimeout(k.current),E.current&&E.current.abort(),!l){f([]),v(null);return}return d(!0),v(null),E.current=new AbortController,k.current=setTimeout(async()=>{try{const P=await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(l)}&entity=song&limit=20`,{signal:E.current?.signal});if(!P.ok)throw new Error("Failed to fetch songs");const M=await P.json();f(M.results?.map(q=>({trackName:q.trackName,artistName:q.artistName,artworkUrl100:q.artworkUrl100,previewUrl:q.previewUrl}))||[]),M.results?.length===0&&v("No songs found. Try a different search.")}catch(P){P.name!=="AbortError"&&v("Failed to search. Please try again.")}finally{d(!1)}},lt),()=>{k.current&&clearTimeout(k.current)}},[n,i]);const Q=p.useCallback(l=>{if(!(!l.previewUrl||!S.current)){if(o.url===l.previewUrl){U();return}S.current.pause(),S.current.src=l.previewUrl,S.current.load(),a({song:l,url:l.previewUrl,currentTime:0,duration:0,isTransitioning:!0}),S.current.play().catch(P=>{console.error("Playback failed:",P),a(K),v("Failed to play preview"),setTimeout(()=>v(null),5e3)})}},[o.url,U]),X=p.useCallback(l=>{!_.has(`${l.trackName}-${l.artistName}`)&&A&&r([...e,l].slice(0,B))},[_,A,e,r]),V=p.useCallback(()=>{if(!T.trim()||!y.trim()||!A)return;const l={trackName:T.trim(),artistName:y.trim(),artworkUrl100:ct};_.has(`${l.trackName}-${l.artistName}`)||r([...e,l].slice(0,B)),x(""),h(""),w(!1)},[T,y,A,_,e,r]),ve=p.useCallback(l=>{const P=[...e],M=P[l];P.splice(l,1),r(P),o.url===M?.previewUrl&&U()},[e,r,o.url,U]),Ie=p.useCallback(()=>{s(""),m(""),U()},[U]),ye=o.duration>0?o.currentTime/o.duration*100:0;return t.jsxs("div",{className:"music-request-manager",children:[e.length>0&&t.jsxs("div",{className:"added-songs-section",children:[t.jsx("div",{className:"added-songs-header",children:t.jsxs("span",{className:"song-count",children:[e.length," / ",B," songs"]})}),t.jsx("ul",{className:"added-songs-list",children:e.map((l,P)=>t.jsxs("li",{className:"added-song-item",children:[t.jsxs("div",{className:"song-info",children:[t.jsx("img",{src:l.artworkUrl100,alt:`${l.trackName} album art`,className:"song-artwork-small",loading:"lazy"}),t.jsxs("div",{className:"song-text",children:[t.jsx("span",{className:"song-name",children:l.trackName}),t.jsx("span",{className:"artist-name",children:l.artistName})]})]}),t.jsxs("div",{className:"song-actions",children:[l.previewUrl&&t.jsx("button",{onClick:()=>Q(l),className:"play-btn-small","aria-label":o.url===l.previewUrl?"Stop preview":"Play preview",children:o.url===l.previewUrl?t.jsx(I.Stop,{}):t.jsx(I.Play,{})}),t.jsx("button",{onClick:()=>ve(P),className:"remove-btn","aria-label":`Remove ${l.trackName}`,children:"✕"})]})]},`${l.trackName}-${l.artistName}-${P}`))})]}),t.jsxs("div",{className:"search-inputs",children:[t.jsx("input",{type:"text",value:n,onChange:l=>s(l.target.value),placeholder:"Search by song title",className:"form-input","aria-label":"Song title"}),t.jsx("input",{type:"text",value:i,onChange:l=>m(l.target.value),placeholder:"Search by artist",className:"form-input","aria-label":"Artist name"}),t.jsx("button",{onClick:Ie,children:"Clear"})]}),g&&t.jsx("div",{role:"status","aria-live":"polite",className:"searching-status",children:"Searching..."}),u&&t.jsx("div",{role:"alert",className:"search-error",children:u}),b.length>0&&t.jsx("ul",{className:"suggestions-list",role:"list",children:b.map((l,P)=>{const M=`${l.trackName}-${l.artistName}`,q=_.has(M),H=o.url===l.previewUrl;return t.jsxs("li",{className:"suggestion-item",children:[t.jsxs("div",{className:"left-controls",children:[t.jsx("img",{src:l.artworkUrl100,alt:"",className:"album-grayscale",style:{filter:"grayscale(100%)"},loading:"lazy"}),t.jsx("img",{src:l.artworkUrl100,alt:`${l.trackName} album art`,className:"album-color",loading:"lazy"}),l.previewUrl&&t.jsx("button",{onClick:()=>Q(l),className:`play-btn ${H?"playing":""}`,"aria-label":H?`Stop preview of ${l.trackName}`:`Play preview of ${l.trackName}`,children:H?t.jsx(I.Stop,{}):t.jsx(I.Play,{})})]}),t.jsxs("div",{className:"suggestion-info",children:[t.jsx("div",{children:t.jsx("strong",{children:l.trackName})}),t.jsx("div",{children:t.jsx("em",{children:l.artistName})}),H&&o.duration>0&&t.jsxs("div",{className:"playback-time","aria-live":"polite",children:[F(o.currentTime)," /"," ",F(o.duration)]})]}),t.jsx("button",{onClick:()=>X(l),className:"add-btn",disabled:q||!A,"aria-label":q?`${l.trackName} already added`:`Add ${l.trackName} to requests`,children:q?t.jsx(I.Tick,{}):t.jsx(I.Add,{})})]},`${M}-${P}`)})}),O&&t.jsxs("div",{className:"limit-message",role:"status",children:["Maximum of ",B," songs reached. Remove a song to add more."]}),(n||i)&&A&&t.jsx("div",{className:"manual-entry-section",children:N?t.jsxs("div",{className:"manual-entry-form",children:[t.jsx("input",{type:"text",value:T,onChange:l=>x(l.target.value),placeholder:"Song title",className:"form-input","aria-label":"Manual song title",onKeyDown:l=>{l.key==="Enter"&&V()}}),t.jsx("input",{type:"text",value:y,onChange:l=>h(l.target.value),placeholder:"Artist name",className:"form-input","aria-label":"Manual artist name",onKeyDown:l=>{l.key==="Enter"&&V()}}),t.jsxs("div",{className:"manual-entry-actions",children:[t.jsx("button",{type:"button",className:"button",onClick:()=>{w(!1),x(""),h("")},children:"Cancel"}),t.jsx("button",{type:"button",className:"button button--primary",onClick:V,disabled:!T.trim()||!y.trim(),children:"Add Song"})]})]}):t.jsx("button",{type:"button",className:"manual-entry-toggle",onClick:()=>w(!0),children:"Can't find your song? Add it manually"})}),t.jsx(ee,{mode:"wait",children:R&&o.song&&t.jsxs(C.div,{className:"mini-player",role:"region","aria-label":"Now playing",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",stiffness:400,damping:30},children:[t.jsx(C.img,{src:o.song.artworkUrl100,alt:`${o.song.trackName} album art`,className:"mini-player__artwork",initial:{opacity:0},animate:{opacity:1},transition:{duration:.15},loading:"lazy"},o.song.artworkUrl100),t.jsxs("div",{className:"mini-player__info",children:[t.jsx(C.span,{className:"mini-player__track",initial:{opacity:0,x:6},animate:{opacity:1,x:0},transition:{duration:.15},children:o.song.trackName},`track-${o.song.trackName}`),t.jsx(C.span,{className:"mini-player__artist",initial:{opacity:0,x:6},animate:{opacity:1,x:0},transition:{duration:.15,delay:.03},children:o.song.artistName},`artist-${o.song.artistName}`),t.jsx("div",{className:"mini-player__progress-bar",role:"progressbar","aria-valuenow":ye,"aria-valuemin":0,"aria-valuemax":100,children:t.jsx("div",{className:"mini-player__progress-fill",style:{width:`${ye}%`}})}),t.jsxs("span",{className:"mini-player__time",children:[F(o.currentTime)," / ",F(o.duration)]})]}),t.jsx("button",{className:"mini-player__stop",onClick:U,"aria-label":"Stop preview",children:t.jsx(I.Stop,{})})]},o.url)})]})},ut=Me.memo(dt),pt=/^[\w\-.]+@([\w-]+\.)+[\w-]{2,4}$/,mt=/[^\w\-+.@]/,ht=/[^\w\-+.@]/g,z={initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}},ft=({currentStep:e,currentStepObj:r,form:n,isClient:s,onChange:i,onGuestsChange:m,captchaToken:b,error:f,recaptchaRef:g,setCaptchaToken:d})=>{const{locale:o}=Ue(),{t:a}=Y(["home","common","rsvp"]),[u,v]=p.useState(!1),w=u?(h=>h.trim()?pt.test(h)?null:a("rsvp:errors.invalidEmail"):a("rsvp:errors.required"))(n.email):null,T=u&&!w&&n.email.trim()!=="",x=h=>{h.key.length===1&&mt.test(h.key)&&h.preventDefault()},y=h=>{h.target.value=h.target.value.replace(ht,"").toLowerCase(),i(h)};return t.jsxs(ee,{mode:"wait",children:[e===0&&t.jsxs(C.div,{variants:z,initial:"initial",animate:"animate",exit:"exit",className:"form-content",tabIndex:-1,children:[t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{htmlFor:"email",children:[a("rsvp:email")," ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{id:"email",name:"email",type:"email",value:n.email,onKeyDown:x,onChange:y,onBlur:()=>v(!0),className:`form-input ${w?"form-input-invalid":T?"form-input-valid":""}`,required:!0,autoComplete:"email",tabIndex:0}),w&&t.jsx("div",{className:"field-error",children:w})]}),t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{htmlFor:"attending",children:[a("rsvp:attending")," ",t.jsx("span",{className:"required",children:"*"})]}),t.jsxs("select",{id:"attending",name:"attending",value:n.attending,onChange:i,className:`form-input ${n.attending?"form-input-valid":""}`,required:!0,autoComplete:"off",tabIndex:0,children:[t.jsx("option",{value:"",children:a("rsvp:select")}),t.jsx("option",{value:"yes",children:a("rsvp:yes")}),t.jsx("option",{value:"no",children:a("rsvp:no")})]})]})]},"step0"),e===1&&t.jsx(C.div,{variants:z,initial:"initial",animate:"animate",exit:"exit",className:"form-content",tabIndex:-1,children:n.attending==="yes"?t.jsx(ot,{guests:n.guests,onGuestsChange:m,required:!0}):t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{htmlFor:"nonAttendingName",children:[a("rsvp:yourName")," ",t.jsx("span",{className:"required",children:"*"})]}),t.jsx("input",{id:"nonAttendingName",name:"nonAttendingName",type:"text",value:n.nonAttendingName,onChange:i,className:"form-input",required:!0,autoComplete:"name",spellCheck:!1,tabIndex:0})]})},"guestsOrName"),e===2&&n.attending==="yes"&&t.jsx(C.div,{variants:z,initial:"initial",animate:"animate",exit:"exit",className:"form-content",tabIndex:-1,children:t.jsx(ut,{musicRequests:n.musicRequest||[],onChange:h=>i({target:{name:"musicRequest",value:h}})})},"musicRequest"),e===3&&t.jsx(C.div,{variants:z,initial:"initial",animate:"animate",exit:"exit",className:"form-content",tabIndex:-1,children:n.attending==="yes"&&t.jsxs("div",{className:"form-group",children:[t.jsxs("label",{htmlFor:"notes",children:[a("rsvp:messageToBrideGroom")," (",a("rsvp:optional"),")"]}),t.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:i,className:"form-input",placeholder:a("rsvp:messagePlaceholder"),rows:5,tabIndex:0})]})},"notes"),e===4&&s&&t.jsxs(C.div,{variants:z,initial:"initial",animate:"animate",exit:"exit",className:"form-content",tabIndex:-1,children:[t.jsx("div",{className:"review-card",children:t.jsxs("div",{className:"review-card__inner",children:[t.jsx("p",{className:"review-card__reply-line",children:t.jsx("em",{children:n.attending==="yes"?a("rsvp:review.acceptsWithPleasure"):a("rsvp:review.declinesWithRegrets")})}),t.jsxs("div",{className:"review-card__field",children:[t.jsx("span",{className:"review-card__field-label",children:a("rsvp:email")}),t.jsx("span",{className:"review-card__field-value",children:n.email})]}),n.attending==="yes"&&n.guests.length>0&&t.jsxs("div",{className:"review-card__field",children:[t.jsx("span",{className:"review-card__field-label",children:a("rsvp:review.numberAttending")}),t.jsx("span",{className:"review-card__field-value",children:n.guests.length}),t.jsx("ul",{className:"review-card__guests",children:n.guests.map((h,R)=>t.jsxs("li",{className:"review-card__field-value",children:[h.firstName," ",h.lastName,h.dietary&&t.jsxs("span",{className:"review-card__dietary",children:[" ","(",h.dietary,")"]})]},R))})]}),n.attending==="no"&&t.jsxs("div",{className:"review-card__field",children:[t.jsx("span",{className:"review-card__field-label",children:a("rsvp:name")}),t.jsx("span",{className:"review-card__field-value",children:n.nonAttendingName})]}),n.attending==="yes"&&n.musicRequest&&n.musicRequest.length>0&&t.jsxs("div",{className:"review-card__field",children:[t.jsx("span",{className:"review-card__field-label",children:a("rsvp:musicRequest")}),t.jsx("ul",{className:"review-card__songs",children:n.musicRequest.map((h,R)=>t.jsxs("li",{className:"review-card__song",children:[t.jsx("img",{src:h.artworkUrl100,alt:h.trackName,className:"review-card__song-art"}),t.jsxs("span",{className:"review-card__field-value",children:[h.trackName," — ",h.artistName]})]},R))})]}),n.notes&&t.jsxs("div",{className:"review-card__field",children:[t.jsx("span",{className:"review-card__field-label",children:a("rsvp:messageToBrideGroom")}),t.jsxs("p",{className:"review-card__note review-card__field-value",children:['"',n.notes,'"']})]}),t.jsx("p",{className:"review-card__footer",children:a("rsvp:review.pleasureOfYourCompany")})]})}),t.jsx("div",{className:"form-group form-group--consent",children:t.jsxs("label",{className:"consent-label",children:[t.jsx("input",{type:"checkbox",name:"termsAccepted",checked:!!n.termsAccepted,onChange:i,className:"consent-checkbox",tabIndex:0}),t.jsxs("span",{className:"consent-text",children:[a("rsvp:terms.iAgree")," ",t.jsx("a",{href:`/${o}/legal/terms`,target:"_blank",rel:"noopener noreferrer",children:a("rsvp:terms.termsLinkText")})," ",a("rsvp:terms.and")," ",t.jsx("a",{href:`/${o}/legal/privacy`,target:"_blank",rel:"noopener noreferrer",children:a("rsvp:terms.privacyLinkText")}),"."]})]})}),t.jsx(it,{sitekey:"6Lcy_mcsAAAAADoT-ibwy1RvePEHG4xJ87D0fdse",onChange:h=>d(h),ref:g,style:{display:"inline-block",width:"100%",marginTop:"1rem"}}),!b&&f&&t.jsx("div",{className:"field-error",children:a("rsvp:errors.captchaRequired")})]},"review")]})},vt=({submittedRef:e,guestEmail:r})=>{const{t:n}=Y(["home","common","rsvp"]),[s,i]=p.useState(!1);return p.useEffect(()=>{const m=setTimeout(()=>i(!0),50),b=setInterval(()=>{i(!1),setTimeout(()=>i(!0),55)},1e4);return()=>{clearTimeout(m),clearInterval(b)}},[]),t.jsxs(C.div,{className:"rsvp-page container",ref:e,tabIndex:-1,role:"status","aria-live":"polite",initial:{opacity:0,scale:.9,y:30},animate:{opacity:1,scale:1,y:0,transition:{type:"spring",stiffness:300,damping:25,duration:.6}},children:[t.jsx(C.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:400,damping:20,delay:1},className:"heart-animated","aria-hidden":"true",style:{fontSize:"4rem",marginBottom:"1.5rem",display:"flex",justifyContent:"center"},children:t.jsxs("svg",{viewBox:"0 0 24 24","aria-hidden":"true",focusable:"false",children:[t.jsx("defs",{children:t.jsx("path",{id:"heart",d:"M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"})}),t.jsx(C.use,{xlinkHref:"#heart",initial:{opacity:0,scale:.33},animate:{opacity:1,scale:1},transition:{type:"spring",stiffness:300,damping:15},style:{transformOrigin:"center"}},s?"on":"off")]})}),t.jsx(C.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.5},style:{textAlign:"center",marginBottom:"1rem"},children:n("rsvp:thankYou")}),t.jsx(C.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},style:{textAlign:"center",maxWidth:"500px",margin:"0 auto 2rem",lineHeight:1.6},children:n("rsvp:confirmation",{guestEmail:r})})]})};function yt(e){const r=he(),[n,s]=p.useState({...e,musicRequest:e.musicRequest||"",termsAccepted:!1}),[i,m]=p.useState(0),[b,f]=p.useState(null),[g,d]=p.useState(!1),o=[{key:"contactAndAttendance",required:!0},{key:"guestsOrName",required:!0},{key:"musicRequest",required:!1},{key:"notes",required:!1},{key:"review",required:!0}],a=o[i];return{form:n,setForm:s,currentStep:i,currentStepObj:a,steps:o,error:b,setError:f,hasValidGuests:g,handleChange:x=>{const{name:y}=x.target,h=x.target instanceof HTMLInputElement&&x.target.type==="checkbox"?x.target.checked:x.target.value;s(R=>({...R,[y]:h})),f(null)},handleGuestsChange:x=>{s(y=>({...y,guests:x})),d(x.some(y=>y.firstName.trim()&&y.lastName.trim()))},nextStep:()=>{r.event("rsvp_step_complete",{event_label:a.key,step_number:i+1,step_name:a.key}),m(x=>x+1)},prevStep:()=>{r.event("rsvp_step_back",{event_label:a.key,step_number:i+1,step_name:a.key}),m(x=>x-1)},goToStep:x=>m(x)}}class J{constructor(r=0,n="Network Error"){this.status=r,this.text=n}}const gt=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,r)=>Promise.resolve(localStorage.setItem(e,r)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},L={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:gt()},fe=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},bt=(e,r="https://api.emailjs.com")=>{if(!e)return;const n=fe(e);L.publicKey=n.publicKey,L.blockHeadless=n.blockHeadless,L.storageProvider=n.storageProvider,L.blockList=n.blockList,L.limitRate=n.limitRate,L.origin=n.origin||r},Te=async(e,r,n={})=>{const s=await fetch(L.origin+e,{method:"POST",headers:n,body:r}),i=await s.text(),m=new J(s.status,i);if(s.ok)return m;throw m},Ee=(e,r,n)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!r||typeof r!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n||typeof n!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},xt=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},Pe=e=>e.webdriver||!e.languages||e.languages.length===0,Ae=()=>new J(451,"Unavailable For Headless Browser"),_t=(e,r)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof r!="string")throw"The BlockList watchVariable has to be a string"},Nt=e=>!e.list?.length||!e.watchVariable,jt=(e,r)=>e instanceof FormData?e.get(r):e[r],Ce=(e,r)=>{if(Nt(e))return!1;_t(e.list,e.watchVariable);const n=jt(r,e.watchVariable);return typeof n!="string"?!1:e.list.includes(n)},Le=()=>new J(403,"Forbidden"),wt=(e,r)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(r&&typeof r!="string")throw"The LimitRate ID has to be a non-empty string"},St=async(e,r,n)=>{const s=Number(await n.get(e)||0);return r-Date.now()+s},Oe=async(e,r,n)=>{if(!r.throttle||!n)return!1;wt(r.throttle,r.id);const s=r.id||e;return await St(s,r.throttle,n)>0?!0:(await n.set(s,Date.now().toString()),!1)},$e=()=>new J(429,"Too Many Requests"),Rt=async(e,r,n,s)=>{const i=fe(s),m=i.publicKey||L.publicKey,b=i.blockHeadless||L.blockHeadless,f=i.storageProvider||L.storageProvider,g={...L.blockList,...i.blockList},d={...L.limitRate,...i.limitRate};return b&&Pe(navigator)?Promise.reject(Ae()):(Ee(m,e,r),xt(n),n&&Ce(g,n)?Promise.reject(Le()):await Oe(location.pathname,d,f)?Promise.reject($e()):Te("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:m,service_id:e,template_id:r,template_params:n}),{"Content-type":"application/json"}))},kt=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},Tt=e=>typeof e=="string"?document.querySelector(e):e,Et=async(e,r,n,s)=>{const i=fe(s),m=i.publicKey||L.publicKey,b=i.blockHeadless||L.blockHeadless,f=L.storageProvider||i.storageProvider,g={...L.blockList,...i.blockList},d={...L.limitRate,...i.limitRate};if(b&&Pe(navigator))return Promise.reject(Ae());const o=Tt(n);Ee(m,e,r),kt(o);const a=new FormData(o);return Ce(g,a)?Promise.reject(Le()):await Oe(location.pathname,d,f)?Promise.reject($e()):(a.append("lib_version","4.4.1"),a.append("service_id",e),a.append("template_id",r),a.append("user_id",m),Te("/api/v1.0/email/send-form",a))},me={init:bt,send:Rt,sendForm:Et,EmailJSResponseStatus:J},Pt="gVksEDEDoKBjB0TJU",Re="service_vvuhisc",At="template_4m25aki",Ct="template_g1m154k",Lt="template_u0pm2au";me.init(Pt);function Ot(e,r,n=0){const s=he(),[i,m]=p.useState(!1),[b,f]=p.useState(!1),[g,d]=p.useState(null),o=async()=>{if(console.log("Submitting RSVP...",{form:e,captchaToken:r}),!e.termsAccepted){const a="Please accept the Terms & Conditions and Privacy Policy.";d(a),s.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:n,attending_status:e.attending,has_captcha_token:!!r});return}if(!r){const a="Please complete reCAPTCHA.";d(a),s.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:n,attending_status:e.attending,has_captcha_token:!1});return}if(!e.email){const a="Email is required.";d(a),s.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:n,attending_status:e.attending,has_captcha_token:!!r});return}if(!e.attending){const a="Please indicate if you're attending.";d(a),s.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:n,has_captcha_token:!!r});return}if(e.attending==="yes"&&e.guests.length===0){const a="Please add at least one guest.";d(a),s.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:n,attending_status:e.attending,has_captcha_token:!!r});return}if(e.attending==="no"&&!e.nonAttendingName){const a="Please provide your name.";d(a),s.event("rsvp_submit_error",{event_label:"validation_error",error_message:a,error_type:"validation_error",current_step:n,attending_status:e.attending,has_captcha_token:!!r});return}m(!0),d(null);try{const a=e.attending==="yes"?e.guests.map((y,h)=>`${h+1}. ${y.firstName} ${y.lastName}`+(y.dietary?` - Dietary: ${y.dietary}`:"")+(y.note?` - Note: ${y.note}`:"")).join(`
`):`Not attending: ${e.nonAttendingName}`,u=(()=>{if(!e.musicRequest)return"None";const y=e.musicRequest;return!Array.isArray(y)||y.length===0?"None":y.map((h,R)=>`${R+1}. ${h.trackName} — ${h.artistName}`).join(`
`)})(),v={email:e.email,attending:e.attending,guestsCount:e.attending==="yes"?e.guests.length:1,guests:a,notes:e.notes||"None",musicRequest:u,termsAccepted:e.termsAccepted?"Yes — Terms & Conditions and Privacy Policy accepted":"No",recaptchaToken:r};console.log("Sending email with params:",v);const N=await me.send(Re,At,v);console.log("Notification sent:",N);const T=(document.documentElement.lang??"es")==="en"?Ct:Lt,x=await me.send(Re,T,v);console.log("Auto-reply sent:",x),s.event("rsvp_submit_success",{event_label:`RSVP ${e.attending==="yes"?"Accepted":"Declined"}`,attending:e.attending,guest_count:e.attending==="yes"?e.guests.length:1,dietary_requirements:e.guests[0]?.dietary||"none",music_request:u,terms_accepted:!0,locale:document.documentElement.lang}),s.event("conversion",{event_label:"RSVP Completed",send_to:"AW-CONVERSION-ID"}),s.event("rsvp_confirmation_view",{event_label:"Viewed confirmation page"}),s.event("page_view",{page_title:"RSVP Confirmation",page_location:window.location.href,page_path:"/rsvp/confirmation"}),f(!0)}catch(a){console.error("Submission error:",a);const u=a?.text||a?.message||"Failed to submit RSVP. Please try again.",v=a?.text?"emailjs_error":"network_error";d(u),s.event("rsvp_submit_error",{event_label:v,error_message:u,error_type:v,current_step:n,attending_status:e.attending,has_captcha_token:!!r}),s.event("exception",{description:`RSVP Error: ${v} - ${u}`,fatal:!1})}finally{m(!1)}};return p.useEffect(()=>{g&&console.error("RSVP Error:",g)},[g]),{submit:o,sending:i,submitted:b,error:g,setError:d,setSubmitted:f}}const $t=({currentStep:e,totalSteps:r})=>{const n=(e+1)/r*100;return Array.from({length:r},(s,i)=>i),t.jsx("div",{className:"progress-bar-container",children:t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-bar__fill",style:{width:`${n}%`}})})})};let oe=!1,W=!1;const Ht=qe(function(){const{t:r,ready:n}=Y(["home","common","rsvp"]),s=he();De();const[i,m]=p.useState(!1),[b,f]=p.useState(null),g=p.useRef(null),{form:d,currentStep:o,currentStepObj:a,steps:u,error:v,handleChange:N,handleGuestsChange:w,nextStep:T,prevStep:x,hasValidGuests:y}=yt({email:"",attending:"",guests:[],nonAttendingName:"",notes:"",website:""}),{submit:h,sending:R,submitted:c,error:S,setSubmitted:k}=Ot(d,b,o),E=p.useRef(null),_=p.useRef(null),A=p.useRef(null),O=v||S;if(p.useEffect(()=>{oe||(s.event("rsvp_start",{event_label:"User started RSVP form"}),oe=!0),W=!1;const V=()=>{!c&&!W&&(s.event("rsvp_abandonment",{event_label:`Abandoned at ${a.key}`,step_number:o+1,step_name:a.key}),W=!0)};return window.addEventListener("beforeunload",V),()=>{window.removeEventListener("beforeunload",V),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{!window.location.pathname.includes("/rsvp")&&(!c&&!W&&(s.event("rsvp_abandonment",{event_label:`Abandoned at ${a.key}`,step_number:o+1,step_name:a.key}),W=!0),oe=!1),g.current=null},100)}},[o,a,u,c,s]),p.useEffect(()=>m(!0),[]),p.useEffect(()=>{O&&E.current&&(E.current.scrollIntoView({behavior:"smooth",block:"center"}),E.current.focus()),c&&_.current&&_.current.focus()},[O,c]),!n)return t.jsx("div",{className:"loading",children:r("common:loading")});if(c)return t.jsx(vt,{onReset:()=>k(!1),submittedRef:_,guestEmail:d.email});const F=()=>o===0?!d.attending||!d.email:o===1?d.attending==="yes"?!y:!d.nonAttendingName:o===2||o===3?!1:o===4?!b||!d.termsAccepted:!1,U=r(`rsvp:steps.${a.key}.stepTitle`),Q=r(`rsvp:steps.${a.key}.stepText`),X=()=>a.key==="musicRequest"?Array.isArray(d.musicRequest)&&d.musicRequest.length>0:a.key==="notes"?!!d.notes?.trim():!1;return t.jsxs("div",{className:"rsvp-page container",children:[t.jsx("h1",{children:"Rsvp"}),t.jsx("h2",{className:"step-description",children:U}),t.jsx($t,{currentStep:o,totalSteps:u.length}),t.jsx("p",{className:"step-description",children:Q}),t.jsxs("form",{className:"rsvp-form",onSubmit:V=>V.preventDefault(),children:[t.jsxs("div",{className:"form-navigation",children:[t.jsx("button",{type:"button",onClick:x,disabled:o===0,title:r("common:back")||"Back",children:t.jsx(I.Back,{})}),t.jsxs("span",{children:[o+1,"/",u.length]}),o<u.length-1?t.jsx("button",{type:"button",onClick:T,disabled:F(),title:a.required||X()?r("common:next"):r("rsvp:skip"),children:a.required||X()?t.jsx(I.Next,{}):r("rsvp:skip")}):t.jsx("button",{type:"button",onClick:h,disabled:R||F(),children:r(R?"rsvp:sending":"rsvp:submit")})]}),t.jsx(ft,{currentStep:o,currentStepObj:a,form:d,isClient:i,onChange:N,onGuestsChange:w,captchaToken:b,setCaptchaToken:f,recaptchaRef:A,error:O}),O&&t.jsx("div",{className:"rsvp-error",ref:E,role:"alert",tabIndex:-1,children:O})]})]})});export{Ht as default};
