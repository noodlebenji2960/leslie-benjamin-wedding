import{p as w,a as d,t as I,w as P,v as R}from"./chunk-EPOLDU6W-BnKKP6Ue.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{u as A,C as q,a as z,R as W}from"./CookieConsentModal-CwOmzCZx.js";import{u as b}from"./useTranslation-B9zSoiKr.js";import{u as E,b as $}from"./SessionContext-zqiVhUqH.js";import{u as V}from"./ThemeContext-_9vuco75.js";import{I as B}from"./Icon-Dk5l_C6R.js";import{u as H}from"./useWeddingData-CQuVZNqD.js";import{M as S,T as L}from"./Modal-BN9Olhqj.js";import{A as T,m as M}from"./proxy-DBX3VoSC.js";import"./i18next-BDvusv7y.js";function O({locale:o,links:s}){const{buildLink:l}=A(),{t:a}=b(["common"]),c=w(),r=d.useRef(null),[i,h]=d.useState({left:0,top:0,width:0}),[p,f]=d.useState(!1),m=(n=>n.replace(/^\/(en|es)/,"")||"/")(c.pathname),x=m==="/"||m==="",j=n=>{if(!r.current||!n)return;const t=r.current.getBoundingClientRect(),u=n.getBoundingClientRect();h({left:u.left-t.left,top:u.bottom-t.top-3,width:u.width})},g=n=>{f(!0),j(n)},v=()=>f(!1);return d.useEffect(()=>{if(p||!r.current)return;const n=Array.from(r.current.querySelectorAll(".nav-link")),t=s.findIndex(u=>u.path==="/"?x:m===u.path);t!==-1&&j(n[t])},[c.pathname,o,p,s,x,m]),d.useLayoutEffect(()=>{const n=()=>{if(!r.current)return;const t=Array.from(r.current.querySelectorAll(".nav-link")),u=s.findIndex(N=>N.path==="/"?x:m===N.path);u!==-1&&j(t[u])};return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[s,x,m]),e.jsx("nav",{className:"nav",children:e.jsxs("div",{className:"nav-links desktop",ref:r,children:[s.map(n=>e.jsx(I,{to:l(n.path),className:"nav-link",ref:t=>{},onMouseEnter:t=>g(t.currentTarget),onMouseLeave:v,children:n.label},n.path)),e.jsx("div",{className:"nav-indicator",style:{transform:`translate(${i.left}px)`,width:i.width}})]})})}function D({currentLocale:o,onSwitch:s,isPending:l=!1}){return e.jsx("button",{className:"language-switcher",onClick:s,disabled:l,"aria-label":`Switch to ${o==="es"?"English":"Spanish"}`,children:e.jsxs("div",{className:"language-icons",children:[e.jsx("span",{className:`language-label ${o==="es"?"active":""}`,children:"ES"}),e.jsx("span",{className:`language-label ${o==="en"?"active":""}`,children:"EN"})]})})}const _=["light","dark"],K={light:"Light mode",dark:"Dark mode",system:"System"};function Y(){const{theme:o,setTheme:s}=V(),l=_.indexOf(o),a=()=>{const c=(l+1)%_.length,r=_[c]??_[0];s(r)};return e.jsx("button",{className:"theme-toggle-slider",onClick:a,"aria-label":`${K[o]}. Click to switch theme.`,children:e.jsxs("div",{className:"toggle-icons",children:[e.jsx("span",{className:`icon sun ${o==="light"?"active":""}`,children:"â˜€ï¸Ž"}),e.jsx("span",{className:`icon moon ${o==="dark"?"active":""}`,children:"â¾"})]})})}function F({onClick:o}){const[s,l]=d.useState(!1);return d.useEffect(()=>{const a=()=>{l(window.scrollY>150)};return a(),window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[]),e.jsx("button",{className:`back-to-top ${s?"visible":""}`,onClick:o,"aria-label":"Back to top",children:e.jsx(B.Up,{})})}const G=({openCookieConsentModal:o})=>{const s=w(),{locale:l}=E(),a=H(),{t:c}=b(),r=s.pathname==="/"||s.pathname===""||s.pathname===`/${l}`;if(!a?.wedding)return null;const{date:i}=a.wedding,{time:h}=a.wedding.ceremony;return e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-content",children:[e.jsx("button",{onClick:o,className:"footer__cookie-btn",children:c("common:change_cookie_preferences","Cookie Preferences")}),!r&&e.jsx(q,{size:"sm",date:i,time:h})]})})};function U({isOpen:o,onClose:s,children:l,autoClose:a=3e3}){const c=d.useRef(null);d.useEffect(()=>(c.current&&(clearTimeout(c.current),c.current=null),o&&a&&(c.current=setTimeout(()=>{s(),c.current=null},a)),()=>{c.current&&(clearTimeout(c.current),c.current=null)}),[o,a,s]);const r={hidden:{opacity:0,y:50,scale:.95},visible:{opacity:1,y:0,scale:1},exit:{opacity:0,y:50,scale:.95}};return e.jsx(T,{children:o&&e.jsx(M.div,{className:"toast-wrapper",variants:r,initial:"hidden",animate:"visible",exit:"exit",transition:{duration:.4,ease:"easeInOut"},children:e.jsx("div",{className:"toast-content",children:l})})})}function C(){return e.jsx("span",{className:"wave-emoji",role:"img","aria-label":"waving hand",children:"ðŸ‘‹"})}const k=[{key:"necessary",label:"Necessary cookies (required)",required:!0},{key:"analytics",label:"Analytics cookies"},{key:"personalization",label:"Personalization cookies"}];function J({isOpen:o,onClose:s,mode:l="first_visit"}){const{visitor:a,cookiePreference:c,setCookiePreference:r}=$(),{t:i}=b(["home","common"]),[h,p]=d.useState(()=>k.reduce((n,t)=>(n[t.key]=t.required?!0:c?.[t.key]??!1,n),{})),f=h.personalization===!0,[y,m]=d.useState(l==="change_preferences"||c===null);if(d.useEffect(()=>{o&&(p(k.reduce((n,t)=>(n[t.key]=t.required?!0:c?.[t.key]??!1,n),{})),m(l==="change_preferences"||c===null))},[o,c,l]),!a)return e.jsx(S,{isOpen:o,onClose:s,children:e.jsx("p",{className:"ccm__loading",children:i("common:loading","Loading...")})});const x=()=>{r(h),s()},j=()=>{const n=k.reduce((t,u)=>(t[u.key]=!0,t),{});p(n),r(n),s()},g=()=>{const n=k.reduce((t,u)=>(t[u.key]=!!u.required,t),{});p(n),r(n),s()},v=()=>f?l!=="first_visit"?i("common:change_preferences_prompt","Change your preferences to improve your experience."):a.isFirstVisit?e.jsxs(L,{i18nKey:"home:welcome_first_visit",components:{emoji:e.jsx(C,{})},children:["Welcome to our wedding website! ",e.jsx("emoji",{})]}):a.daysSinceLastVisit===0?e.jsxs(L,{i18nKey:"home:welcome_back_today",components:{emoji:e.jsx(C,{})},children:["Welcome back! ",e.jsx("emoji",{})]}):a.daysSinceLastVisit===1?i("home:welcome_back_yesterday","Great to see you again! You were here yesterday."):a.daysSinceLastVisit<7?i("home:welcome_back_days","Welcome back! It's been {{days}} days since your last visit.",{days:a.daysSinceLastVisit}):i("home:welcome_back_long_time","Welcome back! We've missed you! It's been {{days}} days.",{days:a.daysSinceLastVisit}):i("common:welcome_generic","Welcome to our wedding website!");return c&&l==="first_visit"?e.jsx(U,{isOpen:o,onClose:s,autoClose:3e3,children:e.jsx("p",{className:"ccm__greeting",children:v()})}):e.jsx(S,{isOpen:o,onClose:s,children:e.jsxs("div",{className:"ccm",children:[e.jsx("button",{className:"ccm__close",onClick:s,"aria-label":i("common:close","Close modal"),children:"Ã—"}),e.jsx("p",{className:"ccm__greeting",children:v()}),y?e.jsxs("div",{className:"ccm__preferences",id:"cookie-preferences",children:[e.jsx("p",{className:"ccm__intro",children:i("common:cookie_intro","We use cookies to improve your experience. You can choose which types of cookies you allow:")}),e.jsx("div",{className:"ccm__checkboxes",children:k.map(n=>e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:h[n.key],disabled:n.required,onChange:t=>p({...h,[n.key]:t.target.checked})}),n.label]},n.key))}),!f&&e.jsx("p",{className:"ccm__hint",children:i("common:personalization_hint","Enable personalization to see a tailored welcome message.")}),e.jsxs("div",{className:"ccm__actions",children:[e.jsx("button",{className:"ccm__save-btn",onClick:x,children:i("common:save_preferences","Save Preferences")}),e.jsx("button",{className:"ccm__accept-all-btn",onClick:j,children:i("common:accept_all","Accept All")}),e.jsx("button",{className:"ccm__reject-all-btn",onClick:g,children:i("common:reject_all","Reject All")})]})]}):e.jsx("button",{className:"ccm__toggle-btn",onClick:()=>m(!0),children:i("common:show_preferences","Show Preferences")})]})})}const re=P(function(){const s=w(),l=R(),[a,c]=d.useTransition(),{locale:r,switchLanguage:i}=E(),[h,p]=d.useState(!1),{t:f}=b(["common"]),y=d.useRef(null),[m,x]=d.useState("first_visit"),[j,g]=d.useState(!0),v=z(()=>{});d.useEffect(()=>{v?.scrollTo(0,{immediate:!0})},[s.pathname,v]);const n=[{path:"/",label:f("nav.home")},{path:"/rsvp",label:f("nav.rsvp")},{path:"/schedule",label:f("nav.schedule")},{path:"/qa",label:f("nav.qa")}],t=()=>{x("change_preferences"),g(!0)},u=()=>{g(!1)};return d.useEffect(()=>{console.log("cookieConsentModalMode",m),j||x("first_visit")},[m]),e.jsxs(W,{root:!0,children:[e.jsx(J,{isOpen:j,onClose:u,mode:m}),e.jsxs("div",{className:"container",children:[e.jsx(O,{menuOpen:h,setMenuOpen:p,locale:r,links:n,onLanguageSwitch:()=>c(i),isPending:a,hamburgerRef:y}),e.jsxs("main",{className:"main",children:[e.jsx(T,{mode:"wait",children:e.jsx(M.div,{className:"page-content",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},children:l},s.pathname)}),e.jsxs("div",{className:"fixed-container",children:[e.jsx(D,{currentLocale:r,onSwitch:i,isPending:a}),e.jsxs("div",{className:"group",children:[e.jsx(F,{onClick:()=>v?.scrollTo(0,{duration:1})}),e.jsx(Y,{})]})]}),e.jsx(G,{openCookieConsentModal:t})]})]})]})});export{re as default};
